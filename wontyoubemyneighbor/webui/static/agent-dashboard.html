<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent Dashboard - Won't You Be My Neighbor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --bg-tertiary: #0d1117;
            --border-color: #2a2a4e;
            --text-primary: #eee;
            --text-secondary: #888;
            --accent-cyan: #00d9ff;
            --accent-green: #4ade80;
            --accent-yellow: #facc15;
            --accent-red: #ef4444;
            --accent-purple: #a78bfa;
            --accent-pink: #f472b6;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 25px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-left h1 {
            color: var(--accent-cyan);
            font-size: 1.5rem;
        }

        .agent-badge {
            background: var(--bg-tertiary);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .connection-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .status-dot.connected {
            background: var(--accent-green);
            box-shadow: 0 0 6px var(--accent-green);
        }

        .status-dot.disconnected { background: var(--accent-red); }

        .nav-links {
            display: flex;
            gap: 10px;
        }

        .nav-link {
            background: transparent;
            border: 1px solid var(--accent-cyan);
            color: var(--accent-cyan);
            padding: 8px 16px;
            border-radius: 4px;
            text-decoration: none;
            font-size: 0.85rem;
            transition: all 0.3s;
        }

        .nav-link:hover {
            background: var(--accent-cyan);
            color: var(--bg-primary);
        }

        /* Agent Info Banner */
        .agent-info-banner {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .info-label {
            color: var(--text-secondary);
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .info-value {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 500;
            font-family: monospace;
        }

        /* Protocol Tabs */
        .protocol-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .protocol-tab {
            padding: 10px 20px;
            border: none;
            border-radius: 8px 8px 0 0;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .protocol-tab:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .protocol-tab.active {
            background: var(--bg-secondary);
            color: var(--accent-cyan);
        }

        .protocol-tab.interfaces.active { color: #f97316; }
        .protocol-tab.ospf.active { color: var(--accent-cyan); }
        .protocol-tab.bgp.active { color: var(--accent-purple); }
        .protocol-tab.isis.active { color: var(--accent-yellow); }
        .protocol-tab.mpls.active { color: var(--accent-green); }
        .protocol-tab.vxlan.active { color: var(--accent-pink); }
        .protocol-tab.dhcp.active { color: #60a5fa; }
        .protocol-tab.dns.active { color: #34d399; }
        .protocol-tab.testing.active { color: #22d3ee; }
        .protocol-tab.gait.active { color: #f59e0b; }
        .protocol-tab.markmap.active { color: #ec4899; }
        .protocol-tab.prometheus.active { color: #e6522c; }
        .protocol-tab.grafana.active { color: #f97316; }
        .protocol-tab.lldp.active { color: #06b6d4; }
        .protocol-tab.lacp.active { color: #8b5cf6; }
        .protocol-tab.subif.active { color: #ec4899; }
        .protocol-tab.ospfv3.active { color: #0ea5e9; }
        .protocol-tab.email.active { color: #f59e0b; }
        .protocol-tab.firewall.active { color: #ef4444; }
        .protocol-tab.ssh.active { color: #06b6d4; }
        .protocol-tab.netconf.active { color: #14b8a6; }
        .protocol-tab.mcpext.active { color: #a855f7; }
        .protocol-tab.health.active { color: #10b981; }
        .protocol-tab.simulation.active { color: #f472b6; }
        .protocol-tab.replay.active { color: #8b5cf6; }
        .protocol-tab.diff.active { color: #06b6d4; }
        .protocol-tab.suggestions.active { color: #f59e0b; }
        .protocol-tab.scenarios.active { color: #8b5cf6; }
        .protocol-tab.vendors.active { color: #14b8a6; }
        .protocol-tab.chaos.active { color: #ef4444; }
        .protocol-tab.config.active { color: #a855f7; }
        .protocol-tab.docs.active { color: #0ea5e9; }
        .protocol-tab.analytics.active { color: #6366f1; }
        .protocol-tab.compliance.active { color: #f97316; }
        .protocol-tab.exporter.active { color: #84cc16; }
        .protocol-tab.scheduler.active { color: #f472b6; }
        .protocol-tab.inventory.active { color: #22d3ee; }
        .protocol-tab.capacity.active { color: #14b8a6; }
        .protocol-tab.sla.active { color: #f43f5e; }
        .protocol-tab.audit.active { color: #78716c; }
        .protocol-tab.backup.active { color: #0ea5e9; }
        .protocol-tab.alerts.active { color: #ef4444; }
        .protocol-tab.workflows.active { color: #8b5cf6; }
        .protocol-tab.users.active { color: #06b6d4; }
        .protocol-tab.webhooks.active { color: #f97316; }
        .protocol-tab.apikeys.active { color: #a855f7; }
        .protocol-tab.sessions.active { color: #64748b; }
        .protocol-tab.tenancy.active { color: #0d9488; }
        .protocol-tab.plugins.active { color: #ec4899; }
        .protocol-tab.ratelimit.active { color: #f97316; }
        .protocol-tab.events.active { color: #6366f1; }
        .protocol-tab.rules.active { color: #84cc16; }
        .protocol-tab.messaging.active { color: #0ea5e9; }
        .protocol-tab.healing.active { color: #22c55e; }
        .protocol-tab.pipelines.active { color: #f472b6; }
        .protocol-tab.notifications.active { color: #fb923c; }
        .protocol-tab.optimization.active { color: #14b8a6; }
        .protocol-tab.discovery.active { color: #a855f7; }
        .protocol-tab.intent.active { color: #f43f5e; }
        .protocol-tab.knowledge.active { color: #0891b2; }
        .protocol-tab.heatmap.active { color: #ef4444; }
        .protocol-tab.whatif.active { color: #7c3aed; }
        .protocol-tab.multiagent.active { color: #059669; }
        .protocol-tab.reasoning.active { color: #d946ef; }
        .protocol-tab.traffic.active { color: #0284c7; }
        .protocol-tab.tutorials.active { color: #ea580c; }
        .protocol-tab.certification.active { color: #16a34a; }
        .protocol-tab.integration.active { color: #be185d; }
        .protocol-tab.graphql.active { color: #e11d48; }
        .protocol-tab.actions.active { color: #7c2d12; }
        .protocol-tab.fsm.active { color: #0369a1; }
        .protocol-tab.statemachine.active { color: #4f46e5; }
        .protocol-tab.rbac.active { color: #9333ea; }
        .protocol-tab.llm.active { color: #0ea5e9; }
        .protocol-tab.routes.active { color: #10b981; }
        .protocol-tab.logs.active { color: #64748b; }
        .protocol-tab.chat.active { color: #f59e0b; }

        .protocol-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .protocol-indicator.active { background: var(--accent-green); }
        .protocol-indicator.inactive { background: var(--text-secondary); }

        /* Protocol Content */
        .protocol-content {
            display: none !important;
            height: 0 !important;
            overflow: hidden !important;
        }

        .protocol-content.active {
            display: block !important;
            height: 700px !important;
            max-height: 700px !important;
            min-height: 400px !important;
            overflow-y: auto !important;
            overflow-x: hidden !important;
            padding-right: 10px;
            box-sizing: border-box;
        }

        /* Prometheus and Grafana specific fixes */
        #prometheus-content.active,
        #grafana-content.active {
            height: 700px !important;
            max-height: 700px !important;
            overflow-y: auto !important;
        }

        #prometheus-content .section,
        #grafana-content .section {
            margin-bottom: 20px;
        }

        /* Metrics Grid */
        .metrics-row {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 25px;
            flex-shrink: 0;
        }

        .metric-card {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 18px;
            position: relative;
            overflow: hidden;
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
        }

        .metric-card.interfaces::before { background: #f97316; }
        .metric-card.ospf::before { background: var(--accent-cyan); }
        .metric-card.bgp::before { background: var(--accent-purple); }
        .metric-card.isis::before { background: var(--accent-yellow); }
        .metric-card.mpls::before { background: var(--accent-green); }
        .metric-card.vxlan::before { background: var(--accent-pink); }
        .metric-card.dhcp::before { background: #60a5fa; }
        .metric-card.dns::before { background: #34d399; }
        .metric-card.logs::before { background: #10b981; }
        .metric-card.metrics::before { background: #10b981; }
        .metric-card.grafana::before { background: #f97316; }
        .metric-card.lldp::before { background: #06b6d4; }
        .metric-card.lacp::before { background: #8b5cf6; }
        .metric-card.subif::before { background: #ec4899; }
        .metric-card.ospfv3::before { background: #0ea5e9; }
        .metric-card.email::before { background: #f59e0b; }
        .metric-card.firewall::before { background: #ef4444; }
        .metric-card.ssh::before { background: #06b6d4; }
        .metric-card.netconf::before { background: #14b8a6; }
        .metric-card.mcpext::before { background: #a855f7; }
        .metric-card.health::before { background: #10b981; }
        .metric-card.simulation::before { background: #f472b6; }
        .metric-card.replay::before { background: #8b5cf6; }
        .metric-card.diff::before { background: #06b6d4; }
        .metric-card.suggestions::before { background: #f59e0b; }
        .metric-card.scenarios::before { background: #8b5cf6; }
        .metric-card.vendors::before { background: #14b8a6; }
        .metric-card.chaos::before { background: #ef4444; }
        .metric-card.config::before { background: #a855f7; }
        .metric-card.docs::before { background: #0ea5e9; }
        .metric-card.analytics::before { background: #6366f1; }
        .metric-card.compliance::before { background: #f97316; }
        .metric-card.exporter::before { background: #84cc16; }
        .metric-card.scheduler::before { background: #f472b6; }
        .metric-card.inventory::before { background: #22d3ee; }
        .metric-card.capacity::before { background: #14b8a6; }
        .metric-card.sla::before { background: #f43f5e; }
        .metric-card.audit::before { background: #78716c; }
        .metric-card.backup::before { background: #0ea5e9; }
        .metric-card.alerts::before { background: #ef4444; }
        .metric-card.workflows::before { background: #8b5cf6; }
        .metric-card.users::before { background: #06b6d4; }
        .metric-card.webhooks::before { background: #f97316; }
        .metric-card.apikeys::before { background: #a855f7; }
        .metric-card.sessions::before { background: #64748b; }
        .metric-card.tenancy::before { background: #0d9488; }
        .metric-card.plugins::before { background: #ec4899; }
        .metric-card.ratelimit::before { background: #f97316; }
        .metric-card.events::before { background: #6366f1; }
        .metric-card.rules::before { background: #84cc16; }
        .metric-card.messaging::before { background: #0ea5e9; }
        .metric-card.healing::before { background: #22c55e; }
        .metric-card.pipelines::before { background: #f472b6; }
        .metric-card.notifications::before { background: #fb923c; }
        .metric-card.optimization::before { background: #14b8a6; }
        .metric-card.discovery::before { background: #a855f7; }
        .metric-card.intent::before { background: #f43f5e; }
        .metric-card.knowledge::before { background: #0891b2; }
        .metric-card.heatmap::before { background: #ef4444; }
        .metric-card.whatif::before { background: #7c3aed; }
        .metric-card.multiagent::before { background: #059669; }
        .metric-card.reasoning::before { background: #d946ef; }
        .metric-card.traffic::before { background: #0284c7; }
        .metric-card.tutorials::before { background: #ea580c; }
        .metric-card.certification::before { background: #16a34a; }
        .metric-card.integration::before { background: #be185d; }
        .metric-card.graphql::before { background: #e11d48; }
        .metric-card.actions::before { background: #7c2d12; }
        .metric-card.fsm::before { background: #0369a1; }
        .metric-card.statemachine::before { background: #4f46e5; }
        .metric-card.rbac::before { background: #9333ea; }
        .metric-card.llm::before { background: #0ea5e9; }

        /* Health Score Gauge */
        .health-gauge {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 0 auto;
        }

        .health-gauge-circle {
            fill: none;
            stroke-width: 15;
            stroke-linecap: round;
        }

        .health-gauge-bg {
            stroke: var(--bg-tertiary);
        }

        .health-gauge-value {
            stroke: #10b981;
            transition: stroke-dashoffset 0.5s ease;
        }

        .health-gauge-value.excellent { stroke: #10b981; }
        .health-gauge-value.good { stroke: #84cc16; }
        .health-gauge-value.warning { stroke: #facc15; }
        .health-gauge-value.degraded { stroke: #f97316; }
        .health-gauge-value.critical { stroke: #ef4444; }

        .health-score-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .health-score-number {
            font-size: 3rem;
            font-weight: bold;
            color: var(--text-primary);
        }

        .health-score-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        .health-trend {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            margin-top: 10px;
        }

        .health-trend.improving { color: #10b981; }
        .health-trend.stable { color: var(--text-secondary); }
        .health-trend.declining { color: #ef4444; }

        .health-component {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .health-component-name {
            color: var(--text-primary);
            font-weight: 500;
        }

        .health-component-bar {
            flex: 1;
            height: 8px;
            background: var(--bg-primary);
            border-radius: 4px;
            margin: 0 15px;
            overflow: hidden;
        }

        .health-component-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .health-component-score {
            font-weight: bold;
            min-width: 45px;
            text-align: right;
        }

        /* BGP AFI Tab Styles */
        .bgp-afi-tabs .afi-tab:hover { opacity: 0.8; }
        .bgp-afi-tabs .afi-tab.active { background: var(--accent-cyan) !important; color: white !important; }
        .bgp-afi-content { transition: opacity 0.2s ease; }

        .metric-label {
            color: var(--text-secondary);
            font-size: 0.8rem;
            margin-bottom: 8px;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--text-primary);
        }

        .metric-unit {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: normal;
        }

        /* Data Tables */
        .section {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .section-header h3 {
            color: var(--text-primary);
            font-size: 1rem;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .data-table th {
            color: var(--text-secondary);
            font-weight: 500;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .data-table td {
            font-family: monospace;
            font-size: 0.9rem;
        }

        .data-table tbody tr:hover {
            background: var(--bg-tertiary);
        }

        /* Status Badges */
        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-badge.full,
        .status-badge.established,
        .status-badge.up,
        .status-badge.active {
            background: rgba(74, 222, 128, 0.2);
            color: var(--accent-green);
        }

        .status-badge.init,
        .status-badge.loading,
        .status-badge.pending {
            background: rgba(250, 204, 21, 0.2);
            color: var(--accent-yellow);
        }

        .status-badge.down,
        .status-badge.idle,
        .status-badge.error {
            background: rgba(239, 68, 68, 0.2);
            color: var(--accent-red);
        }

        /* Chart Container */
        .chart-container {
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 15px;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
        }

        /* Two Column Layout */
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
        }

        /* Refresh Button */
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-secondary {
            background: transparent;
            border: 1px solid var(--accent-cyan);
            color: var(--accent-cyan);
        }

        .btn-secondary:hover {
            background: var(--accent-cyan);
            color: var(--bg-primary);
        }

        /* Chat Tab Styles */
        .protocol-tab.chat.active { color: #00d9ff; }
        .protocol-tab.logs.active { color: #10b981; }
        .metric-card.chat::before { background: #00d9ff; }

        .chat-container {
            display: flex;
            flex-direction: column;
            height: 500px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            overflow: hidden;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .chat-message {
            max-width: 85%;
            padding: 12px 16px;
            border-radius: 12px;
            line-height: 1.5;
        }

        .chat-message.user {
            align-self: flex-end;
            background: var(--accent-cyan);
            color: #000;
            border-bottom-right-radius: 4px;
        }

        .chat-message.assistant {
            align-self: flex-start;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-bottom-left-radius: 4px;
        }

        .chat-message.system {
            align-self: center;
            background: rgba(250, 204, 21, 0.1);
            border: 1px solid var(--accent-yellow);
            color: var(--accent-yellow);
            font-size: 0.9rem;
            text-align: center;
        }

        .chat-input-area {
            display: flex;
            gap: 10px;
            padding: 15px;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--accent-cyan);
        }

        .chat-send-btn {
            padding: 12px 24px;
            background: var(--accent-cyan);
            color: #000;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .chat-send-btn:hover {
            background: #00b8d9;
        }

        .chat-send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Testing Tab Styles */
        .metric-card.testing::before { background: #22d3ee; }
        .metric-card.gait::before { background: #f59e0b; }
        .metric-card.markmap::before { background: #ec4899; }
        .metric-card.prometheus::before { background: #e6522c; }
        .metric-card.grafana::before { background: #f97316; }

        .test-suite-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            margin-bottom: 8px;
            transition: all 0.2s;
        }

        .test-suite-item:hover {
            background: var(--bg-primary);
        }

        .test-suite-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .test-suite-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--accent-cyan);
            cursor: pointer;
        }

        .test-count {
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .schedule-form {
            padding: 15px;
            background: var(--bg-tertiary);
            border-radius: 8px;
        }

        .form-row {
            margin-bottom: 15px;
        }

        .form-row label {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            cursor: pointer;
        }

        .form-row select {
            width: 100%;
            padding: 8px 12px;
            margin-top: 8px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .form-row input[type="checkbox"] {
            width: 16px;
            height: 16px;
            accent-color: var(--accent-cyan);
        }

        /* GAIT Tab Styles */
        .gait-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .search-input {
            padding: 8px 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.85rem;
            width: 200px;
        }

        .search-input::placeholder {
            color: var(--text-secondary);
        }

        .gait-controls select {
            padding: 8px 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.85rem;
        }

        .conversation-timeline {
            max-height: 500px;
            overflow-y: auto;
            padding: 15px;
        }

        .timeline-item {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            position: relative;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: 7px;
            top: 24px;
            bottom: -20px;
            width: 2px;
            background: var(--border-color);
        }

        .timeline-item:last-child::before {
            display: none;
        }

        .timeline-marker {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            flex-shrink: 0;
            margin-top: 4px;
        }

        .timeline-item.user .timeline-marker { background: var(--accent-cyan); }
        .timeline-item.agent .timeline-marker { background: var(--accent-green); }
        .timeline-item.system .timeline-marker { background: var(--accent-yellow); }
        .timeline-item.action .timeline-marker { background: var(--accent-purple); }

        .timeline-content {
            flex: 1;
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 12px 15px;
        }

        .timeline-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .timeline-sender {
            font-weight: 600;
            color: var(--text-primary);
        }

        .timeline-item.user .timeline-sender { color: var(--accent-cyan); }
        .timeline-item.agent .timeline-sender { color: var(--accent-green); }
        .timeline-item.system .timeline-sender { color: var(--accent-yellow); }
        .timeline-item.action .timeline-sender { color: var(--accent-purple); }

        .timeline-time {
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .timeline-message {
            color: var(--text-primary);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .commit-badge {
            background: var(--bg-tertiary);
            color: var(--accent-purple);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-family: 'Roboto Mono', monospace;
            margin-left: 8px;
            border: 1px solid var(--accent-purple);
            opacity: 0.8;
        }

        .commit-badge:hover {
            opacity: 1;
            background: rgba(167, 139, 250, 0.1);
        }

        /* Markmap Tab Styles */
        .markmap-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .markmap-controls label {
            display: flex;
            align-items: center;
            gap: 6px;
            color: var(--text-secondary);
            font-size: 0.85rem;
            cursor: pointer;
        }

        .markmap-controls input[type="checkbox"] {
            accent-color: var(--accent-cyan);
        }

        .markmap-container {
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 15px;
            min-height: 600px;
            position: relative;
        }

        .markmap-container.fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1000;
            border-radius: 0;
            margin: 0;
        }

        #markmap-svg {
            background: var(--bg-tertiary);
        }

        /* Test result status badges */
        .status-badge.passed {
            background: rgba(74, 222, 128, 0.2);
            color: var(--accent-green);
        }

        .status-badge.failed {
            background: rgba(239, 68, 68, 0.2);
            color: var(--accent-red);
        }

        .status-badge.skipped {
            background: rgba(250, 204, 21, 0.2);
            color: var(--accent-yellow);
        }

        .status-badge.running {
            background: rgba(0, 217, 255, 0.2);
            color: var(--accent-cyan);
            animation: pulse 1.5s infinite;
        }

        .status-badge.generated {
            background: rgba(34, 211, 238, 0.2);
            color: #22d3ee;
        }

        .btn-small {
            padding: 4px 10px;
            font-size: 0.75rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-small:hover {
            background: var(--accent-cyan);
            color: white;
            border-color: var(--accent-cyan);
        }

        .mcp-badge {
            padding: 4px 8px;
            font-size: 0.7rem;
            font-weight: 600;
            background: var(--accent-cyan);
            color: white;
            border-radius: 4px;
            text-transform: uppercase;
        }

        .btn-primary {
            background: linear-gradient(135deg, #22d3ee, #0891b2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(34, 211, 238, 0.3);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes slideIn {
            from { transform: translateX(100px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Results filter dropdown */
        #results-filter {
            padding: 6px 10px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.85rem;
        }

        /* Expandable test result rows */
        .test-result-row {
            cursor: pointer;
            transition: background 0.2s;
        }

        .test-result-row:hover {
            background: var(--bg-primary) !important;
        }

        .test-result-row.expanded {
            background: var(--bg-primary);
        }

        .test-detail-row td {
            font-size: 0.9rem;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .metrics-row {
                grid-template-columns: repeat(2, 1fr);
            }

            .two-column {
                grid-template-columns: 1fr;
            }

            .gait-controls {
                flex-wrap: wrap;
            }
        }

        /* Logs Viewer Styles */
        .logs-container {
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 15px;
            min-height: 600px;
            max-height: 800px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            position: relative;
        }

        .log-entry {
            padding: 8px 10px;
            border-bottom: 1px solid var(--border-color);
            white-space: pre-wrap;
            word-wrap: break-word;
            line-height: 1.4;
        }

        .log-entry:hover {
            background: rgba(255, 255, 255, 0.03);
        }

        .log-entry.error {
            background: rgba(239, 68, 68, 0.1);
            border-left: 3px solid var(--accent-red);
        }

        .log-entry.warning {
            background: rgba(250, 204, 21, 0.1);
            border-left: 3px solid var(--accent-yellow);
        }

        .log-entry.info {
            border-left: 3px solid var(--accent-cyan);
        }

        .log-timestamp {
            color: var(--text-secondary);
            margin-right: 10px;
        }

        .log-level {
            font-weight: bold;
            margin-right: 10px;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.75rem;
        }

        .log-level.ERROR {
            background: rgba(239, 68, 68, 0.2);
            color: var(--accent-red);
        }

        .log-level.WARNING {
            background: rgba(250, 204, 21, 0.2);
            color: var(--accent-yellow);
        }

        .log-level.INFO {
            background: rgba(0, 217, 255, 0.2);
            color: var(--accent-cyan);
        }

        .log-level.DEBUG {
            background: rgba(167, 139, 250, 0.2);
            color: var(--accent-purple);
        }

        .logs-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .logs-controls button {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }

        .logs-controls button.primary {
            background: var(--accent-green);
            color: var(--bg-primary);
        }

        .logs-controls button.secondary {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }

        .logs-controls button:hover {
            opacity: 0.8;
        }

        .logs-controls button.paused {
            background: var(--accent-yellow);
            color: var(--bg-primary);
        }

        .logs-status {
            color: var(--text-secondary);
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logs-status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent-green);
        }

        .logs-status-dot.paused {
            background: var(--accent-yellow);
        }

        .logs-filter {
            padding: 6px 10px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.85rem;
        }

        @media (max-width: 768px) {
            .agent-info-banner {
                grid-template-columns: 1fr 1fr;
            }

            .header-left {
                flex-direction: column;
                align-items: flex-start;
            }

            .markmap-controls {
                flex-wrap: wrap;
            }
        }
    </style>
    <!-- Chart.js for Prometheus visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-left">
                <h1 id="agent-name">Agent Dashboard</h1>
                <span class="agent-badge" id="agent-role">Router</span>
                <div class="connection-status">
                    <span class="status-dot connected" id="ws-status"></span>
                    <span id="connection-text">Connected</span>
                </div>
            </div>
            <div class="nav-links">
                <a href="/topology3d" class="nav-link" id="agent3dViewLink">My 3D View</a>
                <a href="/topology3d" class="nav-link">Network 3D</a>
                <a href="/monitor" class="nav-link">Full Topology</a>
                <a href="/" class="nav-link">Chat</a>
            </div>
        </header>

        <!-- Agent Info Banner -->
        <div class="agent-info-banner">
            <div class="info-item">
                <span class="info-label">Router ID</span>
                <span class="info-value" id="router-id">--</span>
            </div>
            <div class="info-item">
                <span class="info-label">LLM Model</span>
                <span class="info-value" id="llm-model">--</span>
            </div>
            <div class="info-item">
                <span class="info-label">Uptime</span>
                <span class="info-value" id="uptime">--</span>
            </div>
            <div class="info-item">
                <span class="info-label">LLM Provider</span>
                <span class="info-value" id="llm-provider">--</span>
            </div>
            <div class="info-item">
                <span class="info-label">Active Protocols</span>
                <span class="info-value" id="active-protocols">0</span>
            </div>
            <div class="info-item">
                <span class="info-label">Total Neighbors</span>
                <span class="info-value" id="total-neighbors">0</span>
            </div>
        </div>

        <!-- Protocol Tabs -->
        <div class="protocol-tabs" id="protocol-tabs">
            <!-- Tabs will be dynamically generated -->
        </div>

        <!-- Chat Content -->
        <div class="protocol-content active" id="chat-content">
            <div class="metrics-row">
                <div class="metric-card chat">
                    <div class="metric-label">Messages Sent</div>
                    <div class="metric-value" id="chat-sent">0</div>
                </div>
                <div class="metric-card chat">
                    <div class="metric-label">Responses</div>
                    <div class="metric-value" id="chat-received">0</div>
                </div>
                <div class="metric-card chat">
                    <div class="metric-label">Session</div>
                    <div class="metric-value" id="chat-session">Active</div>
                </div>
                <div class="metric-card chat">
                    <div class="metric-label">Provider</div>
                    <div class="metric-value" id="chat-provider">--</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Chat with ASI Agent</h3>
                    <span style="font-size: 0.85rem; color: var(--text-secondary);">Ask about routing, neighbors, protocols</span>
                </div>
                <div class="chat-container">
                    <div class="chat-messages" id="chat-messages">
                        <div class="chat-message system">
                            Welcome! Ask me about your routing protocols, neighbors, or routes.<br>
                            <span style="font-size: 0.85rem;">Try: "How many neighbors do I have?" or "Show me the BGP routes"</span>
                        </div>
                    </div>
                    <div class="chat-input-area">
                        <input type="text" class="chat-input" id="chat-input" placeholder="Ask ASI something..." autocomplete="off">
                        <button class="chat-send-btn" id="chat-send-btn">Send</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interfaces Content -->
        <div class="protocol-content" id="interfaces-content">
            <div class="metrics-row">
                <div class="metric-card interfaces">
                    <div class="metric-label">Total Interfaces</div>
                    <div class="metric-value" id="if-total">0</div>
                </div>
                <div class="metric-card interfaces">
                    <div class="metric-label">Up</div>
                    <div class="metric-value" id="if-up">0</div>
                </div>
                <div class="metric-card interfaces">
                    <div class="metric-label">Down</div>
                    <div class="metric-value" id="if-down">0</div>
                </div>
                <div class="metric-card interfaces">
                    <div class="metric-label">With IP</div>
                    <div class="metric-value" id="if-with-ip">0</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Interface Configuration</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Type</th>
                            <th>IP Address(es)</th>
                            <th>MTU</th>
                            <th>Status</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody id="interfaces-table">
                        <tr><td colspan="6" class="empty-state">No interfaces configured</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- OSPF Content -->
        <div class="protocol-content" id="ospf-content">
            <div class="metrics-row">
                <div class="metric-card ospf">
                    <div class="metric-label">Neighbors</div>
                    <div class="metric-value" id="ospf-neighbors">0</div>
                </div>
                <div class="metric-card ospf">
                    <div class="metric-label">Full Adjacencies</div>
                    <div class="metric-value" id="ospf-full">0</div>
                </div>
                <div class="metric-card ospf">
                    <div class="metric-label">LSDB Size</div>
                    <div class="metric-value" id="ospf-lsdb">0 <span class="metric-unit">LSAs</span></div>
                </div>
                <div class="metric-card ospf">
                    <div class="metric-label">Routes</div>
                    <div class="metric-value" id="ospf-routes">0</div>
                </div>
            </div>

            <div class="two-column">
                <div class="section">
                    <div class="section-header">
                        <h3>OSPF Neighbors</h3>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Neighbor ID</th>
                                <th>IP Address</th>
                                <th>State</th>
                                <th>DR/BDR</th>
                            </tr>
                        </thead>
                        <tbody id="ospf-neighbors-table">
                            <tr><td colspan="4" class="empty-state">No neighbors</td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <div class="section-header">
                        <h3>OSPF Routes</h3>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Prefix</th>
                                <th>Next Hop</th>
                                <th>Interface</th>
                                <th>Cost</th>
                                <th>Type</th>
                            </tr>
                        </thead>
                        <tbody id="ospf-routes-table">
                            <tr><td colspan="5" class="empty-state">No routes</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- OSPFv3 (IPv6) Content -->
        <div class="protocol-content" id="ospfv3-content">
            <div class="metrics-row">
                <div class="metric-card ospfv3">
                    <div class="metric-label">Neighbors</div>
                    <div class="metric-value" id="ospfv3-neighbors">0</div>
                </div>
                <div class="metric-card ospfv3">
                    <div class="metric-label">Full Adjacencies</div>
                    <div class="metric-value" id="ospfv3-full">0</div>
                </div>
                <div class="metric-card ospfv3">
                    <div class="metric-label">LSDB Size</div>
                    <div class="metric-value" id="ospfv3-lsdb">0 <span class="metric-unit">LSAs</span></div>
                </div>
                <div class="metric-card ospfv3">
                    <div class="metric-label">IPv6 Routes</div>
                    <div class="metric-value" id="ospfv3-routes">0</div>
                </div>
            </div>

            <div class="two-column">
                <div class="section">
                    <div class="section-header">
                        <h3>OSPFv3 Neighbors</h3>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Neighbor ID</th>
                                <th>IPv6 Address</th>
                                <th>State</th>
                                <th>Interface</th>
                            </tr>
                        </thead>
                        <tbody id="ospfv3-neighbors-table">
                            <tr><td colspan="4" class="empty-state">No IPv6 neighbors</td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <div class="section-header">
                        <h3>OSPFv3 IPv6 Routes</h3>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>IPv6 Prefix</th>
                                <th>Next Hop</th>
                                <th>Interface</th>
                                <th>Cost</th>
                                <th>Type</th>
                            </tr>
                        </thead>
                        <tbody id="ospfv3-routes-table">
                            <tr><td colspan="5" class="empty-state">No IPv6 routes</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- BGP Content -->
        <div class="protocol-content" id="bgp-content">
            <div class="metrics-row">
                <div class="metric-card bgp">
                    <div class="metric-label">Configured Peers</div>
                    <div class="metric-value" id="bgp-peers">0</div>
                </div>
                <div class="metric-card bgp">
                    <div class="metric-label">Established</div>
                    <div class="metric-value" id="bgp-established">0</div>
                </div>
                <div class="metric-card bgp">
                    <div class="metric-label">Prefixes Received</div>
                    <div class="metric-value" id="bgp-prefixes-in">0</div>
                </div>
                <div class="metric-card bgp">
                    <div class="metric-label">Prefixes Advertised</div>
                    <div class="metric-value" id="bgp-prefixes-out">0</div>
                </div>
            </div>

            <!-- BGP Address Family Tabs -->
            <div class="bgp-afi-tabs" style="display: flex; gap: 10px; margin-bottom: 15px;">
                <button class="afi-tab active" data-afi="ipv4" style="padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; background: var(--accent-cyan); color: white; font-weight: 500;">IPv4 Unicast</button>
                <button class="afi-tab" data-afi="ipv6" style="padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; background: var(--bg-tertiary); color: var(--text-secondary);">IPv6 Unicast</button>
                <button class="afi-tab" data-afi="vpnv4" style="padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; background: var(--bg-tertiary); color: var(--text-secondary);">VPNv4</button>
                <button class="afi-tab" data-afi="evpn" style="padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; background: var(--bg-tertiary); color: var(--text-secondary);">EVPN</button>
            </div>

            <!-- IPv4 Unicast AFI -->
            <div class="bgp-afi-content active" id="bgp-afi-ipv4">
                <div class="two-column">
                    <div class="section">
                        <div class="section-header">
                            <h3>BGP IPv4 Peers</h3>
                        </div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Peer IP</th>
                                    <th>Remote AS</th>
                                    <th>State</th>
                                    <th>Type</th>
                                    <th>Prefixes</th>
                                </tr>
                            </thead>
                            <tbody id="bgp-peers-table">
                                <tr><td colspan="5" class="empty-state">No IPv4 peers</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="section">
                        <div class="section-header">
                            <h3>BGP IPv4 Routes (Loc-RIB)</h3>
                        </div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Prefix</th>
                                    <th>Next Hop</th>
                                    <th>Interface</th>
                                    <th>AS Path</th>
                                    <th>Origin</th>
                                </tr>
                            </thead>
                            <tbody id="bgp-routes-table">
                                <tr><td colspan="5" class="empty-state">No IPv4 routes</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- IPv6 Unicast AFI -->
            <div class="bgp-afi-content" id="bgp-afi-ipv6" style="display: none;">
                <div class="two-column">
                    <div class="section">
                        <div class="section-header">
                            <h3>BGP IPv6 Peers</h3>
                        </div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Peer IPv6</th>
                                    <th>Remote AS</th>
                                    <th>State</th>
                                    <th>Type</th>
                                    <th>Prefixes</th>
                                </tr>
                            </thead>
                            <tbody id="bgp-ipv6-peers-table">
                                <tr><td colspan="5" class="empty-state">No IPv6 peers</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="section">
                        <div class="section-header">
                            <h3>BGP IPv6 Routes (Loc-RIB)</h3>
                        </div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>IPv6 Prefix</th>
                                    <th>Next Hop</th>
                                    <th>Interface</th>
                                    <th>AS Path</th>
                                    <th>Origin</th>
                                </tr>
                            </thead>
                            <tbody id="bgp-ipv6-routes-table">
                                <tr><td colspan="5" class="empty-state">No IPv6 routes</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- VPNv4 AFI -->
            <div class="bgp-afi-content" id="bgp-afi-vpnv4" style="display: none;">
                <div class="section">
                    <div class="section-header">
                        <h3>VPNv4 Routes</h3>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>RD</th>
                                <th>Prefix</th>
                                <th>Next Hop</th>
                                <th>RT Import</th>
                                <th>RT Export</th>
                                <th>AS Path</th>
                            </tr>
                        </thead>
                        <tbody id="bgp-vpnv4-routes-table">
                            <tr><td colspan="6" class="empty-state">No VPNv4 routes</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- EVPN AFI -->
            <div class="bgp-afi-content" id="bgp-afi-evpn" style="display: none;">
                <div class="section">
                    <div class="section-header">
                        <h3>EVPN Routes</h3>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>RD</th>
                                <th>Type</th>
                                <th>MAC/IP</th>
                                <th>VNI</th>
                                <th>Next Hop</th>
                                <th>RT</th>
                            </tr>
                        </thead>
                        <tbody id="bgp-evpn-routes-table">
                            <tr><td colspan="6" class="empty-state">No EVPN routes</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- IS-IS Content -->
        <div class="protocol-content" id="isis-content">
            <div class="metrics-row">
                <div class="metric-card isis">
                    <div class="metric-label">Adjacencies</div>
                    <div class="metric-value" id="isis-adjacencies">0</div>
                </div>
                <div class="metric-card isis">
                    <div class="metric-label">LSP Count</div>
                    <div class="metric-value" id="isis-lsps">0</div>
                </div>
                <div class="metric-card isis">
                    <div class="metric-label">Level</div>
                    <div class="metric-value" id="isis-level">L1/L2</div>
                </div>
                <div class="metric-card isis">
                    <div class="metric-label">Area</div>
                    <div class="metric-value" id="isis-area">--</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>IS-IS Adjacencies</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>System ID</th>
                            <th>Interface</th>
                            <th>Level</th>
                            <th>State</th>
                            <th>Hold Time</th>
                        </tr>
                    </thead>
                    <tbody id="isis-adjacencies-table">
                        <tr><td colspan="5" class="empty-state">No adjacencies</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- MPLS Content -->
        <div class="protocol-content" id="mpls-content">
            <div class="metrics-row">
                <div class="metric-card mpls">
                    <div class="metric-label">LFIB Entries</div>
                    <div class="metric-value" id="mpls-lfib">0</div>
                </div>
                <div class="metric-card mpls">
                    <div class="metric-label">Labels Allocated</div>
                    <div class="metric-value" id="mpls-labels">0</div>
                </div>
                <div class="metric-card mpls">
                    <div class="metric-label">LDP Neighbors</div>
                    <div class="metric-value" id="mpls-ldp-neighbors">0</div>
                </div>
                <div class="metric-card mpls">
                    <div class="metric-label">Packets Switched</div>
                    <div class="metric-value" id="mpls-packets">0</div>
                </div>
            </div>

            <div class="two-column">
                <div class="section">
                    <div class="section-header">
                        <h3>Label Forwarding Table (LFIB)</h3>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>In Label</th>
                                <th>Out Label</th>
                                <th>Next Hop</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="mpls-lfib-table">
                            <tr><td colspan="4" class="empty-state">No entries</td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <div class="section-header">
                        <h3>LDP Sessions</h3>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Peer</th>
                                <th>State</th>
                                <th>Labels Sent</th>
                                <th>Labels Rcvd</th>
                            </tr>
                        </thead>
                        <tbody id="mpls-ldp-table">
                            <tr><td colspan="4" class="empty-state">No sessions</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- VXLAN/EVPN Content -->
        <div class="protocol-content" id="vxlan-content">
            <div class="metrics-row">
                <div class="metric-card vxlan">
                    <div class="metric-label">VNIs</div>
                    <div class="metric-value" id="vxlan-vnis">0</div>
                </div>
                <div class="metric-card vxlan">
                    <div class="metric-label">VTEPs</div>
                    <div class="metric-value" id="vxlan-vteps">0</div>
                </div>
                <div class="metric-card vxlan">
                    <div class="metric-label">MAC Entries</div>
                    <div class="metric-value" id="vxlan-macs">0</div>
                </div>
                <div class="metric-card vxlan">
                    <div class="metric-label">EVPN Routes</div>
                    <div class="metric-value" id="vxlan-routes">0</div>
                </div>
            </div>

            <div class="two-column">
                <div class="section">
                    <div class="section-header">
                        <h3>VNI Table</h3>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>VNI</th>
                                <th>Type</th>
                                <th>VLAN</th>
                                <th>VTEPs</th>
                            </tr>
                        </thead>
                        <tbody id="vxlan-vni-table">
                            <tr><td colspan="4" class="empty-state">No VNIs</td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <div class="section-header">
                        <h3>Remote VTEPs</h3>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>VTEP IP</th>
                                <th>VNIs</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="vxlan-vtep-table">
                            <tr><td colspan="3" class="empty-state">No VTEPs</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- DHCP Content -->
        <div class="protocol-content" id="dhcp-content">
            <div class="metrics-row">
                <div class="metric-card dhcp">
                    <div class="metric-label">Active Pools</div>
                    <div class="metric-value" id="dhcp-pools">0</div>
                </div>
                <div class="metric-card dhcp">
                    <div class="metric-label">Active Leases</div>
                    <div class="metric-value" id="dhcp-leases">0</div>
                </div>
                <div class="metric-card dhcp">
                    <div class="metric-label">Available IPs</div>
                    <div class="metric-value" id="dhcp-available">0</div>
                </div>
                <div class="metric-card dhcp">
                    <div class="metric-label">DHCP Requests</div>
                    <div class="metric-value" id="dhcp-requests">0</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>DHCP Leases</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>IP Address</th>
                            <th>MAC Address</th>
                            <th>Hostname</th>
                            <th>Expires</th>
                            <th>State</th>
                        </tr>
                    </thead>
                    <tbody id="dhcp-leases-table">
                        <tr><td colspan="5" class="empty-state">No leases</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- DNS Content -->
        <div class="protocol-content" id="dns-content">
            <div class="metrics-row">
                <div class="metric-card dns">
                    <div class="metric-label">Zones</div>
                    <div class="metric-value" id="dns-zones">0</div>
                </div>
                <div class="metric-card dns">
                    <div class="metric-label">Records</div>
                    <div class="metric-value" id="dns-records">0</div>
                </div>
                <div class="metric-card dns">
                    <div class="metric-label">Queries/min</div>
                    <div class="metric-value" id="dns-queries">0</div>
                </div>
                <div class="metric-card dns">
                    <div class="metric-label">Cache Hits</div>
                    <div class="metric-value" id="dns-cache-hits">0<span class="metric-unit">%</span></div>
                </div>
            </div>

            <div class="two-column">
                <div class="section">
                    <div class="section-header">
                        <h3>DNS Zones</h3>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Zone</th>
                                <th>Type</th>
                                <th>Records</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="dns-zones-table">
                            <tr><td colspan="4" class="empty-state">No zones</td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <div class="section-header">
                        <h3>Recent Queries</h3>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Query</th>
                                <th>Type</th>
                                <th>Result</th>
                                <th>Time</th>
                            </tr>
                        </thead>
                        <tbody id="dns-queries-table">
                            <tr><td colspan="4" class="empty-state">No queries</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Testing Content (pyATS MCP) -->
        <div class="protocol-content" id="testing-content">
            <div class="metrics-row">
                <div class="metric-card testing">
                    <div class="metric-label">Tests Selected</div>
                    <div class="metric-value" id="testing-suites">0</div>
                </div>
                <div class="metric-card testing">
                    <div class="metric-label">Last Run</div>
                    <div class="metric-value" id="testing-last-run">Never</div>
                </div>
                <div class="metric-card testing">
                    <div class="metric-label">Pass Rate</div>
                    <div class="metric-value" id="testing-pass-rate">--<span class="metric-unit">%</span></div>
                </div>
                <div class="metric-card testing">
                    <div class="metric-label">pyATS MCP</div>
                    <div class="metric-value" id="testing-mcp-status" style="font-size: 1rem;">Ready</div>
                </div>
            </div>

            <div class="two-column">
                <div class="section">
                    <div class="section-header">
                        <h3>pyATS Test Suites</h3>
                        <span class="mcp-badge" id="pyats-mcp-status">MCP</span>
                    </div>
                    <p style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 15px;">
                        Select tests to run via pyATS MCP. Tests are dynamically generated based on agent configuration.
                    </p>
                    <div id="test-suites-list">
                        <div class="test-suite-item">
                            <label class="test-suite-checkbox">
                                <input type="checkbox" checked data-pyats-type="comprehensive">
                                Full Self-Assessment
                            </label>
                            <span class="test-count">All checks</span>
                        </div>
                        <div class="test-suite-item">
                            <label class="test-suite-checkbox">
                                <input type="checkbox" data-pyats-type="connectivity">
                                Connectivity Tests
                            </label>
                            <span class="test-count">Ping neighbors</span>
                        </div>
                        <div class="test-suite-item">
                            <label class="test-suite-checkbox">
                                <input type="checkbox" data-pyats-type="interfaces">
                                Interface Tests
                            </label>
                            <span class="test-count">State validation</span>
                        </div>
                        <div class="test-suite-item">
                            <label class="test-suite-checkbox">
                                <input type="checkbox" data-pyats-type="ospf">
                                OSPF Tests
                            </label>
                            <span class="test-count">Neighbor state</span>
                        </div>
                        <div class="test-suite-item">
                            <label class="test-suite-checkbox">
                                <input type="checkbox" data-pyats-type="bgp">
                                BGP Tests
                            </label>
                            <span class="test-count">Peer state</span>
                        </div>
                    </div>

                    <div style="margin-top: 20px; display: flex; gap: 10px;">
                        <button class="btn btn-primary" id="run-pyats-mcp-btn">
                            Run Selected Tests
                        </button>
                        <button class="btn btn-secondary" id="select-all-tests-btn">
                            Select All
                        </button>
                    </div>

                    <div class="section" style="margin-top: 20px;">
                        <div class="section-header">
                            <h3>Test Schedule</h3>
                        </div>
                        <div class="schedule-form">
                            <div class="form-row">
                                <label>Run tests every:</label>
                                <select id="schedule-interval">
                                    <option value="0">Manual only</option>
                                    <option value="15">15 minutes</option>
                                    <option value="30">30 minutes</option>
                                    <option value="60" selected>1 hour</option>
                                    <option value="360">6 hours</option>
                                    <option value="1440">24 hours</option>
                                </select>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="schedule-on-change" checked>
                                    Run on configuration change
                                </label>
                            </div>
                            <button class="btn btn-secondary" id="save-schedule-btn">Save Schedule</button>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-header">
                        <h3>Test Results</h3>
                        <select id="results-filter">
                            <option value="all">All Results</option>
                            <option value="failed">Failed Only</option>
                            <option value="passed">Passed Only</option>
                        </select>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Test</th>
                                <th>Suite</th>
                                <th>Status</th>
                                <th>Duration</th>
                                <th>Time</th>
                            </tr>
                        </thead>
                        <tbody id="test-results-table">
                            <tr><td colspan="5" class="empty-state">No test results yet. Run tests to see results.</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- GAIT Content (Conversation History) -->
        <div class="protocol-content" id="gait-content">
            <div class="metrics-row">
                <div class="metric-card gait">
                    <div class="metric-label">Total Turns</div>
                    <div class="metric-value" id="gait-turns">0</div>
                </div>
                <div class="metric-card gait">
                    <div class="metric-label">User Messages</div>
                    <div class="metric-value" id="gait-user-msgs">0</div>
                </div>
                <div class="metric-card gait">
                    <div class="metric-label">Agent Responses</div>
                    <div class="metric-value" id="gait-agent-msgs">0</div>
                </div>
                <div class="metric-card gait">
                    <div class="metric-label">Actions Taken</div>
                    <div class="metric-value" id="gait-actions">0</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Conversation History</h3>
                    <div class="gait-controls">
                        <input type="text" id="gait-search" placeholder="Search conversations..." class="search-input">
                        <select id="gait-filter">
                            <option value="all">All Messages</option>
                            <option value="user">User Only</option>
                            <option value="agent">Agent Only</option>
                            <option value="system">System Only</option>
                            <option value="action">Actions Only</option>
                        </select>
                        <button class="btn btn-secondary" id="export-gait-btn">Export Logs</button>
                    </div>
                </div>
                <div class="conversation-timeline" id="gait-timeline">
                    <div class="timeline-item user">
                        <div class="timeline-marker"></div>
                        <div class="timeline-content">
                            <div class="timeline-header">
                                <span class="timeline-sender">User</span>
                                <span class="timeline-time">--</span>
                            </div>
                            <div class="timeline-message">No conversation history available. GAIT tracking will record all interactions.</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Markmap Content (Mind Map Visualization) -->
        <div class="protocol-content" id="markmap-content">
            <div class="section">
                <div class="section-header">
                    <h3>Agent State Mind Map</h3>
                    <div class="markmap-controls" style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                        <label style="display: flex; align-items: center; gap: 5px;">
                            <input type="checkbox" id="markmap-auto-refresh" checked>
                            Auto-refresh
                        </label>
                        <select id="markmap-refresh-interval" style="background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); padding: 4px 8px; border-radius: 4px;">
                            <option value="1">Every 1 min</option>
                            <option value="5" selected>Every 5 min</option>
                            <option value="10">Every 10 min</option>
                            <option value="30">Every 30 min</option>
                        </select>
                        <span style="color: var(--text-secondary); font-size: 0.85rem;">
                            Last: <span id="markmap-last-refresh">--</span>
                        </span>
                        <span style="color: var(--text-secondary); font-size: 0.85rem;">
                            Next: <span id="markmap-next-refresh">--</span>
                        </span>
                        <button class="btn btn-secondary" id="markmap-refresh-btn">Refresh Now</button>
                        <button class="btn btn-secondary" id="markmap-export-btn">Export SVG</button>
                        <button class="btn btn-secondary" id="markmap-fullscreen-btn">Fullscreen</button>
                    </div>
                </div>
                <div class="markmap-container" id="markmap-container">
                    <svg id="markmap-svg" style="width: 100%; height: 600px;"></svg>
                </div>
            </div>
        </div>

        <!-- Metrics Content (Prometheus MCP) -->
        <!-- Prometheus Content (Agent Metrics Visualization) -->
        <div class="protocol-content" id="prometheus-content" style="height: 700px !important; max-height: 700px !important; overflow-y: auto !important; overflow-x: hidden !important;">
            <div class="metrics-row">
                <div class="metric-card prometheus" style="border-left-color: #e6522c;">
                    <div class="metric-label">Total Metrics</div>
                    <div class="metric-value" id="prometheus-total">0</div>
                </div>
                <div class="metric-card prometheus" style="border-left-color: #e6522c;">
                    <div class="metric-label">Gauges</div>
                    <div class="metric-value" id="prometheus-gauges">0</div>
                </div>
                <div class="metric-card prometheus" style="border-left-color: #e6522c;">
                    <div class="metric-label">Counters</div>
                    <div class="metric-value" id="prometheus-counters">0</div>
                </div>
                <div class="metric-card prometheus" style="border-left-color: #e6522c;">
                    <div class="metric-label">Histograms</div>
                    <div class="metric-value" id="prometheus-histograms">0</div>
                </div>
            </div>

            <!-- System Resources Panel -->
            <div class="section" style="margin-bottom: 20px;">
                <div class="section-header">
                    <h3 style="color: #e6522c;">System Resources</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                    <!-- CPU Panel -->
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 20px; text-align: center; border: 1px solid var(--border-color);">
                        <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 10px;">CPU Usage</div>
                        <div id="prometheus-cpu-value" style="font-size: 2.5rem; font-weight: bold; color: #3b82f6;">0%</div>
                        <div style="margin-top: 10px; height: 8px; background: var(--bg-secondary); border-radius: 4px; overflow: hidden;">
                            <div id="prometheus-cpu-bar" style="height: 100%; width: 0%; background: linear-gradient(90deg, #3b82f6, #60a5fa); transition: width 0.3s;"></div>
                        </div>
                    </div>
                    <!-- Memory Panel -->
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 20px; text-align: center; border: 1px solid var(--border-color);">
                        <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 10px;">Memory Usage</div>
                        <div id="prometheus-memory-value" style="font-size: 2.5rem; font-weight: bold; color: #a855f7;">0%</div>
                        <div style="margin-top: 10px; height: 8px; background: var(--bg-secondary); border-radius: 4px; overflow: hidden;">
                            <div id="prometheus-memory-bar" style="height: 100%; width: 0%; background: linear-gradient(90deg, #a855f7, #c084fc); transition: width 0.3s;"></div>
                        </div>
                    </div>
                    <!-- Disk Panel -->
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 20px; text-align: center; border: 1px solid var(--border-color);">
                        <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 10px;">Disk Usage</div>
                        <div id="prometheus-disk-value" style="font-size: 2.5rem; font-weight: bold; color: #22c55e;">0%</div>
                        <div style="margin-top: 10px; height: 8px; background: var(--bg-secondary); border-radius: 4px; overflow: hidden;">
                            <div id="prometheus-disk-bar" style="height: 100%; width: 0%; background: linear-gradient(90deg, #22c55e, #4ade80); transition: width 0.3s;"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3 style="color: #e6522c;">Agent State Metrics</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <label style="display: flex; align-items: center; gap: 5px; font-size: 0.85rem;">
                            <input type="checkbox" id="prometheus-auto-refresh" checked>
                            Auto-refresh
                        </label>
                        <select id="prometheus-refresh-interval" style="background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); padding: 4px 8px; border-radius: 4px;">
                            <option value="5000">5s</option>
                            <option value="10000" selected>10s</option>
                            <option value="30000">30s</option>
                            <option value="60000">1m</option>
                        </select>
                        <button class="btn btn-secondary" id="prometheus-refresh-btn">Refresh Now</button>
                    </div>
                </div>

                <!-- Interface Traffic - Separate RX/TX charts for better visibility -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; height: 200px; max-height: 200px; overflow: hidden;">
                        <h4 style="margin: 0 0 10px 0; color: #22d3ee;">Interface RX (bytes)</h4>
                        <div style="height: 150px; max-height: 150px;">
                            <canvas id="prometheus-rx-chart"></canvas>
                        </div>
                    </div>
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; height: 200px; max-height: 200px; overflow: hidden;">
                        <h4 style="margin: 0 0 10px 0; color: #f97316;">Interface TX (bytes)</h4>
                        <div style="height: 150px; max-height: 150px;">
                            <canvas id="prometheus-tx-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- OSPF Protocol Dashboard (shown dynamically when OSPF is active) -->
            <div class="section" id="prometheus-ospf-section" style="display: none;">
                <div class="section-header">
                    <h3 style="color: #4ade80;">OSPF Protocol Dashboard</h3>
                    <div style="display: flex; gap: 15px; align-items: center;">
                        <span id="ospf-neighbor-badge" class="status-badge" style="background: #22c55e; color: white;">0 Neighbors</span>
                        <span id="ospf-lsdb-badge" class="status-badge" style="background: #3b82f6; color: white;">0 LSAs</span>
                        <span id="ospf-routes-badge" class="status-badge" style="background: #a855f7; color: white;">0 Routes</span>
                    </div>
                </div>

                <!-- OSPF Stats Cards -->
                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px; margin-bottom: 20px;">
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; text-align: center; border-left: 3px solid #4ade80;">
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Hello Sent</div>
                        <div id="ospf-hello-sent" style="font-size: 1.5rem; font-weight: bold; color: #4ade80;">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; text-align: center; border-left: 3px solid #22d3ee;">
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Hello Recv</div>
                        <div id="ospf-hello-recv" style="font-size: 1.5rem; font-weight: bold; color: #22d3ee;">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; text-align: center; border-left: 3px solid #f97316;">
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">DBD</div>
                        <div id="ospf-dbd-total" style="font-size: 1.5rem; font-weight: bold; color: #f97316;">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; text-align: center; border-left: 3px solid #a855f7;">
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">LSU</div>
                        <div id="ospf-lsu-total" style="font-size: 1.5rem; font-weight: bold; color: #a855f7;">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; text-align: center; border-left: 3px solid #ec4899;">
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">LSAck</div>
                        <div id="ospf-lsack-total" style="font-size: 1.5rem; font-weight: bold; color: #ec4899;">0</div>
                    </div>
                </div>

                <!-- OSPF Charts -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; height: 200px; max-height: 200px; overflow: hidden;">
                        <h4 style="margin: 0 0 10px 0; color: #4ade80;">OSPF Neighbors Timeline</h4>
                        <div style="height: 150px; max-height: 150px;">
                            <canvas id="ospf-neighbors-chart"></canvas>
                        </div>
                    </div>
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; height: 200px; max-height: 200px; overflow: hidden;">
                        <h4 style="margin: 0 0 10px 0; color: #4ade80;">OSPF Message Types</h4>
                        <div style="height: 150px; max-height: 150px;">
                            <canvas id="ospf-messages-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- BGP Protocol Dashboard (shown dynamically when BGP is active) -->
            <div class="section" id="prometheus-bgp-section" style="display: none;">
                <div class="section-header">
                    <h3 style="color: #3b82f6;">BGP Protocol Dashboard</h3>
                    <div style="display: flex; gap: 15px; align-items: center;">
                        <span id="bgp-peers-badge" class="status-badge" style="background: #3b82f6; color: white;">0 Peers</span>
                        <span id="bgp-established-badge" class="status-badge" style="background: #22c55e; color: white;">0 Established</span>
                        <span id="bgp-routes-badge" class="status-badge" style="background: #a855f7; color: white;">0 Routes</span>
                    </div>
                </div>

                <!-- BGP Stats Cards -->
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 20px;">
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; text-align: center; border-left: 3px solid #3b82f6;">
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">OPEN</div>
                        <div id="bgp-open-total" style="font-size: 1.5rem; font-weight: bold; color: #3b82f6;">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; text-align: center; border-left: 3px solid #22c55e;">
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">UPDATE</div>
                        <div id="bgp-update-total" style="font-size: 1.5rem; font-weight: bold; color: #22c55e;">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; text-align: center; border-left: 3px solid #f97316;">
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">KEEPALIVE</div>
                        <div id="bgp-keepalive-total" style="font-size: 1.5rem; font-weight: bold; color: #f97316;">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; text-align: center; border-left: 3px solid #ef4444;">
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">NOTIFICATION</div>
                        <div id="bgp-notification-total" style="font-size: 1.5rem; font-weight: bold; color: #ef4444;">0</div>
                    </div>
                </div>

                <!-- BGP Charts -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; height: 200px; max-height: 200px; overflow: hidden;">
                        <h4 style="margin: 0 0 10px 0; color: #3b82f6;">BGP Peers Timeline</h4>
                        <div style="height: 150px; max-height: 150px;">
                            <canvas id="bgp-peers-chart"></canvas>
                        </div>
                    </div>
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; height: 200px; max-height: 200px; overflow: hidden;">
                        <h4 style="margin: 0 0 10px 0; color: #3b82f6;">BGP Message Types</h4>
                        <div style="height: 150px; max-height: 150px;">
                            <canvas id="bgp-messages-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Prometheus Metrics Export</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-secondary" id="prometheus-export-btn">Export Prometheus Format</button>
                        <button class="btn btn-secondary" id="prometheus-scrape-btn">View Scrape Endpoint</button>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Metric Name</th>
                            <th>Type</th>
                            <th>Value</th>
                            <th>Labels</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody id="prometheus-metrics-table">
                        <tr><td colspan="5" class="empty-state">Loading Prometheus metrics...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Grafana Content (Dashboard Visualization) -->
        <div class="protocol-content" id="grafana-content" style="height: 700px !important; max-height: 700px !important; overflow-y: auto !important; overflow-x: hidden !important;">
            <div class="metrics-row">
                <div class="metric-card grafana" style="border-left-color: #f97316;">
                    <div class="metric-label">Dashboards</div>
                    <div class="metric-value" id="grafana-dashboards">3</div>
                </div>
                <div class="metric-card grafana" style="border-left-color: #f97316;">
                    <div class="metric-label">Panels</div>
                    <div class="metric-value" id="grafana-panels">12</div>
                </div>
                <div class="metric-card grafana" style="border-left-color: #f97316;">
                    <div class="metric-label">Alerts Active</div>
                    <div class="metric-value" id="grafana-alerts">0</div>
                </div>
                <div class="metric-card grafana" style="border-left-color: #f97316;">
                    <div class="metric-label">Last Refresh</div>
                    <div class="metric-value" id="grafana-last-refresh">--</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3 style="color: #f97316;">Agent Dashboards</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <select id="grafana-dashboard-select" style="background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); padding: 6px 12px; border-radius: 4px;">
                            <option value="overview">Agent Overview</option>
                            <option value="protocols">Protocol Status</option>
                            <option value="traffic">Traffic Analysis</option>
                        </select>
                        <label style="display: flex; align-items: center; gap: 5px; font-size: 0.85rem;">
                            <input type="checkbox" id="grafana-auto-refresh" checked>
                            Auto-refresh
                        </label>
                        <button class="btn btn-secondary" id="grafana-refresh-btn">Refresh</button>
                        <button class="btn btn-secondary" id="grafana-fullscreen-btn">Fullscreen</button>
                    </div>
                </div>

                <!-- Dashboard Panels Grid -->
                <div id="grafana-panels-container" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">
                    <!-- Agent Overview Dashboard -->
                    <div class="grafana-panel" style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; border: 1px solid var(--border-color);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h4 style="margin: 0; color: #f97316;">Agent State</h4>
                            <span style="font-size: 0.75rem; color: var(--text-secondary);">Now</span>
                        </div>
                        <div id="grafana-agent-state" style="min-height: 120px;">
                            <canvas id="grafana-state-gauge" height="100"></canvas>
                        </div>
                    </div>

                    <div class="grafana-panel" style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; border: 1px solid var(--border-color);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h4 style="margin: 0; color: #f97316;">Neighbor Count</h4>
                            <span style="font-size: 0.75rem; color: var(--text-secondary);">Last 5m</span>
                        </div>
                        <div id="grafana-neighbor-panel" style="min-height: 120px;">
                            <canvas id="grafana-neighbor-sparkline" height="100"></canvas>
                        </div>
                    </div>

                    <div class="grafana-panel" style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; border: 1px solid var(--border-color);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h4 style="margin: 0; color: #f97316;">Routes in RIB</h4>
                            <span style="font-size: 0.75rem; color: var(--text-secondary);">Last 5m</span>
                        </div>
                        <div id="grafana-routes-panel" style="min-height: 120px;">
                            <canvas id="grafana-routes-sparkline" height="100"></canvas>
                        </div>
                    </div>

                    <div class="grafana-panel" style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; border: 1px solid var(--border-color);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h4 style="margin: 0; color: #f97316;">LSA Database</h4>
                            <span style="font-size: 0.75rem; color: var(--text-secondary);">Now</span>
                        </div>
                        <div id="grafana-lsa-panel" style="min-height: 120px;">
                            <canvas id="grafana-lsa-chart" height="100"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Traffic Dashboard</h3>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div class="grafana-panel" style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; border: 1px solid var(--border-color); height: 200px; max-height: 200px; overflow: hidden;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h4 style="margin: 0; color: #f97316;">Interface Utilization</h4>
                            <span style="font-size: 0.75rem; color: var(--text-secondary);">Last 5m</span>
                        </div>
                        <div style="height: 150px; max-height: 150px;">
                            <canvas id="grafana-interface-util"></canvas>
                        </div>
                    </div>
                    <div class="grafana-panel" style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; border: 1px solid var(--border-color); height: 200px; max-height: 200px; overflow: hidden;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h4 style="margin: 0; color: #f97316;">Packet Rate (pps)</h4>
                            <span style="font-size: 0.75rem; color: var(--text-secondary);">Last 5m</span>
                        </div>
                        <div style="height: 150px; max-height: 150px;">
                            <canvas id="grafana-packet-rate"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Alert Rules</h3>
                    <button class="btn btn-secondary" id="grafana-add-alert-btn">Add Alert Rule</button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Alert Name</th>
                            <th>Condition</th>
                            <th>Status</th>
                            <th>Last Triggered</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="grafana-alerts-table">
                        <tr>
                            <td>Neighbor Down</td>
                            <td>neighbor_count &lt; expected</td>
                            <td><span style="color: #4ade80;">OK</span></td>
                            <td>Never</td>
                            <td><button class="btn btn-secondary" style="padding: 2px 8px; font-size: 0.75rem;">Edit</button></td>
                        </tr>
                        <tr>
                            <td>High CPU</td>
                            <td>cpu_percent &gt; 80</td>
                            <td><span style="color: #4ade80;">OK</span></td>
                            <td>Never</td>
                            <td><button class="btn btn-secondary" style="padding: 2px 8px; font-size: 0.75rem;">Edit</button></td>
                        </tr>
                        <tr>
                            <td>Interface Flap</td>
                            <td>interface_flaps &gt; 3 in 5m</td>
                            <td><span style="color: #4ade80;">OK</span></td>
                            <td>Never</td>
                            <td><button class="btn btn-secondary" style="padding: 2px 8px; font-size: 0.75rem;">Edit</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- LLDP Content (Link Layer Discovery Protocol) -->
        <div class="protocol-content" id="lldp-content">
            <div class="metrics-row">
                <div class="metric-card lldp">
                    <div class="metric-label">Neighbors</div>
                    <div class="metric-value" id="lldp-neighbors">0</div>
                </div>
                <div class="metric-card lldp">
                    <div class="metric-label">Interfaces</div>
                    <div class="metric-value" id="lldp-interfaces">0</div>
                </div>
                <div class="metric-card lldp">
                    <div class="metric-label">Frames TX</div>
                    <div class="metric-value" id="lldp-frames-tx">0</div>
                </div>
                <div class="metric-card lldp">
                    <div class="metric-label">Frames RX</div>
                    <div class="metric-value" id="lldp-frames-rx">0</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>LLDP Neighbors</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-secondary" id="lldp-refresh-btn">Refresh</button>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Local Interface</th>
                            <th>Neighbor System</th>
                            <th>Neighbor Port</th>
                            <th>Management IP</th>
                            <th>Capabilities</th>
                            <th>Last Seen</th>
                        </tr>
                    </thead>
                    <tbody id="lldp-neighbors-table">
                        <tr><td colspan="6" class="empty-state">Loading LLDP neighbors...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>LLDP Statistics</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; padding: 15px;">
                    <div style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px;">
                        <div style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 5px;">Frames Sent</div>
                        <div style="font-size: 1.5rem; font-weight: bold;" id="lldp-stat-frames-sent">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px;">
                        <div style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 5px;">Frames Received</div>
                        <div style="font-size: 1.5rem; font-weight: bold;" id="lldp-stat-frames-received">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px;">
                        <div style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 5px;">Neighbors Added</div>
                        <div style="font-size: 1.5rem; font-weight: bold;" id="lldp-stat-neighbors-added">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px;">
                        <div style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 5px;">Neighbors Expired</div>
                        <div style="font-size: 1.5rem; font-weight: bold;" id="lldp-stat-neighbors-expired">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px;">
                        <div style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 5px;">TX Interval</div>
                        <div style="font-size: 1.5rem; font-weight: bold;" id="lldp-stat-tx-interval">30s</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px;">
                        <div style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 5px;">Status</div>
                        <div style="font-size: 1.5rem; font-weight: bold;" id="lldp-stat-status">--</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- LACP Content (Link Aggregation Control Protocol) -->
        <div class="protocol-content" id="lacp-content">
            <div class="metrics-row">
                <div class="metric-card lacp">
                    <div class="metric-label">LAGs</div>
                    <div class="metric-value" id="lacp-lag-count">0</div>
                </div>
                <div class="metric-card lacp">
                    <div class="metric-label">Active LAGs</div>
                    <div class="metric-value" id="lacp-active-lags">0</div>
                </div>
                <div class="metric-card lacp">
                    <div class="metric-label">Total Members</div>
                    <div class="metric-value" id="lacp-total-members">0</div>
                </div>
                <div class="metric-card lacp">
                    <div class="metric-label">Active Members</div>
                    <div class="metric-value" id="lacp-active-members">0</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Link Aggregation Groups</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-primary" id="lacp-create-lag-btn">Create LAG</button>
                        <button class="btn btn-secondary" id="lacp-refresh-btn">Refresh</button>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>LAG Name</th>
                            <th>Mode</th>
                            <th>Load Balance</th>
                            <th>Members</th>
                            <th>Active</th>
                            <th>State</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="lacp-lags-table">
                        <tr><td colspan="7" class="empty-state">No LAGs configured. Click "Create LAG" to add one.</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section" id="lacp-member-section" style="display: none;">
                <div class="section-header">
                    <h3>LAG Members: <span id="lacp-selected-lag">--</span></h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-primary" id="lacp-add-member-btn">Add Member</button>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Interface</th>
                            <th>Port ID</th>
                            <th>Priority</th>
                            <th>State</th>
                            <th>LACPDU Sent</th>
                            <th>LACPDU Recv</th>
                            <th>Partner</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="lacp-members-table">
                        <tr><td colspan="8" class="empty-state">Select a LAG to view members</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- Create LAG Modal -->
            <div id="lacp-create-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                <div style="background: var(--bg-secondary); border-radius: 12px; padding: 25px; max-width: 500px; width: 90%;">
                    <h3 style="margin-bottom: 20px;">Create Link Aggregation Group</h3>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">LAG Name</label>
                            <input type="text" id="lacp-new-lag-name" placeholder="e.g., bond0, port-channel1" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">LACP Mode</label>
                            <select id="lacp-new-lag-mode" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                                <option value="active">Active (recommended)</option>
                                <option value="passive">Passive</option>
                                <option value="on">Static (no LACP)</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Load Balancing</label>
                            <select id="lacp-new-lag-lb" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                                <option value="layer3+4">Layer 3+4 (IP + Port)</option>
                                <option value="layer3">Layer 3 (IP only)</option>
                                <option value="layer2">Layer 2 (MAC only)</option>
                                <option value="layer2+3">Layer 2+3 (MAC + IP)</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Minimum Links</label>
                            <input type="number" id="lacp-new-lag-min" value="1" min="1" max="8" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 20px; justify-content: flex-end;">
                        <button class="btn btn-secondary" id="lacp-cancel-create">Cancel</button>
                        <button class="btn btn-primary" id="lacp-confirm-create">Create</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Subinterface Content (VLANs / 802.1Q) -->
        <div class="protocol-content" id="subif-content">
            <div class="metrics-row">
                <div class="metric-card subif">
                    <div class="metric-label">Physical Interfaces</div>
                    <div class="metric-value" id="subif-physical-count">0</div>
                </div>
                <div class="metric-card subif">
                    <div class="metric-label">VLAN Subifs (802.1Q)</div>
                    <div class="metric-value" id="subif-vlan-count">0</div>
                </div>
                <div class="metric-card subif">
                    <div class="metric-label">L3 Routed Subifs</div>
                    <div class="metric-value" id="subif-l3-count">0</div>
                </div>
                <div class="metric-card subif">
                    <div class="metric-label">Active</div>
                    <div class="metric-value" id="subif-active-count">0</div>
                </div>
            </div>

            <!-- Interface Type Tabs -->
            <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                <button class="btn" id="subif-tab-vlan" style="background: #ec4899; border-color: #ec4899;" onclick="dashboard.showSubifTab('vlan')">
                    802.1Q VLAN
                </button>
                <button class="btn btn-secondary" id="subif-tab-l3" onclick="dashboard.showSubifTab('l3')">
                    L3 Routed
                </button>
            </div>

            <!-- 802.1Q VLAN Subinterfaces Section -->
            <div class="section" id="subif-vlan-section">
                <div class="section-header">
                    <h3>802.1Q VLAN Subinterfaces</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-primary" id="subif-create-btn" style="background: #ec4899; border-color: #ec4899;">Add VLAN Subinterface</button>
                        <button class="btn btn-secondary" id="subif-refresh-btn">Refresh</button>
                    </div>
                </div>
                <p style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 15px;">
                    Tagged subinterfaces for VLAN trunking (e.g., eth0.100, eth0.200)
                </p>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Interface</th>
                            <th>Parent</th>
                            <th>VLAN ID</th>
                            <th>IPv4 Addresses</th>
                            <th>IPv6 Addresses</th>
                            <th>MTU</th>
                            <th>State</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="subif-table">
                        <tr><td colspan="8" class="empty-state">No VLAN subinterfaces configured</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- L3 Routed Subinterfaces Section -->
            <div class="section" id="subif-l3-section" style="display: none;">
                <div class="section-header">
                    <h3>L3 Routed Subinterfaces</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-primary" id="subif-create-l3-btn" style="background: #ec4899; border-color: #ec4899;">Add L3 Subinterface</button>
                        <button class="btn btn-secondary" onclick="dashboard.fetchSubinterfaceData()">Refresh</button>
                    </div>
                </div>
                <p style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 15px;">
                    Untagged subinterfaces for multiple IPs on routed ports (e.g., eth0:0, eth0:1). Use for point-to-point links or secondary addresses.
                </p>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Interface</th>
                            <th>Parent</th>
                            <th>Index</th>
                            <th>IPv4 Address</th>
                            <th>IPv6 Address</th>
                            <th>Description</th>
                            <th>State</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="subif-l3-table">
                        <tr><td colspan="8" class="empty-state">No L3 routed subinterfaces configured</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section" id="subif-detail-section" style="display: none;">
                <div class="section-header">
                    <h3>Subinterface Details: <span id="subif-selected-name">--</span></h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-primary" id="subif-add-ip-btn">Add IP Address</button>
                    </div>
                </div>
                <div class="subif-detail-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div class="detail-card">
                        <h4>Configuration</h4>
                        <div id="subif-detail-config">--</div>
                    </div>
                    <div class="detail-card">
                        <h4>Statistics</h4>
                        <div id="subif-detail-stats">--</div>
                    </div>
                </div>
            </div>

            <!-- Create Subinterface Modal -->
            <div id="subif-create-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                <div style="background: var(--bg-secondary); border-radius: 12px; padding: 25px; max-width: 500px; width: 90%;">
                    <h3 style="margin-bottom: 20px;">Create 802.1Q Subinterface</h3>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Parent Interface</label>
                            <input type="text" id="subif-new-parent" placeholder="e.g., eth0, ens192" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">VLAN ID (1-4094)</label>
                            <input type="number" id="subif-new-vlan" placeholder="e.g., 10, 100, 1000" min="1" max="4094" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Description (optional)</label>
                            <input type="text" id="subif-new-desc" placeholder="e.g., Management VLAN" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">IPv4 Address (optional)</label>
                            <input type="text" id="subif-new-ipv4" placeholder="e.g., 192.168.10.1/24" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">IPv6 Address (optional)</label>
                            <input type="text" id="subif-new-ipv6" placeholder="e.g., fd00:10::1/64" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">MTU (optional, auto-calculated)</label>
                            <input type="number" id="subif-new-mtu" placeholder="Default: Parent MTU - 4" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 20px; justify-content: flex-end;">
                        <button class="btn btn-secondary" id="subif-cancel-create">Cancel</button>
                        <button class="btn btn-primary" id="subif-confirm-create">Create</button>
                    </div>
                </div>
            </div>

            <!-- Add IP Modal -->
            <div id="subif-ip-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                <div style="background: var(--bg-secondary); border-radius: 12px; padding: 25px; max-width: 400px; width: 90%;">
                    <h3 style="margin-bottom: 20px;">Add IP Address</h3>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">IP Address (with prefix)</label>
                            <input type="text" id="subif-add-ip-addr" placeholder="e.g., 192.168.20.1/24 or fd00:20::1/64" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Address Type</label>
                            <select id="subif-add-ip-type" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                                <option value="ipv4">IPv4</option>
                                <option value="ipv6">IPv6</option>
                            </select>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 20px; justify-content: flex-end;">
                        <button class="btn btn-secondary" id="subif-cancel-ip">Cancel</button>
                        <button class="btn btn-primary" id="subif-confirm-ip">Add</button>
                    </div>
                </div>
            </div>

            <!-- Create L3 Routed Subinterface Modal -->
            <div id="subif-create-l3-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                <div style="background: var(--bg-secondary); border-radius: 12px; padding: 25px; max-width: 500px; width: 90%;">
                    <h3 style="margin-bottom: 20px;">Create L3 Routed Subinterface</h3>
                    <p style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 15px;">
                        Creates an untagged subinterface for secondary IPs on a routed port (no switchport mode).
                        Format: parent:index (e.g., eth0:0, eth0:1)
                    </p>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Parent Interface (L3 Routed Port)</label>
                            <input type="text" id="subif-l3-parent" placeholder="e.g., eth0, ens192" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Subinterface Index</label>
                            <input type="number" id="subif-l3-index" placeholder="e.g., 0, 1, 2" min="0" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Description</label>
                            <input type="text" id="subif-l3-desc" placeholder="e.g., Point-to-point to Router-B" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">IPv4 Address *</label>
                            <input type="text" id="subif-l3-ipv4" placeholder="e.g., 10.0.0.1/30 (for P2P link)" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">IPv6 Address (optional)</label>
                            <input type="text" id="subif-l3-ipv6" placeholder="e.g., 2001:db8::1/127" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 20px; justify-content: flex-end;">
                        <button class="btn btn-secondary" onclick="dashboard.hideCreateL3SubifModal()">Cancel</button>
                        <button class="btn btn-primary" onclick="dashboard.createL3Subinterface()" style="background: #ec4899; border-color: #ec4899;">Create L3 Subif</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Email Content (SMTP Notifications) -->
        <div class="protocol-content" id="email-content">
            <div class="metrics-row">
                <div class="metric-card email">
                    <div class="metric-label">Emails Sent</div>
                    <div class="metric-value" id="email-sent-count">0</div>
                </div>
                <div class="metric-card email">
                    <div class="metric-label">Failed</div>
                    <div class="metric-value" id="email-failed-count">0</div>
                </div>
                <div class="metric-card email">
                    <div class="metric-label">Alert Rules</div>
                    <div class="metric-value" id="email-rule-count">0</div>
                </div>
                <div class="metric-card email">
                    <div class="metric-label">Success Rate</div>
                    <div class="metric-value" id="email-success-rate">100<span class="metric-unit">%</span></div>
                </div>
            </div>

            <div class="two-column">
                <div class="section">
                    <div class="section-header">
                        <h3>SMTP Configuration</h3>
                        <button class="btn btn-primary" id="email-save-config-btn">Save Config</button>
                    </div>
                    <div style="display: grid; gap: 15px; padding: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">SMTP Server</label>
                            <input type="text" id="smtp-server" placeholder="smtp.example.com" value="localhost" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Port</label>
                                <input type="number" id="smtp-port" value="587" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Security</label>
                                <select id="smtp-security" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                                    <option value="tls">STARTTLS</option>
                                    <option value="ssl">SSL/TLS</option>
                                    <option value="none">None</option>
                                </select>
                            </div>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Username</label>
                                <input type="text" id="smtp-username" placeholder="Optional" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Password</label>
                                <input type="password" id="smtp-password" placeholder="Optional" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                            </div>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">From Address</label>
                            <input type="email" id="smtp-from" value="agent@network.local" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-secondary" id="email-test-btn">Send Test Email</button>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-header">
                        <h3>Alert Rules</h3>
                        <button class="btn btn-primary" id="email-add-rule-btn">Add Rule</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Type</th>
                                <th>Recipients</th>
                                <th>Priority</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="email-rules-table">
                            <tr><td colspan="5" class="empty-state">No alert rules configured</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Email History</h3>
                    <button class="btn btn-secondary" id="email-refresh-btn">Refresh</button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>To</th>
                            <th>Subject</th>
                            <th>Status</th>
                            <th>Priority</th>
                        </tr>
                    </thead>
                    <tbody id="email-history-table">
                        <tr><td colspan="5" class="empty-state">No emails sent yet</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- Test Email Modal -->
            <div id="email-test-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                <div style="background: var(--bg-secondary); border-radius: 12px; padding: 25px; max-width: 400px; width: 90%;">
                    <h3 style="margin-bottom: 20px;">Send Test Email</h3>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Recipient Email</label>
                            <input type="email" id="email-test-recipient" placeholder="your@email.com" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 20px; justify-content: flex-end;">
                        <button class="btn btn-secondary" id="email-test-cancel">Cancel</button>
                        <button class="btn btn-primary" id="email-test-send">Send Test</button>
                    </div>
                </div>
            </div>

            <!-- Add Rule Modal -->
            <div id="email-rule-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                <div style="background: var(--bg-secondary); border-radius: 12px; padding: 25px; max-width: 500px; width: 90%;">
                    <h3 style="margin-bottom: 20px;">Add Alert Rule</h3>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Rule Name</label>
                            <input type="text" id="email-rule-name" placeholder="e.g., OSPF Neighbor Alert" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Alert Type</label>
                            <select id="email-rule-type" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                                <option value="test_failure">Test Failure</option>
                                <option value="neighbor_down">Neighbor Down</option>
                                <option value="neighbor_up">Neighbor Up</option>
                                <option value="route_change">Route Change</option>
                                <option value="interface_down">Interface Down</option>
                                <option value="high_cpu">High CPU</option>
                                <option value="high_memory">High Memory</option>
                                <option value="custom">Custom</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Recipients (comma-separated)</label>
                            <input type="text" id="email-rule-recipients" placeholder="admin@example.com, noc@example.com" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Priority</label>
                                <select id="email-rule-priority" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                                    <option value="low">Low</option>
                                    <option value="normal" selected>Normal</option>
                                    <option value="high">High</option>
                                    <option value="urgent">Urgent</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Cooldown (seconds)</label>
                                <input type="number" id="email-rule-cooldown" value="300" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                            </div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 20px; justify-content: flex-end;">
                        <button class="btn btn-secondary" id="email-rule-cancel">Cancel</button>
                        <button class="btn btn-primary" id="email-rule-save">Add Rule</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Firewall Content (ACLs) -->
        <div class="protocol-content" id="firewall-content">
            <div class="metrics-row">
                <div class="metric-card firewall">
                    <div class="metric-label">ACLs</div>
                    <div class="metric-value" id="fw-acl-count">0</div>
                </div>
                <div class="metric-card firewall">
                    <div class="metric-label">Total Rules</div>
                    <div class="metric-value" id="fw-rule-count">0</div>
                </div>
                <div class="metric-card firewall">
                    <div class="metric-label">Blocked</div>
                    <div class="metric-value" id="fw-blocked-count">0</div>
                </div>
                <div class="metric-card firewall">
                    <div class="metric-label">Total Hits</div>
                    <div class="metric-value" id="fw-hits-count">0</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Access Control Lists</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-primary" id="fw-create-acl-btn">Create ACL</button>
                        <button class="btn btn-secondary" id="fw-refresh-btn">Refresh</button>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Rules</th>
                            <th>Interfaces</th>
                            <th>Hits</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="fw-acls-table">
                        <tr><td colspan="7" class="empty-state">No ACLs configured. Click "Create ACL" to add one.</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section" id="fw-rules-section" style="display: none; margin-top: 20px;">
                <div class="section-header">
                    <h3>ACL Rules: <span id="fw-selected-acl">--</span></h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-primary" id="fw-add-rule-btn">Add Rule</button>
                        <button class="btn btn-secondary" id="fw-apply-acl-btn">Apply to Interface</button>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Seq</th>
                            <th>Action</th>
                            <th>Protocol</th>
                            <th>Source</th>
                            <th>Destination</th>
                            <th>Hits</th>
                            <th>Enabled</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="fw-rules-table">
                        <tr><td colspan="8" class="empty-state">Select an ACL to view rules</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Blocked Traffic Log</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>Interface</th>
                            <th>Source</th>
                            <th>Destination</th>
                            <th>Protocol</th>
                            <th>ACL</th>
                            <th>Rule</th>
                        </tr>
                    </thead>
                    <tbody id="fw-blocked-table">
                        <tr><td colspan="7" class="empty-state">No blocked traffic</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- Create ACL Modal -->
            <div id="fw-acl-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                <div style="background: var(--bg-secondary); border-radius: 12px; padding: 25px; max-width: 400px; width: 90%;">
                    <h3 style="margin-bottom: 20px;">Create Access Control List</h3>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">ACL Name</label>
                            <input type="text" id="fw-new-acl-name" placeholder="e.g., DENY_TELNET, ALLOW_HTTP" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Description</label>
                            <input type="text" id="fw-new-acl-desc" placeholder="e.g., Block telnet access" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">ACL Type</label>
                            <select id="fw-new-acl-type" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                                <option value="extended">Extended (source + dest)</option>
                                <option value="standard">Standard (source only)</option>
                            </select>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 20px; justify-content: flex-end;">
                        <button class="btn btn-secondary" id="fw-acl-cancel">Cancel</button>
                        <button class="btn btn-primary" id="fw-acl-create">Create</button>
                    </div>
                </div>
            </div>

            <!-- Add Rule Modal -->
            <div id="fw-rule-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                <div style="background: var(--bg-secondary); border-radius: 12px; padding: 25px; max-width: 600px; width: 90%;">
                    <h3 style="margin-bottom: 20px;">Add Firewall Rule</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Sequence Number</label>
                            <input type="number" id="fw-rule-seq" value="10" min="1" max="65535" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Action</label>
                            <select id="fw-rule-action" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                                <option value="permit">Permit</option>
                                <option value="deny">Deny</option>
                                <option value="drop">Drop (silent)</option>
                                <option value="reject">Reject (ICMP)</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Protocol</label>
                            <select id="fw-rule-proto" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                                <option value="any">Any</option>
                                <option value="tcp">TCP</option>
                                <option value="udp">UDP</option>
                                <option value="icmp">ICMP</option>
                                <option value="ospf">OSPF</option>
                                <option value="gre">GRE</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Description</label>
                            <input type="text" id="fw-rule-desc" placeholder="Optional description" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Source IP/Network</label>
                            <input type="text" id="fw-rule-src-ip" value="any" placeholder="e.g., 192.168.1.0/24 or any" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Source Port</label>
                            <input type="text" id="fw-rule-src-port" placeholder="e.g., 1024-65535 (optional)" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Destination IP/Network</label>
                            <input type="text" id="fw-rule-dst-ip" value="any" placeholder="e.g., 10.0.0.0/8 or any" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Destination Port</label>
                            <input type="text" id="fw-rule-dst-port" placeholder="e.g., 80, 443 (optional)" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                    </div>
                    <div style="display: flex; gap: 15px; margin-top: 15px;">
                        <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                            <input type="checkbox" id="fw-rule-log"> Log matches
                        </label>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 20px; justify-content: flex-end;">
                        <button class="btn btn-secondary" id="fw-rule-cancel">Cancel</button>
                        <button class="btn btn-primary" id="fw-rule-save">Add Rule</button>
                    </div>
                </div>
            </div>

            <!-- Apply ACL Modal -->
            <div id="fw-apply-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                <div style="background: var(--bg-secondary); border-radius: 12px; padding: 25px; max-width: 400px; width: 90%;">
                    <h3 style="margin-bottom: 20px;">Apply ACL to Interface</h3>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Interface</label>
                            <input type="text" id="fw-apply-interface" placeholder="e.g., eth0, ens192" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Direction</label>
                            <select id="fw-apply-direction" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                                <option value="in">Inbound</option>
                                <option value="out">Outbound</option>
                                <option value="both">Both</option>
                            </select>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 20px; justify-content: flex-end;">
                        <button class="btn btn-secondary" id="fw-apply-cancel">Cancel</button>
                        <button class="btn btn-primary" id="fw-apply-save">Apply</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- SSH Content (SSH Server Access) -->
        <div class="protocol-content" id="ssh-content">
            <div class="metrics-row">
                <div class="metric-card ssh">
                    <div class="metric-label">SSH Servers</div>
                    <div class="metric-value" id="ssh-server-count">0</div>
                </div>
                <div class="metric-card ssh">
                    <div class="metric-label">Active Sessions</div>
                    <div class="metric-value" id="ssh-session-count">0</div>
                </div>
                <div class="metric-card ssh">
                    <div class="metric-label">Total Connections</div>
                    <div class="metric-value" id="ssh-total-connections">0</div>
                </div>
                <div class="metric-card ssh">
                    <div class="metric-label">Commands Executed</div>
                    <div class="metric-value" id="ssh-total-commands">0</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>SSH Servers</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-primary" id="ssh-start-btn">Start SSH Server</button>
                        <button class="btn btn-secondary" id="ssh-refresh-btn">Refresh</button>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Agent</th>
                            <th>Status</th>
                            <th>Port</th>
                            <th>Sessions</th>
                            <th>Connections</th>
                            <th>Commands</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="ssh-servers-tbody">
                        <tr><td colspan="7" class="empty-state">No SSH servers running. Click "Start SSH Server" to enable SSH access.</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Active Sessions</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Session ID</th>
                            <th>Agent</th>
                            <th>User</th>
                            <th>Remote Address</th>
                            <th>Duration</th>
                            <th>Commands</th>
                            <th>State</th>
                        </tr>
                    </thead>
                    <tbody id="ssh-sessions-tbody">
                        <tr><td colspan="7" class="empty-state">No active SSH sessions</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>SSH Connection Info</h3>
                </div>
                <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 20px; font-family: monospace;">
                    <p style="margin-bottom: 15px; color: var(--text-secondary);">To connect to an agent via SSH:</p>
                    <pre style="background: var(--bg-primary); padding: 15px; border-radius: 6px; overflow-x: auto;">
# Connect to agent SSH server
ssh admin@localhost -p 2200

# Once connected, you can:
# - Run CLI commands (show ip route, ping, traceroute)
# - Ask natural language questions
# - Interact with the agent directly

# Example session:
$ ssh admin@localhost -p 2200
admin@localhost's password: admin

agent-router-1> show ip route
[displays routing table]

agent-router-1> why can't I reach 10.0.0.1?
[AI analyzes and explains]

agent-router-1> exit
                    </pre>
                </div>
            </div>

            <!-- Start SSH Server Modal -->
            <div id="start-ssh-modal" class="modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                <div class="modal-content" style="background: var(--bg-secondary); border-radius: 12px; padding: 25px; max-width: 500px; width: 90%;">
                    <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0;">Start SSH Server</h3>
                        <button class="modal-close" style="background: none; border: none; color: var(--text-secondary); font-size: 24px; cursor: pointer;">&times;</button>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div style="grid-column: span 2;">
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Agent Name</label>
                            <input type="text" id="ssh-agent-name" placeholder="e.g., router-1" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">SSH Port</label>
                            <input type="number" id="ssh-port" value="2200" min="1024" max="65535" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Max Sessions</label>
                            <input type="number" id="ssh-max-sessions" value="10" min="1" max="100" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Username</label>
                            <input type="text" id="ssh-username" value="admin" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Password</label>
                            <input type="password" id="ssh-password" value="admin" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div style="grid-column: span 2;">
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Idle Timeout (seconds)</label>
                            <input type="number" id="ssh-idle-timeout" value="300" min="60" max="3600" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 20px; justify-content: flex-end;">
                        <button class="btn btn-secondary btn-cancel">Cancel</button>
                        <button class="btn btn-primary btn-save">Start Server</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- NETCONF Content -->
        <div class="protocol-content" id="netconf-content">
            <div class="metrics-row">
                <div class="metric-card netconf">
                    <div class="metric-label">NETCONF Servers</div>
                    <div class="metric-value" id="netconf-server-count">0</div>
                </div>
                <div class="metric-card netconf">
                    <div class="metric-label">RESTCONF Servers</div>
                    <div class="metric-value" id="restconf-server-count">0</div>
                </div>
                <div class="metric-card netconf">
                    <div class="metric-label">Active Sessions</div>
                    <div class="metric-value" id="netconf-session-count">0</div>
                </div>
                <div class="metric-card netconf">
                    <div class="metric-label">Total Operations</div>
                    <div class="metric-value" id="netconf-total-ops">0</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>NETCONF Servers (RFC 6241)</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-primary" id="netconf-start-btn">Start NETCONF</button>
                        <button class="btn btn-secondary" id="netconf-refresh-btn">Refresh</button>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Agent</th>
                            <th>Status</th>
                            <th>Port</th>
                            <th>Sessions</th>
                            <th>Operations</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="netconf-servers-tbody">
                        <tr><td colspan="6" class="empty-state">No NETCONF servers running</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>RESTCONF Servers (RFC 8040)</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-primary" id="restconf-start-btn">Start RESTCONF</button>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Agent</th>
                            <th>Status</th>
                            <th>Port</th>
                            <th>Requests</th>
                            <th>Failed</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="restconf-servers-tbody">
                        <tr><td colspan="6" class="empty-state">No RESTCONF servers running</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Active NETCONF Sessions</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Session ID</th>
                            <th>Agent</th>
                            <th>User</th>
                            <th>Remote</th>
                            <th>Duration</th>
                            <th>Operations</th>
                        </tr>
                    </thead>
                    <tbody id="netconf-sessions-tbody">
                        <tr><td colspan="6" class="empty-state">No active sessions</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Protocol Info</h3>
                </div>
                <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 20px; font-family: monospace;">
                    <h4 style="margin-top: 0; color: var(--accent-cyan);">NETCONF (RFC 6241)</h4>
                    <p style="color: var(--text-secondary);">Network Configuration Protocol over SSH (port 830)</p>
                    <ul style="color: var(--text-primary);">
                        <li>Candidate/Running/Startup datastores</li>
                        <li>Lock/Unlock operations</li>
                        <li>Commit/Discard changes</li>
                        <li>Get/Edit configuration</li>
                    </ul>

                    <h4 style="margin-top: 20px; color: var(--accent-cyan);">RESTCONF (RFC 8040)</h4>
                    <p style="color: var(--text-secondary);">RESTful HTTP-based configuration (port 8443)</p>
                    <ul style="color: var(--text-primary);">
                        <li>GET/POST/PUT/PATCH/DELETE operations</li>
                        <li>YANG-based data models</li>
                        <li>JSON/XML media types</li>
                        <li>API root: /restconf/data/</li>
                    </ul>
                </div>
            </div>

            <!-- Start NETCONF Modal -->
            <div id="start-netconf-modal" class="modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                <div class="modal-content" style="background: var(--bg-secondary); border-radius: 12px; padding: 25px; max-width: 450px; width: 90%;">
                    <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0;">Start NETCONF Server</h3>
                        <button class="modal-close" style="background: none; border: none; color: var(--text-secondary); font-size: 24px; cursor: pointer;">&times;</button>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Agent Name</label>
                            <input type="text" id="netconf-agent-name" placeholder="e.g., router-1" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Port</label>
                            <input type="number" id="netconf-port" value="830" min="1" max="65535" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div style="display: flex; gap: 20px;">
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="checkbox" id="netconf-candidate" checked> Candidate Datastore
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="checkbox" id="netconf-startup" checked> Startup Datastore
                            </label>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 20px; justify-content: flex-end;">
                        <button class="btn btn-secondary btn-cancel">Cancel</button>
                        <button class="btn btn-primary btn-save">Start Server</button>
                    </div>
                </div>
            </div>

            <!-- Start RESTCONF Modal -->
            <div id="start-restconf-modal" class="modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                <div class="modal-content" style="background: var(--bg-secondary); border-radius: 12px; padding: 25px; max-width: 450px; width: 90%;">
                    <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0;">Start RESTCONF Server</h3>
                        <button class="modal-close" style="background: none; border: none; color: var(--text-secondary); font-size: 24px; cursor: pointer;">&times;</button>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Agent Name</label>
                            <input type="text" id="restconf-agent-name" placeholder="e.g., router-1" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Port</label>
                            <input type="number" id="restconf-port" value="8443" min="1" max="65535" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="checkbox" id="restconf-https" checked> Use HTTPS
                            </label>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 20px; justify-content: flex-end;">
                        <button class="btn btn-secondary btn-cancel">Cancel</button>
                        <button class="btn btn-primary btn-save">Start Server</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- MCP External Content -->
        <div class="protocol-content" id="mcpext-content">
            <div class="metrics-row">
                <div class="metric-card mcpext">
                    <div class="metric-label">MCP Servers</div>
                    <div class="metric-value" id="mcp-server-count">0</div>
                </div>
                <div class="metric-card mcpext">
                    <div class="metric-label">Connections</div>
                    <div class="metric-value" id="mcp-connection-count">0</div>
                </div>
                <div class="metric-card mcpext">
                    <div class="metric-label">Tools Available</div>
                    <div class="metric-value" id="mcp-tool-count">0</div>
                </div>
                <div class="metric-card mcpext">
                    <div class="metric-label">Total Requests</div>
                    <div class="metric-value" id="mcp-request-count">0</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>MCP External Servers</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-primary" id="mcp-start-btn">Start MCP Server</button>
                        <button class="btn btn-secondary" id="mcp-refresh-btn">Refresh</button>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Server ID</th>
                            <th>Type</th>
                            <th>Agent</th>
                            <th>Port</th>
                            <th>Connections</th>
                            <th>Requests</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="mcp-servers-tbody">
                        <tr><td colspan="7" class="empty-state">No MCP servers running</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Active Connections</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Connection ID</th>
                            <th>Client</th>
                            <th>Remote</th>
                            <th>Duration</th>
                            <th>Requests</th>
                            <th>State</th>
                        </tr>
                    </thead>
                    <tbody id="mcp-connections-tbody">
                        <tr><td colspan="6" class="empty-state">No active connections</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Available Tools</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Tool Name</th>
                            <th>Description</th>
                            <th>Parameters</th>
                            <th>Server</th>
                        </tr>
                    </thead>
                    <tbody id="mcp-tools-tbody">
                        <tr><td colspan="4" class="empty-state">No tools available</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>External Tool Integration</h3>
                </div>
                <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 20px; font-family: monospace;">
                    <h4 style="margin-top: 0; color: var(--accent-cyan);">Claude Desktop Integration</h4>
                    <p style="color: var(--text-secondary);">Add to your claude_desktop_config.json:</p>
                    <pre style="background: var(--bg-primary); padding: 15px; border-radius: 6px; overflow-x: auto; font-size: 12px;">
{
  "mcpServers": {
    "asi-network": {
      "command": "npx",
      "args": ["-y", "@anthropic/mcp-server-fetch"],
      "env": {
        "ASI_MCP_URL": "http://localhost:3000",
        "ASI_API_KEY": "your-api-key"
      }
    }
  }
}
                    </pre>

                    <h4 style="margin-top: 20px; color: var(--accent-cyan);">Available Capabilities</h4>
                    <ul style="color: var(--text-primary);">
                        <li><strong>Network Tools:</strong> Topology, agents, routes, neighbors</li>
                        <li><strong>Operations:</strong> Ping, traceroute, test execution</li>
                        <li><strong>Natural Language:</strong> Ask questions about the network</li>
                        <li><strong>Resources:</strong> Access topology, agent state, routes</li>
                        <li><strong>Prompts:</strong> Troubleshoot, analyze, health check</li>
                    </ul>
                </div>
            </div>

            <!-- Start MCP Server Modal -->
            <div id="start-mcp-modal" class="modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                <div class="modal-content" style="background: var(--bg-secondary); border-radius: 12px; padding: 25px; max-width: 500px; width: 90%;">
                    <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0;">Start MCP External Server</h3>
                        <button class="modal-close" style="background: none; border: none; color: var(--text-secondary); font-size: 24px; cursor: pointer;">&times;</button>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Server Type</label>
                            <select id="mcp-server-type" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                                <option value="network">Network (global operations)</option>
                                <option value="agent">Agent (per-agent operations)</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Agent Name (for agent type)</label>
                            <input type="text" id="mcp-agent-name" placeholder="e.g., router-1 (optional for network type)" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Port</label>
                            <input type="number" id="mcp-port" value="3000" min="1024" max="65535" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">API Key (optional)</label>
                            <input type="password" id="mcp-api-key" placeholder="Leave empty for no authentication" style="width: 100%; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="checkbox" id="mcp-require-auth" checked> Require Authentication
                            </label>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 20px; justify-content: flex-end;">
                        <button class="btn btn-secondary btn-cancel">Cancel</button>
                        <button class="btn btn-primary btn-save">Start Server</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Health Content (Network Health Score) -->
        <div class="protocol-content" id="health-content">
            <div class="metrics-row">
                <div class="metric-card health">
                    <div class="metric-label">Network Score</div>
                    <div class="metric-value" id="health-network-score">--</div>
                </div>
                <div class="metric-card health">
                    <div class="metric-label">Healthy Agents</div>
                    <div class="metric-value" id="health-healthy-agents">0</div>
                </div>
                <div class="metric-card health">
                    <div class="metric-label">Degraded Agents</div>
                    <div class="metric-value" id="health-degraded-agents">0</div>
                </div>
                <div class="metric-card health">
                    <div class="metric-label">Critical Agents</div>
                    <div class="metric-value" id="health-critical-agents">0</div>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px;">
                <!-- Health Gauge -->
                <div class="section">
                    <div class="section-header">
                        <h3>Network Health Score</h3>
                    </div>
                    <div class="health-gauge">
                        <svg viewBox="0 0 200 200">
                            <circle class="health-gauge-circle health-gauge-bg" cx="100" cy="100" r="85"/>
                            <circle class="health-gauge-circle health-gauge-value" id="health-gauge-circle"
                                    cx="100" cy="100" r="85"
                                    stroke-dasharray="534" stroke-dashoffset="534"
                                    transform="rotate(-90 100 100)"/>
                        </svg>
                        <div class="health-score-text">
                            <div class="health-score-number" id="health-gauge-score">--</div>
                            <div class="health-score-label" id="health-gauge-label">Loading</div>
                        </div>
                    </div>
                    <div class="health-trend" id="health-trend">
                        <span id="health-trend-icon"></span>
                        <span id="health-trend-label">Stable</span>
                    </div>
                </div>

                <!-- Health Components -->
                <div class="section">
                    <div class="section-header">
                        <h3>Health Components</h3>
                    </div>
                    <div id="health-components">
                        <div class="health-component">
                            <span class="health-component-name">Protocol Health</span>
                            <div class="health-component-bar">
                                <div class="health-component-fill" id="health-protocol-bar" style="width: 0%; background: #10b981;"></div>
                            </div>
                            <span class="health-component-score" id="health-protocol-score">--</span>
                        </div>
                        <div class="health-component">
                            <span class="health-component-name">Test Health</span>
                            <div class="health-component-bar">
                                <div class="health-component-fill" id="health-test-bar" style="width: 0%; background: #10b981;"></div>
                            </div>
                            <span class="health-component-score" id="health-test-score">--</span>
                        </div>
                        <div class="health-component">
                            <span class="health-component-name">Resource Health</span>
                            <div class="health-component-bar">
                                <div class="health-component-fill" id="health-resource-bar" style="width: 0%; background: #10b981;"></div>
                            </div>
                            <span class="health-component-score" id="health-resource-score">--</span>
                        </div>
                        <div class="health-component">
                            <span class="health-component-name">Configuration Health</span>
                            <div class="health-component-bar">
                                <div class="health-component-fill" id="health-config-bar" style="width: 0%; background: #10b981;"></div>
                            </div>
                            <span class="health-component-score" id="health-config-score">--</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Issues and Recommendations -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                <div class="section">
                    <div class="section-header">
                        <h3>Active Issues</h3>
                    </div>
                    <div id="health-issues-list" class="table-container" style="max-height: 250px; overflow-y: auto;">
                        <p style="color: var(--text-secondary); padding: 15px;">No issues detected</p>
                    </div>
                </div>

                <div class="section">
                    <div class="section-header">
                        <h3>Recommendations</h3>
                    </div>
                    <div id="health-recommendations-list" class="table-container" style="max-height: 250px; overflow-y: auto;">
                        <p style="color: var(--text-secondary); padding: 15px;">No recommendations</p>
                    </div>
                </div>
            </div>

            <!-- Agent Health Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Agent Health Breakdown</h3>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Agent</th>
                                <th>Score</th>
                                <th>Status</th>
                                <th>Trend</th>
                                <th>Protocol</th>
                                <th>Tests</th>
                                <th>Resources</th>
                                <th>Config</th>
                            </tr>
                        </thead>
                        <tbody id="health-agents-table">
                            <tr>
                                <td colspan="8" style="text-align: center; color: var(--text-secondary);">Loading...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Traffic Simulation Content -->
        <div class="protocol-content" id="simulation-content">
            <div class="metrics-row">
                <div class="metric-card simulation">
                    <div class="metric-label">Active Flows</div>
                    <div class="metric-value" id="sim-active-flows">0</div>
                </div>
                <div class="metric-card simulation">
                    <div class="metric-label">Total Throughput</div>
                    <div class="metric-value" id="sim-total-throughput">0 bps</div>
                </div>
                <div class="metric-card simulation">
                    <div class="metric-label">Congested Links</div>
                    <div class="metric-value" id="sim-congested-links">0</div>
                </div>
                <div class="metric-card simulation">
                    <div class="metric-label">Simulation Status</div>
                    <div class="metric-value" id="sim-status">Stopped</div>
                </div>
            </div>

            <!-- Simulation Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Simulation Controls</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-small btn-primary" onclick="dashboard.startSimulation()">Start</button>
                        <button class="btn btn-small btn-secondary" onclick="dashboard.stopSimulation()">Stop</button>
                        <select id="sim-scenario-select" style="padding: 5px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);">
                            <option value="">-- Select Scenario --</option>
                            <option value="mesh">Mesh Traffic</option>
                            <option value="hub_spoke">Hub & Spoke</option>
                            <option value="backbone">Backbone</option>
                            <option value="ddos">DDoS Simulation</option>
                        </select>
                        <button class="btn btn-small btn-secondary" onclick="dashboard.createScenario()">Create Scenario</button>
                    </div>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <!-- Traffic Heatmap -->
                <div class="section">
                    <div class="section-header">
                        <h3>Link Heatmap</h3>
                    </div>
                    <div id="sim-heatmap" class="table-container" style="max-height: 350px; overflow-y: auto;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Link</th>
                                    <th>Utilization</th>
                                    <th>Rate</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="sim-heatmap-table">
                                <tr>
                                    <td colspan="4" style="text-align: center; color: var(--text-secondary);">No traffic data</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Congestion Report -->
                <div class="section">
                    <div class="section-header">
                        <h3>Congestion Report</h3>
                    </div>
                    <div id="sim-congestion" class="table-container" style="max-height: 350px; overflow-y: auto;">
                        <p style="color: var(--text-secondary); padding: 15px;">No congestion detected</p>
                    </div>
                </div>
            </div>

            <!-- Traffic Flows Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Traffic Flows</h3>
                    <button class="btn btn-small btn-primary" onclick="dashboard.showCreateFlowModal()">Create Flow</button>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Flow ID</th>
                                <th>Source</th>
                                <th>Destination</th>
                                <th>Protocol</th>
                                <th>Rate</th>
                                <th>Pattern</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="sim-flows-table">
                            <tr>
                                <td colspan="8" style="text-align: center; color: var(--text-secondary);">No flows configured</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Time-Travel Replay Content -->
        <div class="protocol-content" id="replay-content">
            <div class="metrics-row">
                <div class="metric-card replay">
                    <div class="metric-label">Recording Sessions</div>
                    <div class="metric-value" id="replay-sessions-count">0</div>
                </div>
                <div class="metric-card replay">
                    <div class="metric-label">Total Snapshots</div>
                    <div class="metric-value" id="replay-snapshots-count">0</div>
                </div>
                <div class="metric-card replay">
                    <div class="metric-label">Total Events</div>
                    <div class="metric-value" id="replay-events-count">0</div>
                </div>
                <div class="metric-card replay">
                    <div class="metric-label">Status</div>
                    <div class="metric-value" id="replay-status">Idle</div>
                </div>
            </div>

            <!-- Recording Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Recording Controls</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-small btn-primary" onclick="dashboard.startRecording()">Start Recording</button>
                        <button class="btn btn-small btn-secondary" onclick="dashboard.stopRecording()">Stop Recording</button>
                        <button class="btn btn-small btn-secondary" onclick="dashboard.takeSnapshot()">Take Snapshot</button>
                    </div>
                </div>
                <div id="replay-current-session" style="margin-top: 15px;">
                    <p style="color: var(--text-secondary);">No active recording session</p>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <!-- Timeline -->
                <div class="section">
                    <div class="section-header">
                        <h3>Timeline</h3>
                        <select id="replay-session-select" style="padding: 5px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);" onchange="dashboard.loadTimeline()">
                            <option value="">-- Select Session --</option>
                        </select>
                    </div>
                    <div id="replay-timeline" class="table-container" style="max-height: 400px; overflow-y: auto;">
                        <p style="color: var(--text-secondary); padding: 15px;">Select a session to view timeline</p>
                    </div>
                </div>

                <!-- Replay State -->
                <div class="section">
                    <div class="section-header">
                        <h3>Replay Controls</h3>
                        <div style="display: flex; gap: 10px;">
                            <input type="datetime-local" id="replay-time-input" style="padding: 5px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);">
                            <button class="btn btn-small btn-primary" onclick="dashboard.replayToTime()">Go</button>
                            <button class="btn btn-small btn-secondary" onclick="dashboard.clearReplay()">Live Mode</button>
                        </div>
                    </div>
                    <div id="replay-state" style="margin-top: 15px;">
                        <p style="color: var(--text-secondary);">Currently in live mode</p>
                    </div>
                </div>
            </div>

            <!-- Events -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Protocol Events</h3>
                    <select id="replay-event-filter" style="padding: 5px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);">
                        <option value="">All Events</option>
                        <option value="ospf">OSPF</option>
                        <option value="bgp">BGP</option>
                        <option value="isis">ISIS</option>
                        <option value="lldp">LLDP</option>
                    </select>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Event</th>
                                <th>Agent</th>
                                <th>Protocol</th>
                                <th>Description</th>
                                <th>Severity</th>
                            </tr>
                        </thead>
                        <tbody id="replay-events-table">
                            <tr>
                                <td colspan="6" style="text-align: center; color: var(--text-secondary);">No events recorded</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Network Diff Content -->
        <div class="protocol-content" id="diff-content">
            <div class="metrics-row">
                <div class="metric-card diff">
                    <div class="metric-label">Total Diffs</div>
                    <div class="metric-value" id="diff-total-count">0</div>
                </div>
                <div class="metric-card diff">
                    <div class="metric-label">Total Changes</div>
                    <div class="metric-value" id="diff-changes-count">0</div>
                </div>
                <div class="metric-card diff">
                    <div class="metric-label">Added</div>
                    <div class="metric-value" id="diff-added-count" style="color: #4ade80;">0</div>
                </div>
                <div class="metric-card diff">
                    <div class="metric-label">Removed</div>
                    <div class="metric-value" id="diff-removed-count" style="color: #ef4444;">0</div>
                </div>
            </div>

            <!-- Snapshot Selection -->
            <div class="section">
                <div class="section-header">
                    <h3>Compare Snapshots</h3>
                </div>
                <div style="display: grid; grid-template-columns: 1fr auto 1fr auto; gap: 15px; align-items: end;">
                    <div class="form-group" style="margin: 0;">
                        <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Before (Older)</label>
                        <select id="diff-before-select" style="width: 100%; padding: 8px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);">
                            <option value="">-- Select Snapshot --</option>
                        </select>
                    </div>
                    <div style="padding-bottom: 5px; color: var(--text-secondary);"></div>
                    <div class="form-group" style="margin: 0;">
                        <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">After (Newer)</label>
                        <select id="diff-after-select" style="width: 100%; padding: 8px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);">
                            <option value="">-- Select Snapshot --</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="dashboard.compareSnapshots()">Compare</button>
                </div>
            </div>

            <!-- Diff Results -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Diff Results</h3>
                    <div style="display: flex; gap: 10px;">
                        <select id="diff-category-filter" style="padding: 5px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);" onchange="dashboard.filterDiffResults()">
                            <option value="">All Categories</option>
                            <option value="route">Routes</option>
                            <option value="neighbor">Neighbors</option>
                            <option value="topology">Topology</option>
                            <option value="protocol">Protocols</option>
                            <option value="agent">Agents</option>
                        </select>
                        <select id="diff-type-filter" style="padding: 5px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);" onchange="dashboard.filterDiffResults()">
                            <option value="">All Types</option>
                            <option value="added">Added</option>
                            <option value="removed">Removed</option>
                            <option value="modified">Modified</option>
                        </select>
                    </div>
                </div>
                <div id="diff-results" class="table-container" style="max-height: 500px; overflow-y: auto;">
                    <p style="color: var(--text-secondary); padding: 15px;">Select two snapshots and click Compare to see differences</p>
                </div>
            </div>

            <!-- Diff Summary -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                <div class="section">
                    <div class="section-header">
                        <h3>Changes by Category</h3>
                    </div>
                    <div id="diff-category-summary">
                        <p style="color: var(--text-secondary); padding: 15px;">No diff generated</p>
                    </div>
                </div>
                <div class="section">
                    <div class="section-header">
                        <h3>Changes by Impact</h3>
                    </div>
                    <div id="diff-impact-summary">
                        <p style="color: var(--text-secondary); padding: 15px;">No diff generated</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Intelligent Suggestions Content -->
        <div class="protocol-content" id="suggestions-content">
            <div class="metrics-row">
                <div class="metric-card suggestions">
                    <div class="metric-label">Total Suggestions</div>
                    <div class="metric-value" id="suggestions-total-count">0</div>
                </div>
                <div class="metric-card suggestions">
                    <div class="metric-label">Critical</div>
                    <div class="metric-value" id="suggestions-critical-count" style="color: #ef4444;">0</div>
                </div>
                <div class="metric-card suggestions">
                    <div class="metric-label">High Priority</div>
                    <div class="metric-value" id="suggestions-high-count" style="color: #f97316;">0</div>
                </div>
                <div class="metric-card suggestions">
                    <div class="metric-label">Medium Priority</div>
                    <div class="metric-value" id="suggestions-medium-count" style="color: #facc15;">0</div>
                </div>
            </div>

            <!-- Suggestion Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Network Analysis</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.analyzeSuggestions()">
                            Analyze Network
                        </button>
                        <button class="btn btn-secondary" onclick="dashboard.refreshSuggestions()">
                            Refresh
                        </button>
                    </div>
                </div>
                <div style="display: flex; gap: 15px; align-items: center; padding: 10px 0;">
                    <select id="suggestions-category-filter" style="padding: 8px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);" onchange="dashboard.filterSuggestions()">
                        <option value="">All Categories</option>
                        <option value="performance">Performance</option>
                        <option value="security">Security</option>
                        <option value="redundancy">Redundancy</option>
                        <option value="scalability">Scalability</option>
                        <option value="best_practice">Best Practices</option>
                        <option value="configuration">Configuration</option>
                        <option value="monitoring">Monitoring</option>
                        <option value="troubleshooting">Troubleshooting</option>
                    </select>
                    <select id="suggestions-priority-filter" style="padding: 8px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);" onchange="dashboard.filterSuggestions()">
                        <option value="">All Priorities</option>
                        <option value="critical">Critical</option>
                        <option value="high">High</option>
                        <option value="medium">Medium</option>
                        <option value="low">Low</option>
                        <option value="info">Info</option>
                    </select>
                    <label style="display: flex; align-items: center; gap: 5px; color: var(--text-secondary);">
                        <input type="checkbox" id="suggestions-include-info" onchange="dashboard.filterSuggestions()">
                        Include Info
                    </label>
                </div>
            </div>

            <!-- Suggestions List -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Suggestions</h3>
                    <span id="suggestions-count-label" style="color: var(--text-secondary);">0 suggestions</span>
                </div>
                <div id="suggestions-list" style="max-height: 600px; overflow-y: auto;">
                    <p style="color: var(--text-secondary); padding: 15px;">Click "Analyze Network" to generate suggestions</p>
                </div>
            </div>

            <!-- Suggestions Summary -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                <div class="section">
                    <div class="section-header">
                        <h3>By Category</h3>
                    </div>
                    <div id="suggestions-category-summary">
                        <p style="color: var(--text-secondary); padding: 15px;">No analysis performed</p>
                    </div>
                </div>
                <div class="section">
                    <div class="section-header">
                        <h3>By Priority</h3>
                    </div>
                    <div id="suggestions-priority-summary">
                        <p style="color: var(--text-secondary); padding: 15px;">No analysis performed</p>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Recent Activity</h3>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Action</th>
                                <th>Suggestion</th>
                                <th>Reason</th>
                            </tr>
                        </thead>
                        <tbody id="suggestions-history-table">
                            <tr><td colspan="4" class="empty-state">No recent activity</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Scenario Builder Content -->
        <div class="protocol-content" id="scenarios-content">
            <div class="metrics-row">
                <div class="metric-card scenarios">
                    <div class="metric-label">Total Scenarios</div>
                    <div class="metric-value" id="scenarios-total-count">0</div>
                </div>
                <div class="metric-card scenarios">
                    <div class="metric-label">Templates</div>
                    <div class="metric-value" id="scenarios-templates-count">0</div>
                </div>
                <div class="metric-card scenarios">
                    <div class="metric-label">Completed</div>
                    <div class="metric-value" id="scenarios-completed-count" style="color: #4ade80;">0</div>
                </div>
                <div class="metric-card scenarios">
                    <div class="metric-label">Failed</div>
                    <div class="metric-value" id="scenarios-failed-count" style="color: #ef4444;">0</div>
                </div>
            </div>

            <!-- Scenario Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Scenario Builder</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showCreateScenarioModal()">
                            New Scenario
                        </button>
                        <button class="btn btn-secondary" onclick="dashboard.showTemplatesModal()">
                            From Template
                        </button>
                    </div>
                </div>
                <div style="display: flex; gap: 15px; align-items: center; padding: 10px 0;">
                    <select id="scenarios-category-filter" style="padding: 8px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);" onchange="dashboard.filterScenarios()">
                        <option value="">All Categories</option>
                        <option value="general">General</option>
                        <option value="resilience">Resilience</option>
                        <option value="routing">Routing</option>
                        <option value="convergence">Convergence</option>
                        <option value="security">Security</option>
                        <option value="performance">Performance</option>
                    </select>
                    <select id="scenarios-status-filter" style="padding: 8px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);" onchange="dashboard.filterScenarios()">
                        <option value="">All Status</option>
                        <option value="draft">Draft</option>
                        <option value="ready">Ready</option>
                        <option value="completed">Completed</option>
                        <option value="failed">Failed</option>
                    </select>
                </div>
            </div>

            <!-- Scenarios List -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Scenarios</h3>
                    <span id="scenarios-count-label" style="color: var(--text-secondary);">0 scenarios</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Category</th>
                                <th>Steps</th>
                                <th>Status</th>
                                <th>Last Run</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="scenarios-table">
                            <tr><td colspan="6" class="empty-state">No scenarios. Create one to get started.</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Scenario Editor -->
            <div class="section" style="margin-top: 20px; display: none;" id="scenario-editor">
                <div class="section-header">
                    <h3 id="scenario-editor-title">Edit Scenario</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-secondary" onclick="dashboard.addScenarioStep()">Add Step</button>
                        <button class="btn btn-primary" onclick="dashboard.runScenario()">Run</button>
                        <button class="btn btn-secondary" onclick="dashboard.runScenario(true)">Dry Run</button>
                        <button class="btn btn-secondary" onclick="dashboard.closeScenarioEditor()">Close</button>
                    </div>
                </div>
                <div id="scenario-steps-container" style="max-height: 400px; overflow-y: auto;">
                    <p style="color: var(--text-secondary); padding: 15px;">No steps defined</p>
                </div>
            </div>

            <!-- Recent Results -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Recent Results</h3>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Scenario</th>
                                <th>Status</th>
                                <th>Steps</th>
                                <th>Passed</th>
                                <th>Failed</th>
                                <th>Duration</th>
                            </tr>
                        </thead>
                        <tbody id="scenarios-results-table">
                            <tr><td colspan="6" class="empty-state">No results yet</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Create Scenario Modal -->
        <div id="create-scenario-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Create New Scenario</h3>
                    <button class="close-btn" onclick="dashboard.hideCreateScenarioModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Scenario Name</label>
                        <input type="text" id="new-scenario-name" placeholder="e.g., Link Failure Test">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="new-scenario-description" rows="3" placeholder="Describe what this scenario tests..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <select id="new-scenario-category">
                            <option value="general">General</option>
                            <option value="resilience">Resilience</option>
                            <option value="routing">Routing</option>
                            <option value="convergence">Convergence</option>
                            <option value="security">Security</option>
                            <option value="performance">Performance</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Tags (comma-separated)</label>
                        <input type="text" id="new-scenario-tags" placeholder="e.g., ospf, convergence, test">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideCreateScenarioModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.createScenario()">Create</button>
                </div>
            </div>
        </div>

        <!-- Add Step Modal -->
        <div id="add-step-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Add Scenario Step</h3>
                    <button class="close-btn" onclick="dashboard.hideAddStepModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Step Type</label>
                        <select id="step-type" onchange="dashboard.updateStepParams()">
                            <option value="verify_connectivity">Verify Connectivity</option>
                            <option value="verify_route">Verify Route</option>
                            <option value="verify_neighbor">Verify Neighbor</option>
                            <option value="verify_convergence">Verify Convergence</option>
                            <option value="interface_up">Interface Up</option>
                            <option value="interface_down">Interface Down</option>
                            <option value="link_fail">Link Failure</option>
                            <option value="link_restore">Link Restore</option>
                            <option value="traffic_start">Start Traffic</option>
                            <option value="traffic_stop">Stop Traffic</option>
                            <option value="wait">Wait</option>
                            <option value="checkpoint">Checkpoint</option>
                            <option value="log_message">Log Message</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Step Name</label>
                        <input type="text" id="step-name" placeholder="e.g., Verify initial connectivity">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="step-description" rows="2" placeholder="Optional description..."></textarea>
                    </div>
                    <div id="step-params-container">
                        <!-- Dynamic parameters based on step type -->
                    </div>
                    <div class="form-group">
                        <label>Timeout (seconds)</label>
                        <input type="number" id="step-timeout" value="60" min="1" max="300">
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="step-continue-on-failure">
                            Continue on failure
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideAddStepModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.confirmAddStep()">Add Step</button>
                </div>
            </div>
        </div>

        <!-- Templates Modal -->
        <div id="templates-modal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 700px;">
                <div class="modal-header">
                    <h3>Create from Template</h3>
                    <button class="close-btn" onclick="dashboard.hideTemplatesModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="templates-list">
                        <p style="color: var(--text-secondary);">Loading templates...</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideTemplatesModal()">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Multi-Vendor Simulation Content -->
        <div class="protocol-content" id="vendors-content">
            <div class="metrics-row">
                <div class="metric-card vendors">
                    <div class="metric-label">Total Vendors</div>
                    <div class="metric-value" id="vendors-total-count">0</div>
                </div>
                <div class="metric-card vendors">
                    <div class="metric-label">Capabilities</div>
                    <div class="metric-value" id="vendors-capabilities-count">0</div>
                </div>
                <div class="metric-card vendors">
                    <div class="metric-label">With NETCONF</div>
                    <div class="metric-value" id="vendors-netconf-count">0</div>
                </div>
                <div class="metric-card vendors">
                    <div class="metric-label">With SR/SRv6</div>
                    <div class="metric-value" id="vendors-sr-count">0</div>
                </div>
            </div>

            <!-- Vendor Selection -->
            <div class="section">
                <div class="section-header">
                    <h3>Available Vendors</h3>
                    <span id="vendors-count-label" style="color: var(--text-secondary);">0 vendors</span>
                </div>
                <div id="vendors-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px;">
                    <p style="color: var(--text-secondary); padding: 15px;">Loading vendors...</p>
                </div>
            </div>

            <!-- Vendor Details -->
            <div class="section" style="margin-top: 20px; display: none;" id="vendor-details-section">
                <div class="section-header">
                    <h3 id="vendor-details-title">Vendor Details</h3>
                    <button class="btn btn-secondary" onclick="dashboard.closeVendorDetails()">Close</button>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <!-- Profile -->
                    <div>
                        <h4 style="margin-bottom: 10px; color: var(--accent-cyan);">Behavioral Profile</h4>
                        <div id="vendor-profile-details" style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px;">
                            <!-- Profile details will be inserted here -->
                        </div>
                    </div>
                    <!-- CLI Syntax -->
                    <div>
                        <h4 style="margin-bottom: 10px; color: var(--accent-cyan);">CLI Syntax</h4>
                        <div id="vendor-cli-details" style="background: var(--bg-tertiary); border-radius: 8px; padding: 15px; max-height: 400px; overflow-y: auto;">
                            <!-- CLI syntax will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Capabilities -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Capabilities</h3>
                </div>
                <div id="vendors-capabilities-list" style="display: flex; flex-wrap: wrap; gap: 8px;">
                    <p style="color: var(--text-secondary);">Loading capabilities...</p>
                </div>
            </div>

            <!-- Command Translator -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Command Translator</h3>
                </div>
                <div style="display: grid; grid-template-columns: 1fr auto 1fr auto; gap: 15px; align-items: end;">
                    <div class="form-group" style="margin: 0;">
                        <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">From Vendor</label>
                        <select id="translate-from-vendor" style="width: 100%; padding: 8px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);">
                            <option value="">-- Select Vendor --</option>
                        </select>
                    </div>
                    <div style="padding-bottom: 5px; color: var(--text-secondary);"></div>
                    <div class="form-group" style="margin: 0;">
                        <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">To Vendor</label>
                        <select id="translate-to-vendor" style="width: 100%; padding: 8px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);">
                            <option value="">-- Select Vendor --</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="dashboard.translateCommand()">Translate</button>
                </div>
                <div style="margin-top: 15px;">
                    <div class="form-group" style="margin: 0;">
                        <label style="display: block; margin-bottom: 5px; color: var(--text-secondary);">Command</label>
                        <input type="text" id="translate-command" style="width: 100%; padding: 8px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);" placeholder="e.g., show ip ospf neighbor">
                    </div>
                </div>
                <div id="translate-result" style="margin-top: 15px; padding: 15px; background: var(--bg-tertiary); border-radius: 8px; display: none;">
                    <!-- Translation result will be shown here -->
                </div>
            </div>
        </div>

        <!-- Chaos Engineering Content -->
        <div class="protocol-content" id="chaos-content">
            <div class="metrics-row">
                <div class="metric-card chaos">
                    <div class="metric-label">Active Failures</div>
                    <div class="metric-value" id="chaos-active-count" style="color: #ef4444;">0</div>
                </div>
                <div class="metric-card chaos">
                    <div class="metric-label">Total Injected</div>
                    <div class="metric-value" id="chaos-total-count">0</div>
                </div>
                <div class="metric-card chaos">
                    <div class="metric-label">Avg Recovery</div>
                    <div class="metric-value" id="chaos-avg-recovery">-</div>
                </div>
                <div class="metric-card chaos">
                    <div class="metric-label">Scenarios Run</div>
                    <div class="metric-value" id="chaos-scenarios-count">0</div>
                </div>
            </div>

            <!-- Failure Injection -->
            <div class="section">
                <div class="section-header">
                    <h3>Inject Failure</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showInjectFailureModal()" style="background: #ef4444; border-color: #ef4444;">
                            Inject Failure
                        </button>
                        <button class="btn btn-secondary" onclick="dashboard.clearAllFailures()">
                            Clear All
                        </button>
                    </div>
                </div>
                <p style="color: var(--text-secondary); margin-top: 10px;">
                    Chaos Engineering allows you to test network resilience by injecting controlled failures.
                    Use responsibly - failures will affect network connectivity!
                </p>
            </div>

            <!-- Active Failures -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Active Failures</h3>
                    <span id="chaos-active-label" style="color: #ef4444;">0 active</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Type</th>
                                <th>Target</th>
                                <th>Started</th>
                                <th>Duration</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="chaos-active-table">
                            <tr><td colspan="6" class="empty-state">No active failures</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Chaos Scenarios -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Chaos Scenarios</h3>
                </div>
                <div id="chaos-scenarios-list" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px;">
                    <p style="color: var(--text-secondary); padding: 15px;">Loading scenarios...</p>
                </div>
            </div>

            <!-- Failure History -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Failure History</h3>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Type</th>
                                <th>Target</th>
                                <th>Duration</th>
                                <th>Recovery</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="chaos-history-table">
                            <tr><td colspan="6" class="empty-state">No history</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Config Templates Content -->
        <div class="protocol-content" id="config-content">
            <div class="metrics-row">
                <div class="metric-card config">
                    <div class="metric-label">Total Templates</div>
                    <div class="metric-value" id="config-total-count">0</div>
                </div>
                <div class="metric-card config">
                    <div class="metric-label">Categories</div>
                    <div class="metric-value" id="config-categories-count">0</div>
                </div>
                <div class="metric-card config">
                    <div class="metric-label">Variables</div>
                    <div class="metric-value" id="config-variables-count">0</div>
                </div>
                <div class="metric-card config">
                    <div class="metric-label">Renders</div>
                    <div class="metric-value" id="config-renders-count">0</div>
                </div>
            </div>

            <!-- Template Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Configuration Templates</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showCreateTemplateModal()">
                            New Template
                        </button>
                    </div>
                </div>
                <div style="display: flex; gap: 15px; align-items: center; padding: 10px 0;">
                    <select id="config-category-filter" style="padding: 8px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);" onchange="dashboard.filterConfigTemplates()">
                        <option value="">All Categories</option>
                    </select>
                    <input type="text" id="config-search" placeholder="Search templates..." style="padding: 8px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); flex: 1;" oninput="dashboard.filterConfigTemplates()">
                </div>
            </div>

            <!-- Templates Grid -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Templates</h3>
                    <span id="config-templates-count-label" style="color: var(--text-secondary);">0 templates</span>
                </div>
                <div id="config-templates-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 15px;">
                    <p style="color: var(--text-secondary); padding: 15px;">Loading templates...</p>
                </div>
            </div>

            <!-- Template Editor -->
            <div class="section" style="margin-top: 20px; display: none;" id="config-editor-section">
                <div class="section-header">
                    <h3 id="config-editor-title">Template Editor</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.saveConfigTemplate()">Save</button>
                        <button class="btn btn-secondary" onclick="dashboard.renderConfigTemplate()">Render</button>
                        <button class="btn btn-secondary" onclick="dashboard.closeConfigEditor()">Close</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; color: var(--text-secondary);">Template Content (Jinja2)</label>
                        <textarea id="config-template-content" style="width: 100%; height: 300px; padding: 12px; border-radius: 8px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); font-family: monospace; font-size: 0.85rem;"></textarea>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 8px; color: var(--text-secondary);">Rendered Output</label>
                        <pre id="config-rendered-output" style="width: 100%; height: 300px; padding: 12px; border-radius: 8px; background: var(--bg-tertiary); color: #4ade80; border: 1px solid var(--border-color); font-family: monospace; font-size: 0.85rem; overflow: auto; margin: 0;">Click "Render" to see output</pre>
                    </div>
                </div>
            </div>

            <!-- Variables -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Template Variables</h3>
                    <button class="btn btn-secondary" onclick="dashboard.showAddVariableModal()">Add Variable</button>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Type</th>
                                <th>Scope</th>
                                <th>Default</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="config-variables-table">
                            <tr><td colspan="5" class="empty-state">No variables defined</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Create Template Modal -->
        <div id="create-template-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Create Template</h3>
                    <button class="close-btn" onclick="dashboard.hideCreateTemplateModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Template Name</label>
                        <input type="text" id="new-template-name" placeholder="e.g., ospf-basic-config">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="new-template-description" rows="2" placeholder="Describe what this template configures..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <select id="new-template-category">
                            <option value="routing">Routing</option>
                            <option value="interface">Interface</option>
                            <option value="security">Security</option>
                            <option value="monitoring">Monitoring</option>
                            <option value="mpls">MPLS</option>
                            <option value="qos">QoS</option>
                            <option value="custom">Custom</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Template Content (Jinja2)</label>
                        <textarea id="new-template-content" rows="8" style="font-family: monospace;" placeholder="router ospf {{ process_id }}
  network {{ network }} area {{ area }}"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideCreateTemplateModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.createConfigTemplate()">Create</button>
                </div>
            </div>
        </div>

        <!-- Documentation Content -->
        <div class="protocol-content" id="docs-content">
            <div class="metrics-row">
                <div class="metric-card docs">
                    <div class="metric-label">Documents Generated</div>
                    <div class="metric-value" id="docs-generated-count">0</div>
                </div>
                <div class="metric-card docs">
                    <div class="metric-label">Templates Available</div>
                    <div class="metric-value" id="docs-templates-count">0</div>
                </div>
                <div class="metric-card docs">
                    <div class="metric-label">Export Formats</div>
                    <div class="metric-value" id="docs-formats-count">0</div>
                </div>
                <div class="metric-card docs">
                    <div class="metric-label">Section Types</div>
                    <div class="metric-value" id="docs-sections-count">0</div>
                </div>
            </div>

            <!-- Generate Documentation -->
            <div class="section">
                <div class="section-header">
                    <h3>Generate Documentation</h3>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr auto; gap: 15px; align-items: end; padding: 10px 0;">
                    <div>
                        <label style="display: block; margin-bottom: 5px; color: var(--text-secondary); font-size: 0.85rem;">Network Name</label>
                        <input type="text" id="docs-network-name" placeholder="ASI Network" style="padding: 8px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); width: 100%;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; color: var(--text-secondary); font-size: 0.85rem;">Template</label>
                        <select id="docs-template-select" style="padding: 8px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); width: 100%;">
                            <option value="full">Full Documentation</option>
                            <option value="overview">Quick Overview</option>
                            <option value="ip_plan">IP Addressing Plan</option>
                            <option value="protocol_guide">Protocol Configuration Guide</option>
                            <option value="security">Security Documentation</option>
                            <option value="change_report">Change Report</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; color: var(--text-secondary); font-size: 0.85rem;">Export Format</label>
                        <select id="docs-export-format" style="padding: 8px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); width: 100%;">
                            <option value="markdown">Markdown</option>
                            <option value="html">HTML</option>
                            <option value="json">JSON</option>
                            <option value="text">Plain Text</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="dashboard.generateDocumentation()" style="background: #0ea5e9; border-color: #0ea5e9;">
                        Generate
                    </button>
                </div>
            </div>

            <!-- Document Templates -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Available Templates</h3>
                    <span id="docs-templates-label" style="color: var(--text-secondary);">0 templates</span>
                </div>
                <div id="docs-templates-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px;">
                    <p style="color: var(--text-secondary); padding: 15px;">Loading templates...</p>
                </div>
            </div>

            <!-- Generated Documents -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Generated Documents</h3>
                    <span id="docs-documents-label" style="color: var(--text-secondary);">0 documents</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Document ID</th>
                                <th>Network</th>
                                <th>Template</th>
                                <th>Generated</th>
                                <th>Sections</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="docs-documents-table">
                            <tr><td colspan="6" class="empty-state">No documents generated yet</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Document Preview -->
            <div class="section" style="margin-top: 20px; display: none;" id="docs-preview-section">
                <div class="section-header">
                    <h3 id="docs-preview-title">Document Preview</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-secondary" onclick="dashboard.downloadDocument()">Download</button>
                        <button class="btn btn-secondary" onclick="dashboard.closeDocumentPreview()">Close</button>
                    </div>
                </div>
                <div id="docs-preview-content" style="padding: 20px; border-radius: 8px; background: var(--bg-tertiary); max-height: 600px; overflow: auto; font-family: monospace; white-space: pre-wrap; font-size: 0.85rem;">
                </div>
            </div>
        </div>

        <!-- Analytics Content -->
        <div class="protocol-content" id="analytics-content">
            <div class="metrics-row">
                <div class="metric-card analytics">
                    <div class="metric-label">Total Requests</div>
                    <div class="metric-value" id="analytics-total-requests">0</div>
                </div>
                <div class="metric-card analytics">
                    <div class="metric-label">Error Rate</div>
                    <div class="metric-value" id="analytics-error-rate">0%</div>
                </div>
                <div class="metric-card analytics">
                    <div class="metric-label">Unique Endpoints</div>
                    <div class="metric-value" id="analytics-unique-endpoints">0</div>
                </div>
                <div class="metric-card analytics">
                    <div class="metric-label">Unique Clients</div>
                    <div class="metric-value" id="analytics-unique-clients">0</div>
                </div>
            </div>

            <!-- Rate Limiting Section -->
            <div class="section">
                <div class="section-header">
                    <h3>Rate Limiting</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <label style="display: flex; align-items: center; gap: 5px; color: var(--text-secondary);">
                            <input type="checkbox" id="analytics-ratelimit-enabled" onchange="dashboard.toggleRateLimit()">
                            Enabled
                        </label>
                        <button class="btn btn-secondary" onclick="dashboard.showRateLimitModal()">Configure</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px;">
                        <div style="color: var(--text-secondary); font-size: 0.8rem;">Requests/Min</div>
                        <div style="color: var(--text-primary); font-size: 1.2rem;" id="analytics-rpm">60</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px;">
                        <div style="color: var(--text-secondary); font-size: 0.8rem;">Requests/Hour</div>
                        <div style="color: var(--text-primary); font-size: 1.2rem;" id="analytics-rph">1000</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px;">
                        <div style="color: var(--text-secondary); font-size: 0.8rem;">Burst Limit</div>
                        <div style="color: var(--text-primary); font-size: 1.2rem;" id="analytics-burst">20</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px;">
                        <div style="color: var(--text-secondary); font-size: 0.8rem;">Blocked Clients</div>
                        <div style="color: #ef4444; font-size: 1.2rem;" id="analytics-blocked-count">0</div>
                    </div>
                </div>
            </div>

            <!-- Top Endpoints -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Top Endpoints</h3>
                    <select id="analytics-endpoint-metric" style="padding: 6px 12px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);" onchange="dashboard.refreshAnalytics()">
                        <option value="requests">By Requests</option>
                        <option value="errors">By Errors</option>
                        <option value="response_time">By Response Time</option>
                        <option value="bytes">By Data Transfer</option>
                    </select>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Endpoint</th>
                                <th>Requests</th>
                                <th>Errors</th>
                                <th>Error Rate</th>
                                <th>Avg Response</th>
                                <th>Req/Min</th>
                            </tr>
                        </thead>
                        <tbody id="analytics-endpoints-table">
                            <tr><td colspan="6" class="empty-state">No data yet</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Top Clients -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Top Clients</h3>
                    <span id="analytics-clients-label" style="color: var(--text-secondary);">0 clients</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Client IP</th>
                                <th>Requests</th>
                                <th>Errors</th>
                                <th>Avg Response</th>
                                <th>Endpoints</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="analytics-clients-table">
                            <tr><td colspan="7" class="empty-state">No data yet</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Recent Requests -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Recent Requests</h3>
                    <button class="btn btn-secondary" onclick="dashboard.refreshAnalytics()">Refresh</button>
                </div>
                <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Method</th>
                                <th>Endpoint</th>
                                <th>Client</th>
                                <th>Status</th>
                                <th>Response Time</th>
                            </tr>
                        </thead>
                        <tbody id="analytics-requests-table">
                            <tr><td colspan="6" class="empty-state">No requests yet</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Blocked Clients -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Blocked Clients</h3>
                    <span id="analytics-blocked-label" style="color: var(--text-secondary);">0 blocked</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Client IP</th>
                                <th>Blocked Until</th>
                                <th>Remaining</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="analytics-blocked-table">
                            <tr><td colspan="4" class="empty-state">No blocked clients</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Compliance Content -->
        <div class="protocol-content" id="compliance-content">
            <div class="metrics-row">
                <div class="metric-card compliance">
                    <div class="metric-label">Compliance Score</div>
                    <div class="metric-value" id="compliance-score">--</div>
                </div>
                <div class="metric-card compliance">
                    <div class="metric-label">Total Rules</div>
                    <div class="metric-value" id="compliance-total-rules">0</div>
                </div>
                <div class="metric-card compliance">
                    <div class="metric-label">Violations</div>
                    <div class="metric-value" id="compliance-violations">0</div>
                </div>
                <div class="metric-card compliance">
                    <div class="metric-label">Reports</div>
                    <div class="metric-value" id="compliance-reports-count">0</div>
                </div>
            </div>

            <!-- Run Compliance Check -->
            <div class="section">
                <div class="section-header">
                    <h3>Run Compliance Check</h3>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 15px; align-items: end; padding: 10px 0;">
                    <div>
                        <label style="display: block; margin-bottom: 5px; color: var(--text-secondary); font-size: 0.85rem;">Rule Set</label>
                        <select id="compliance-rule-set" style="padding: 8px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); width: 100%;">
                            <option value="default">Default (All Rules)</option>
                            <option value="security">Security Only</option>
                            <option value="routing">Routing Only</option>
                            <option value="monitoring">Monitoring Only</option>
                            <option value="best-practice">Best Practices Only</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; color: var(--text-secondary); font-size: 0.85rem;">Category Filter (optional)</label>
                        <select id="compliance-category" style="padding: 8px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); width: 100%;">
                            <option value="">All Categories</option>
                            <option value="security">Security</option>
                            <option value="authentication">Authentication</option>
                            <option value="encryption">Encryption</option>
                            <option value="routing">Routing</option>
                            <option value="redundancy">Redundancy</option>
                            <option value="monitoring">Monitoring</option>
                            <option value="logging">Logging</option>
                            <option value="configuration">Configuration</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="dashboard.runComplianceCheck()" style="background: #f97316; border-color: #f97316;">
                        Run Check
                    </button>
                </div>
            </div>

            <!-- Latest Report Summary -->
            <div class="section" style="margin-top: 20px; display: none;" id="compliance-report-section">
                <div class="section-header">
                    <h3 id="compliance-report-title">Latest Report</h3>
                    <span id="compliance-report-time" style="color: var(--text-secondary);"></span>
                </div>
                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-bottom: 15px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #ef4444;">
                        <div style="color: var(--text-secondary); font-size: 0.8rem;">Critical</div>
                        <div style="color: #ef4444; font-size: 1.4rem; font-weight: 600;" id="compliance-critical">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="color: var(--text-secondary); font-size: 0.8rem;">High</div>
                        <div style="color: #f59e0b; font-size: 1.4rem; font-weight: 600;" id="compliance-high">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #eab308;">
                        <div style="color: var(--text-secondary); font-size: 0.8rem;">Medium</div>
                        <div style="color: #eab308; font-size: 1.4rem; font-weight: 600;" id="compliance-medium">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #22c55e;">
                        <div style="color: var(--text-secondary); font-size: 0.8rem;">Low</div>
                        <div style="color: #22c55e; font-size: 1.4rem; font-weight: 600;" id="compliance-low">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #6b7280;">
                        <div style="color: var(--text-secondary); font-size: 0.8rem;">Info</div>
                        <div style="color: #6b7280; font-size: 1.4rem; font-weight: 600;" id="compliance-info">0</div>
                    </div>
                </div>
            </div>

            <!-- Violations Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Violations</h3>
                    <span id="compliance-violations-label" style="color: var(--text-secondary);">0 violations</span>
                </div>
                <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Severity</th>
                                <th>Rule</th>
                                <th>Agent</th>
                                <th>Resource</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody id="compliance-violations-table">
                            <tr><td colspan="5" class="empty-state">Run a compliance check to see violations</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Rules List -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Compliance Rules</h3>
                    <span id="compliance-rules-label" style="color: var(--text-secondary);">0 rules</span>
                </div>
                <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Category</th>
                                <th>Severity</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="compliance-rules-table">
                            <tr><td colspan="6" class="empty-state">Loading rules...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Report History -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Report History</h3>
                    <span id="compliance-history-label" style="color: var(--text-secondary);">0 reports</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Report ID</th>
                                <th>Date</th>
                                <th>Rule Set</th>
                                <th>Score</th>
                                <th>Violations</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="compliance-history-table">
                            <tr><td colspan="6" class="empty-state">No reports yet</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Exporter Content -->
        <div class="protocol-content" id="exporter-content">
            <div class="metrics-row">
                <div class="metric-card exporter">
                    <div class="metric-label">Total Exports</div>
                    <div class="metric-value" id="exporter-total">0</div>
                </div>
                <div class="metric-card exporter">
                    <div class="metric-label">Formats Available</div>
                    <div class="metric-value" id="exporter-formats-count">10</div>
                </div>
                <div class="metric-card exporter">
                    <div class="metric-label">Network Nodes</div>
                    <div class="metric-value" id="exporter-nodes">0</div>
                </div>
                <div class="metric-card exporter">
                    <div class="metric-label">Network Links</div>
                    <div class="metric-value" id="exporter-links">0</div>
                </div>
            </div>

            <!-- Export Form -->
            <div class="section">
                <div class="section-header">
                    <h3>Export Topology</h3>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; padding: 10px 0;">
                    <div>
                        <label style="display: block; margin-bottom: 5px; color: var(--text-secondary); font-size: 0.85rem;">Export Format</label>
                        <select id="exporter-format" style="padding: 8px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); width: 100%;">
                            <option value="dot">Graphviz DOT</option>
                            <option value="json">JSON</option>
                            <option value="yaml">YAML</option>
                            <option value="gns3">GNS3 Project</option>
                            <option value="containerlab">Containerlab</option>
                            <option value="netbox">NetBox</option>
                            <option value="d2">D2 Diagram</option>
                            <option value="mermaid">Mermaid</option>
                            <option value="cyjs">Cytoscape.js</option>
                            <option value="csv">CSV</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; color: var(--text-secondary); font-size: 0.85rem;">Layout</label>
                        <select id="exporter-layout" style="padding: 8px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); width: 100%;">
                            <option value="hierarchical">Hierarchical</option>
                            <option value="circular">Circular</option>
                            <option value="grid">Grid</option>
                        </select>
                    </div>
                    <div style="display: flex; align-items: end;">
                        <button class="btn btn-primary" onclick="dashboard.exportTopology()" style="background: #84cc16; border-color: #84cc16; width: 100%;">
                            Export
                        </button>
                    </div>
                </div>
                <div style="display: flex; gap: 20px; padding: 10px 0; flex-wrap: wrap;">
                    <label style="display: flex; align-items: center; gap: 5px; color: var(--text-secondary);">
                        <input type="checkbox" id="exporter-configs" checked> Include Configs
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px; color: var(--text-secondary);">
                        <input type="checkbox" id="exporter-interfaces" checked> Include Interfaces
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px; color: var(--text-secondary);">
                        <input type="checkbox" id="exporter-routing" checked> Include Routing
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px; color: var(--text-secondary);">
                        <input type="checkbox" id="exporter-labels" checked> Include Labels
                    </label>
                </div>
            </div>

            <!-- Export Preview -->
            <div class="section" style="margin-top: 20px; display: none;" id="exporter-preview-section">
                <div class="section-header">
                    <h3 id="exporter-preview-title">Export Preview</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-secondary" onclick="dashboard.downloadExport()">Download</button>
                        <button class="btn btn-secondary" onclick="dashboard.copyExport()">Copy</button>
                        <button class="btn btn-secondary" onclick="dashboard.closeExportPreview()">Close</button>
                    </div>
                </div>
                <pre id="exporter-preview-content" style="padding: 20px; border-radius: 8px; background: var(--bg-tertiary); max-height: 500px; overflow: auto; font-family: monospace; font-size: 0.85rem; color: #84cc16; white-space: pre-wrap;"></pre>
            </div>

            <!-- Format Descriptions -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Export Formats</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #84cc16;">
                        <h4 style="margin: 0 0 5px 0; color: #84cc16;">Graphviz DOT</h4>
                        <p style="margin: 0; font-size: 0.85rem; color: var(--text-secondary);">Generate graph visualizations with Graphviz</p>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <h4 style="margin: 0 0 5px 0; color: #3b82f6;">GNS3 Project</h4>
                        <p style="margin: 0; font-size: 0.85rem; color: var(--text-secondary);">Import into GNS3 network simulator</p>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <h4 style="margin: 0 0 5px 0; color: #8b5cf6;">Containerlab</h4>
                        <p style="margin: 0; font-size: 0.85rem; color: var(--text-secondary);">Deploy as containerized network lab</p>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <h4 style="margin: 0 0 5px 0; color: #f59e0b;">NetBox</h4>
                        <p style="margin: 0; font-size: 0.85rem; color: var(--text-secondary);">Import into NetBox DCIM/IPAM</p>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #ec4899;">
                        <h4 style="margin: 0 0 5px 0; color: #ec4899;">Mermaid</h4>
                        <p style="margin: 0; font-size: 0.85rem; color: var(--text-secondary);">Embed in markdown documentation</p>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #06b6d4;">
                        <h4 style="margin: 0 0 5px 0; color: #06b6d4;">D2 Diagram</h4>
                        <p style="margin: 0; font-size: 0.85rem; color: var(--text-secondary);">Modern declarative diagramming</p>
                    </div>
                </div>
            </div>

            <!-- Export History -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Export History</h3>
                    <span id="exporter-history-label" style="color: var(--text-secondary);">0 exports</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Filename</th>
                                <th>Format</th>
                                <th>Nodes</th>
                                <th>Links</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody id="exporter-history-table">
                            <tr><td colspan="5" class="empty-state">No exports yet</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Scheduler Content -->
        <div class="protocol-content" id="scheduler-content">
            <div class="metrics-row">
                <div class="metric-card scheduler">
                    <div class="metric-label">Total Jobs</div>
                    <div class="metric-value" id="scheduler-total-jobs">0</div>
                </div>
                <div class="metric-card scheduler">
                    <div class="metric-label">Running Jobs</div>
                    <div class="metric-value" id="scheduler-running-jobs">0</div>
                </div>
                <div class="metric-card scheduler">
                    <div class="metric-label">Active Triggers</div>
                    <div class="metric-value" id="scheduler-triggers">0</div>
                </div>
                <div class="metric-card scheduler">
                    <div class="metric-label">Scheduler Status</div>
                    <div class="metric-value" id="scheduler-status">--</div>
                </div>
            </div>

            <!-- Scheduler Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Scheduler Controls</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showCreateJobModal()" style="background: #f472b6; border-color: #f472b6;">Create Job</button>
                        <button class="btn btn-secondary" onclick="dashboard.showCreateTriggerModal()">Create Trigger</button>
                        <button class="btn btn-secondary" onclick="dashboard.tickScheduler()">Manual Tick</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">Enabled Jobs</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="scheduler-enabled-jobs">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">Pending Jobs</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #facc15;" id="scheduler-pending-jobs">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">Completed Jobs</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #0ea5e9;" id="scheduler-completed-jobs">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">Failed Jobs</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #ef4444;" id="scheduler-failed-jobs">0</div>
                    </div>
                </div>
            </div>

            <!-- Jobs Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Scheduled Jobs</h3>
                    <span id="scheduler-jobs-label" style="color: var(--text-secondary);">0 jobs</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Job ID</th>
                                <th>Name</th>
                                <th>Type</th>
                                <th>Priority</th>
                                <th>Status</th>
                                <th>Next Run</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="scheduler-jobs-table">
                            <tr><td colspan="7" class="empty-state">No scheduled jobs</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Triggers Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Triggers</h3>
                    <span id="scheduler-triggers-label" style="color: var(--text-secondary);">0 triggers</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Trigger ID</th>
                                <th>Type</th>
                                <th>Job ID</th>
                                <th>Status</th>
                                <th>Schedule</th>
                                <th>Next Fire</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="scheduler-triggers-table">
                            <tr><td colspan="7" class="empty-state">No triggers configured</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Job History -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Execution History</h3>
                    <span id="scheduler-history-label" style="color: var(--text-secondary);">0 executions</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Job ID</th>
                                <th>Job Name</th>
                                <th>Status</th>
                                <th>Start Time</th>
                                <th>Duration</th>
                                <th>Result</th>
                            </tr>
                        </thead>
                        <tbody id="scheduler-history-table">
                            <tr><td colspan="6" class="empty-state">No execution history</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Job Types Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Available Job Types</h3>
                </div>
                <div id="scheduler-job-types" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #f472b6;">
                        <div style="font-weight: bold; color: #f472b6;">NETWORK_SCAN</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Scan network devices</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">CONFIG_BACKUP</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Backup configurations</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #0ea5e9;">
                        <div style="font-weight: bold; color: #0ea5e9;">HEALTH_CHECK</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Check device health</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">COMPLIANCE_CHECK</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Run compliance checks</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">REPORT_GENERATION</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Generate reports</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #06b6d4;">
                        <div style="font-weight: bold; color: #06b6d4;">CUSTOM</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Custom job handler</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Inventory Content -->
        <div class="protocol-content" id="inventory-content">
            <div class="metrics-row">
                <div class="metric-card inventory">
                    <div class="metric-label">Total Devices</div>
                    <div class="metric-value" id="inventory-total-devices">0</div>
                </div>
                <div class="metric-card inventory">
                    <div class="metric-label">Active</div>
                    <div class="metric-value" id="inventory-active-devices">0</div>
                </div>
                <div class="metric-card inventory">
                    <div class="metric-label">Sites</div>
                    <div class="metric-value" id="inventory-sites">0</div>
                </div>
                <div class="metric-card inventory">
                    <div class="metric-label">Alerts</div>
                    <div class="metric-value" id="inventory-alerts">0</div>
                </div>
            </div>

            <!-- Inventory Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Inventory Management</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showAddDeviceModal()" style="background: #22d3ee; border-color: #22d3ee;">Add Device</button>
                        <button class="btn btn-secondary" onclick="dashboard.exportInventory()">Export</button>
                        <button class="btn btn-secondary" onclick="dashboard.showImportModal()">Import</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">Routers</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #22d3ee;" id="inventory-routers">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">Switches</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #a855f7;" id="inventory-switches">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">Firewalls</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #ef4444;" id="inventory-firewalls">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">Servers</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="inventory-servers">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">Other</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: var(--text-secondary);" id="inventory-other">0</div>
                    </div>
                </div>
            </div>

            <!-- Alerts Section -->
            <div class="section" style="margin-top: 20px;" id="inventory-alerts-section">
                <div class="section-header">
                    <h3>Inventory Alerts</h3>
                    <span id="inventory-alerts-label" style="color: var(--text-secondary);">0 alerts</span>
                </div>
                <div id="inventory-alerts-container" style="max-height: 200px; overflow-y: auto;">
                    <div style="text-align: center; color: var(--text-secondary); padding: 20px;">No alerts</div>
                </div>
            </div>

            <!-- Devices Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Device Inventory</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <select id="inventory-filter-type" style="padding: 6px 10px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);">
                            <option value="">All Types</option>
                            <option value="router">Routers</option>
                            <option value="switch">Switches</option>
                            <option value="firewall">Firewalls</option>
                            <option value="server">Servers</option>
                            <option value="virtual_machine">VMs</option>
                            <option value="container">Containers</option>
                        </select>
                        <select id="inventory-filter-status" style="padding: 6px 10px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);">
                            <option value="">All Statuses</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                            <option value="maintenance">Maintenance</option>
                            <option value="decommissioned">Decommissioned</option>
                        </select>
                        <input type="text" id="inventory-search" placeholder="Search..." style="padding: 6px 10px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); width: 150px;" onkeyup="dashboard.filterInventory()">
                        <span id="inventory-devices-label" style="color: var(--text-secondary);">0 devices</span>
                    </div>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Management IP</th>
                                <th>Vendor</th>
                                <th>Model</th>
                                <th>Site</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="inventory-devices-table">
                            <tr><td colspan="8" class="empty-state">No devices in inventory</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Statistics Charts -->
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 20px;">
                <div class="section">
                    <div class="section-header">
                        <h3>By Vendor</h3>
                    </div>
                    <div id="inventory-by-vendor" style="padding: 10px;">
                        <div style="text-align: center; color: var(--text-secondary);">No data</div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-header">
                        <h3>By Site</h3>
                    </div>
                    <div id="inventory-by-site" style="padding: 10px;">
                        <div style="text-align: center; color: var(--text-secondary);">No data</div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-header">
                        <h3>By Lifecycle</h3>
                    </div>
                    <div id="inventory-by-lifecycle" style="padding: 10px;">
                        <div style="text-align: center; color: var(--text-secondary);">No data</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Capacity Content -->
        <div class="protocol-content" id="capacity-content">
            <div class="metrics-row">
                <div class="metric-card capacity">
                    <div class="metric-label">Total Resources</div>
                    <div class="metric-value" id="capacity-total">0</div>
                </div>
                <div class="metric-card capacity">
                    <div class="metric-label">Avg Utilization</div>
                    <div class="metric-value" id="capacity-avg-util">0<span class="metric-unit">%</span></div>
                </div>
                <div class="metric-card capacity">
                    <div class="metric-label">Critical</div>
                    <div class="metric-value" id="capacity-critical">0</div>
                </div>
                <div class="metric-card capacity">
                    <div class="metric-label">Recommendations</div>
                    <div class="metric-value" id="capacity-recs">0</div>
                </div>
            </div>

            <!-- Capacity Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Capacity Planning</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.generateForecasts()" style="background: #14b8a6; border-color: #14b8a6;">Generate Forecasts</button>
                        <button class="btn btn-secondary" onclick="dashboard.generateCapacityRecommendations()">Get Recommendations</button>
                        <button class="btn btn-secondary" onclick="dashboard.showRecordMetricModal()">Record Metric</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">Healthy</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="capacity-healthy">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">Warning</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;" id="capacity-warning">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">Urgent (30d)</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f97316;" id="capacity-urgent">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">Total Forecasts</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #14b8a6;" id="capacity-forecasts">0</div>
                    </div>
                </div>
            </div>

            <!-- Top Utilized Resources -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Top Utilized Resources</h3>
                    <span id="capacity-top-label" style="color: var(--text-secondary);">Highest utilization</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Resource</th>
                                <th>Device</th>
                                <th>Type</th>
                                <th>Current</th>
                                <th>Capacity</th>
                                <th>Utilization</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="capacity-metrics-table">
                            <tr><td colspan="7" class="empty-state">No capacity metrics recorded</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Forecasts -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Capacity Forecasts</h3>
                    <span id="capacity-forecasts-label" style="color: var(--text-secondary);">0 forecasts</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Resource</th>
                                <th>Device</th>
                                <th>Trend</th>
                                <th>7 Days</th>
                                <th>30 Days</th>
                                <th>Days to Critical</th>
                                <th>Confidence</th>
                            </tr>
                        </thead>
                        <tbody id="capacity-forecasts-table">
                            <tr><td colspan="7" class="empty-state">Generate forecasts to see predictions</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Recommendations -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Recommendations</h3>
                    <span id="capacity-recs-label" style="color: var(--text-secondary);">0 recommendations</span>
                </div>
                <div id="capacity-recommendations-container">
                    <div style="text-align: center; color: var(--text-secondary); padding: 20px;">Generate recommendations to see planning suggestions</div>
                </div>
            </div>

            <!-- Resource Types -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Resource Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #14b8a6;">
                        <div style="font-weight: bold; color: #14b8a6;">BANDWIDTH</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Network throughput</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">CPU</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Processing power</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #a855f7;">
                        <div style="font-weight: bold; color: #a855f7;">MEMORY</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">RAM utilization</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">STORAGE</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Disk space</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #ec4899;">
                        <div style="font-weight: bold; color: #ec4899;">PORTS</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Network ports</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">ROUTES</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Routing table</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SLA Content -->
        <div class="protocol-content" id="sla-content">
            <div class="metrics-row">
                <div class="metric-card sla">
                    <div class="metric-label">Total SLAs</div>
                    <div class="metric-value" id="sla-total">0</div>
                </div>
                <div class="metric-card sla">
                    <div class="metric-label">Compliance Rate</div>
                    <div class="metric-value" id="sla-compliance"><span class="metric-unit">--%</span></div>
                </div>
                <div class="metric-card sla">
                    <div class="metric-label">Violated</div>
                    <div class="metric-value" id="sla-violated">0</div>
                </div>
                <div class="metric-card sla">
                    <div class="metric-label">Active Violations</div>
                    <div class="metric-value" id="sla-active-violations">0</div>
                </div>
            </div>

            <!-- SLA Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>SLA Monitoring</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showCreateSLAModal()" style="background: #f43f5e; border-color: #f43f5e;">Create SLA</button>
                        <button class="btn btn-secondary" onclick="dashboard.refreshSLAData()">Refresh</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">Compliant</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="sla-compliant-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">At Risk</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;" id="sla-at-risk-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">Total Violations</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #ef4444;" id="sla-total-violations">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">Reports</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f43f5e;" id="sla-reports-count">0</div>
                    </div>
                </div>
            </div>

            <!-- SLA Definitions Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>SLA Definitions</h3>
                    <span id="sla-definitions-label" style="color: var(--text-secondary);">0 SLAs</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Service</th>
                                <th>Type</th>
                                <th>Targets</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="sla-definitions-table">
                            <tr><td colspan="6" class="empty-state">No SLAs defined</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Violations Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Recent Violations</h3>
                    <span id="sla-violations-label" style="color: var(--text-secondary);">0 violations</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>SLA</th>
                                <th>Metric</th>
                                <th>Target</th>
                                <th>Actual</th>
                                <th>Breach %</th>
                                <th>Severity</th>
                                <th>Start Time</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="sla-violations-table">
                            <tr><td colspan="8" class="empty-state">No violations recorded</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- SLA Metric Types Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>SLA Metric Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">AVAILABILITY</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Uptime percentage</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">LATENCY</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Response time (ms)</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #ef4444;">
                        <div style="font-weight: bold; color: #ef4444;">PACKET_LOSS</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Loss percentage</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">JITTER</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Latency variation</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #a855f7;">
                        <div style="font-weight: bold; color: #a855f7;">THROUGHPUT</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Bandwidth (Mbps)</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #06b6d4;">
                        <div style="font-weight: bold; color: #06b6d4;">ERROR_RATE</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Error percentage</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Audit Content -->
        <div class="protocol-content" id="audit-content">
            <div class="metrics-row">
                <div class="metric-card audit">
                    <div class="metric-label">Total Events</div>
                    <div class="metric-value" id="audit-total">0</div>
                </div>
                <div class="metric-card audit">
                    <div class="metric-label">Security Events</div>
                    <div class="metric-value" id="audit-security">0</div>
                </div>
                <div class="metric-card audit">
                    <div class="metric-label">Today</div>
                    <div class="metric-value" id="audit-today">0</div>
                </div>
                <div class="metric-card audit">
                    <div class="metric-label">Exports</div>
                    <div class="metric-value" id="audit-exports">0</div>
                </div>
            </div>

            <!-- Audit Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Audit Log</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.exportAuditLog()" style="background: #78716c; border-color: #78716c;">Export</button>
                        <button class="btn btn-secondary" onclick="dashboard.showLogEventModal()">Log Event</button>
                        <button class="btn btn-secondary" onclick="dashboard.refreshAuditData()">Refresh</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">CREATE</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="audit-create-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">UPDATE</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #3b82f6;" id="audit-update-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">DELETE</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #ef4444;" id="audit-delete-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">LOGIN</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #a855f7;" id="audit-login-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">CONFIG</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;" id="audit-config-count">0</div>
                    </div>
                </div>
            </div>

            <!-- Filter Section -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Filter Events</h3>
                </div>
                <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                    <select id="audit-filter-type" style="padding: 8px 12px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);" onchange="dashboard.filterAuditEvents()">
                        <option value="">All Types</option>
                        <option value="CREATE">Create</option>
                        <option value="UPDATE">Update</option>
                        <option value="DELETE">Delete</option>
                        <option value="LOGIN">Login</option>
                        <option value="LOGOUT">Logout</option>
                        <option value="CONFIG_CHANGE">Config Change</option>
                        <option value="SECURITY">Security</option>
                        <option value="ERROR">Error</option>
                    </select>
                    <select id="audit-filter-severity" style="padding: 8px 12px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);" onchange="dashboard.filterAuditEvents()">
                        <option value="">All Severities</option>
                        <option value="INFO">Info</option>
                        <option value="WARNING">Warning</option>
                        <option value="ERROR">Error</option>
                        <option value="CRITICAL">Critical</option>
                    </select>
                    <input type="text" id="audit-filter-user" placeholder="User ID..." style="padding: 8px 12px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); width: 150px;" onkeyup="dashboard.filterAuditEvents()">
                    <input type="text" id="audit-filter-resource" placeholder="Resource..." style="padding: 8px 12px; border-radius: 4px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); width: 150px;" onkeyup="dashboard.filterAuditEvents()">
                </div>
            </div>

            <!-- Events Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Recent Events</h3>
                    <span id="audit-events-label" style="color: var(--text-secondary);">0 events</span>
                </div>
                <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Timestamp</th>
                                <th>Type</th>
                                <th>Severity</th>
                                <th>User</th>
                                <th>Resource</th>
                                <th>Description</th>
                                <th>IP</th>
                            </tr>
                        </thead>
                        <tbody id="audit-events-table">
                            <tr><td colspan="7" class="empty-state">No audit events</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Event Types Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Event Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">CREATE</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Resource created</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">UPDATE</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Resource updated</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #ef4444;">
                        <div style="font-weight: bold; color: #ef4444;">DELETE</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Resource deleted</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #a855f7;">
                        <div style="font-weight: bold; color: #a855f7;">LOGIN/LOGOUT</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">User sessions</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">CONFIG_CHANGE</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Configuration</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #dc2626;">
                        <div style="font-weight: bold; color: #dc2626;">SECURITY</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Security events</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Log Event Modal -->
        <div id="log-event-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 style="color: #78716c;">Log Audit Event</h3>
                    <button class="close-btn" onclick="dashboard.hideLogEventModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Event Type</label>
                            <select id="audit-event-type">
                                <option value="CREATE">Create</option>
                                <option value="UPDATE">Update</option>
                                <option value="DELETE">Delete</option>
                                <option value="CONFIG_CHANGE">Config Change</option>
                                <option value="SECURITY">Security</option>
                                <option value="CUSTOM">Custom</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Severity</label>
                            <select id="audit-event-severity">
                                <option value="INFO">Info</option>
                                <option value="WARNING">Warning</option>
                                <option value="ERROR">Error</option>
                                <option value="CRITICAL">Critical</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>User ID</label>
                            <input type="text" id="audit-event-user" placeholder="e.g., admin">
                        </div>
                        <div class="form-group">
                            <label>Resource Type</label>
                            <input type="text" id="audit-event-resource-type" placeholder="e.g., device, config">
                        </div>
                        <div class="form-group" style="grid-column: span 2;">
                            <label>Resource ID</label>
                            <input type="text" id="audit-event-resource-id" placeholder="Resource identifier">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="audit-event-description" rows="2" placeholder="Event description..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideLogEventModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.logAuditEvent()" style="background: #78716c; border-color: #78716c;">Log Event</button>
                </div>
            </div>
        </div>

        <!-- Backup Content -->
        <div class="protocol-content" id="backup-content">
            <div class="metrics-row">
                <div class="metric-card backup">
                    <div class="metric-label">Total Backups</div>
                    <div class="metric-value" id="backup-total">0</div>
                </div>
                <div class="metric-card backup">
                    <div class="metric-label">Successful</div>
                    <div class="metric-value" id="backup-successful">0</div>
                </div>
                <div class="metric-card backup">
                    <div class="metric-label">Schedules</div>
                    <div class="metric-value" id="backup-schedules">0</div>
                </div>
                <div class="metric-card backup">
                    <div class="metric-label">Last Backup</div>
                    <div class="metric-value" id="backup-last" style="font-size: 0.9rem;">Never</div>
                </div>
            </div>

            <!-- Backup Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Backup Management</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showCreateBackupModal()" style="background: #0ea5e9; border-color: #0ea5e9;">Create Backup</button>
                        <button class="btn btn-secondary" onclick="dashboard.showScheduleBackupModal()">Schedule</button>
                        <button class="btn btn-secondary" onclick="dashboard.refreshBackupData()">Refresh</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">FULL</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #0ea5e9;" id="backup-full-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">INCREMENTAL</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #3b82f6;" id="backup-incremental-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">CONFIG</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="backup-config-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">TOPOLOGY</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;" id="backup-topology-count">0</div>
                    </div>
                </div>
            </div>

            <!-- Backups Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Backups</h3>
                    <span id="backup-list-label" style="color: var(--text-secondary);">0 backups</span>
                </div>
                <div class="table-container" style="max-height: 300px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Size</th>
                                <th>Created</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="backup-table">
                            <tr><td colspan="6" class="empty-state">No backups available</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Schedules Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Backup Schedules</h3>
                </div>
                <div class="table-container" style="max-height: 250px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Frequency</th>
                                <th>Type</th>
                                <th>Retention</th>
                                <th>Status</th>
                                <th>Next Run</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="backup-schedules-table">
                            <tr><td colspan="7" class="empty-state">No schedules configured</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Backup Types Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Backup Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #0ea5e9;">
                        <div style="font-weight: bold; color: #0ea5e9;">FULL</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Complete network state</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">INCREMENTAL</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Changes since last backup</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">CONFIG</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Agent configurations only</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">TOPOLOGY</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Network topology snapshot</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Create Backup Modal -->
        <div id="create-backup-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 style="color: #0ea5e9;">Create Backup</h3>
                    <button class="close-btn" onclick="dashboard.hideCreateBackupModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Backup Name</label>
                        <input type="text" id="backup-name" placeholder="e.g., Pre-maintenance backup">
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Backup Type</label>
                            <select id="backup-type">
                                <option value="full">Full Backup</option>
                                <option value="incremental">Incremental</option>
                                <option value="config">Config Only</option>
                                <option value="topology">Topology Only</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Compression</label>
                            <select id="backup-compression">
                                <option value="gzip">GZIP</option>
                                <option value="none">None</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="backup-description" rows="2" placeholder="Optional backup description..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideCreateBackupModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.createBackup()" style="background: #0ea5e9; border-color: #0ea5e9;">Create Backup</button>
                </div>
            </div>
        </div>

        <!-- Schedule Backup Modal -->
        <div id="schedule-backup-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 style="color: #0ea5e9;">Schedule Backup</h3>
                    <button class="close-btn" onclick="dashboard.hideScheduleBackupModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Schedule Name</label>
                        <input type="text" id="schedule-name" placeholder="e.g., Daily Config Backup">
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Frequency</label>
                            <select id="schedule-frequency">
                                <option value="hourly">Hourly</option>
                                <option value="daily">Daily</option>
                                <option value="weekly">Weekly</option>
                                <option value="monthly">Monthly</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Backup Type</label>
                            <select id="schedule-backup-type">
                                <option value="full">Full Backup</option>
                                <option value="incremental">Incremental</option>
                                <option value="config">Config Only</option>
                                <option value="topology">Topology Only</option>
                            </select>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Retention (days)</label>
                            <input type="number" id="schedule-retention" value="30" min="1" max="365">
                        </div>
                        <div class="form-group">
                            <label>Max Backups</label>
                            <input type="number" id="schedule-max-backups" value="10" min="1" max="100">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideScheduleBackupModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.createBackupSchedule()" style="background: #0ea5e9; border-color: #0ea5e9;">Create Schedule</button>
                </div>
            </div>
        </div>

        <!-- Alerts Content -->
        <div class="protocol-content" id="alerts-content">
            <div class="metrics-row">
                <div class="metric-card alerts">
                    <div class="metric-label">Active Alerts</div>
                    <div class="metric-value" id="alerts-active">0</div>
                </div>
                <div class="metric-card alerts">
                    <div class="metric-label">Critical</div>
                    <div class="metric-value" id="alerts-critical">0</div>
                </div>
                <div class="metric-card alerts">
                    <div class="metric-label">Warning</div>
                    <div class="metric-value" id="alerts-warning">0</div>
                </div>
                <div class="metric-card alerts">
                    <div class="metric-label">Channels</div>
                    <div class="metric-value" id="alerts-channels">0</div>
                </div>
            </div>

            <!-- Alert Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Alert Management</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showCreateAlertRuleModal()" style="background: #ef4444; border-color: #ef4444;">Create Rule</button>
                        <button class="btn btn-secondary" onclick="dashboard.showAddChannelModal()">Add Channel</button>
                        <button class="btn btn-secondary" onclick="dashboard.refreshAlertsData()">Refresh</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">CRITICAL</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #dc2626;" id="alerts-critical-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">HIGH</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f97316;" id="alerts-high-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">MEDIUM</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #eab308;" id="alerts-medium-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">LOW</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #3b82f6;" id="alerts-low-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">INFO</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #6b7280;" id="alerts-info-count">0</div>
                    </div>
                </div>
            </div>

            <!-- Active Alerts Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Active Alerts</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-sm" onclick="dashboard.acknowledgeAllAlerts()">Acknowledge All</button>
                        <span id="alerts-list-label" style="color: var(--text-secondary);">0 alerts</span>
                    </div>
                </div>
                <div class="table-container" style="max-height: 300px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Severity</th>
                                <th>Message</th>
                                <th>Source</th>
                                <th>Category</th>
                                <th>Status</th>
                                <th>Time</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="alerts-table">
                            <tr><td colspan="7" class="empty-state">No active alerts</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Alert Rules Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Alert Rules</h3>
                </div>
                <div class="table-container" style="max-height: 250px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Condition</th>
                                <th>Severity</th>
                                <th>Status</th>
                                <th>Triggers</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="alert-rules-table">
                            <tr><td colspan="6" class="empty-state">No alert rules configured</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Notification Channels Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Notification Channels</h3>
                </div>
                <div class="table-container" style="max-height: 200px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Last Used</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="alert-channels-table">
                            <tr><td colspan="5" class="empty-state">No channels configured</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Alert Severities Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Alert Severities</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #dc2626;">
                        <div style="font-weight: bold; color: #dc2626;">CRITICAL</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Immediate action required</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #f97316;">
                        <div style="font-weight: bold; color: #f97316;">HIGH</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Urgent attention needed</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #eab308;">
                        <div style="font-weight: bold; color: #eab308;">MEDIUM</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Should be investigated</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">LOW</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Monitor and track</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #6b7280;">
                        <div style="font-weight: bold; color: #6b7280;">INFO</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Informational only</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Create Alert Rule Modal -->
        <div id="create-alert-rule-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 style="color: #ef4444;">Create Alert Rule</h3>
                    <button class="close-btn" onclick="dashboard.hideCreateAlertRuleModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Rule Name</label>
                        <input type="text" id="alert-rule-name" placeholder="e.g., High CPU Alert">
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Condition</label>
                            <select id="alert-rule-condition">
                                <option value="cpu_high">CPU > 80%</option>
                                <option value="memory_high">Memory > 90%</option>
                                <option value="link_down">Link Down</option>
                                <option value="neighbor_down">Neighbor Down</option>
                                <option value="route_change">Route Change</option>
                                <option value="packet_loss">Packet Loss > 5%</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Severity</label>
                            <select id="alert-rule-severity">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                                <option value="info">Info</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <select id="alert-rule-category">
                            <option value="network">Network</option>
                            <option value="system">System</option>
                            <option value="security">Security</option>
                            <option value="performance">Performance</option>
                            <option value="protocol">Protocol</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="alert-rule-description" rows="2" placeholder="Alert description..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideCreateAlertRuleModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.createAlertRule()" style="background: #ef4444; border-color: #ef4444;">Create Rule</button>
                </div>
            </div>
        </div>

        <!-- Add Notification Channel Modal -->
        <div id="add-channel-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 style="color: #ef4444;">Add Notification Channel</h3>
                    <button class="close-btn" onclick="dashboard.hideAddChannelModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Channel Name</label>
                        <input type="text" id="channel-name" placeholder="e.g., Ops Team Email">
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Channel Type</label>
                            <select id="channel-type" onchange="dashboard.updateChannelConfig()">
                                <option value="email">Email</option>
                                <option value="slack">Slack</option>
                                <option value="webhook">Webhook</option>
                                <option value="pagerduty">PagerDuty</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Min Severity</label>
                            <select id="channel-min-severity">
                                <option value="critical">Critical Only</option>
                                <option value="high">High+</option>
                                <option value="medium">Medium+</option>
                                <option value="low">Low+</option>
                                <option value="info">All</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group" id="channel-config-email">
                        <label>Email Address</label>
                        <input type="email" id="channel-email" placeholder="alerts@example.com">
                    </div>
                    <div class="form-group" id="channel-config-webhook" style="display: none;">
                        <label>Webhook URL</label>
                        <input type="url" id="channel-webhook" placeholder="https://hooks.example.com/...">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideAddChannelModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.createNotificationChannel()" style="background: #ef4444; border-color: #ef4444;">Add Channel</button>
                </div>
            </div>
        </div>

        <!-- Workflows Content -->
        <div class="protocol-content" id="workflows-content">
            <div class="metrics-row">
                <div class="metric-card workflows">
                    <div class="metric-label">Total Workflows</div>
                    <div class="metric-value" id="workflows-total">0</div>
                </div>
                <div class="metric-card workflows">
                    <div class="metric-label">Running</div>
                    <div class="metric-value" id="workflows-running">0</div>
                </div>
                <div class="metric-card workflows">
                    <div class="metric-label">Templates</div>
                    <div class="metric-value" id="workflows-templates">0</div>
                </div>
                <div class="metric-card workflows">
                    <div class="metric-label">Success Rate</div>
                    <div class="metric-value" id="workflows-success-rate">0%</div>
                </div>
            </div>

            <!-- Workflow Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Workflow Automation</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showCreateWorkflowModal()" style="background: #8b5cf6; border-color: #8b5cf6;">Create Workflow</button>
                        <button class="btn btn-secondary" onclick="dashboard.showWorkflowTemplatesModal()">Templates</button>
                        <button class="btn btn-secondary" onclick="dashboard.refreshWorkflowsData()">Refresh</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">PENDING</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #6b7280;" id="workflows-pending-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">RUNNING</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #8b5cf6;" id="workflows-running-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">COMPLETED</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="workflows-completed-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">FAILED</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #ef4444;" id="workflows-failed-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">PAUSED</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;" id="workflows-paused-count">0</div>
                    </div>
                </div>
            </div>

            <!-- Workflows Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Workflows</h3>
                    <span id="workflows-list-label" style="color: var(--text-secondary);">0 workflows</span>
                </div>
                <div class="table-container" style="max-height: 300px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Status</th>
                                <th>Steps</th>
                                <th>Progress</th>
                                <th>Created</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="workflows-table">
                            <tr><td colspan="6" class="empty-state">No workflows defined</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Running Workflows -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Running Workflows</h3>
                </div>
                <div class="table-container" style="max-height: 200px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Current Step</th>
                                <th>Progress</th>
                                <th>Started</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="workflows-running-table">
                            <tr><td colspan="5" class="empty-state">No running workflows</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Workflow Step Types Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Step Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">COMMAND</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Execute CLI command</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">API_CALL</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">HTTP API request</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">SCRIPT</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Python script</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">CONDITION</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Conditional branch</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #ec4899;">
                        <div style="font-weight: bold; color: #ec4899;">WAIT</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Delay/wait step</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #06b6d4;">
                        <div style="font-weight: bold; color: #06b6d4;">APPROVAL</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Manual approval</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Create Workflow Modal -->
        <div id="create-workflow-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 style="color: #8b5cf6;">Create Workflow</h3>
                    <button class="close-btn" onclick="dashboard.hideCreateWorkflowModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Workflow Name</label>
                        <input type="text" id="workflow-name" placeholder="e.g., Network Health Check">
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Trigger</label>
                            <select id="workflow-trigger">
                                <option value="manual">Manual</option>
                                <option value="scheduled">Scheduled</option>
                                <option value="event">Event-Based</option>
                                <option value="alert">Alert-Triggered</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Priority</label>
                            <select id="workflow-priority">
                                <option value="low">Low</option>
                                <option value="normal" selected>Normal</option>
                                <option value="high">High</option>
                                <option value="critical">Critical</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="workflow-description" rows="2" placeholder="Workflow description..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideCreateWorkflowModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.createWorkflow()" style="background: #8b5cf6; border-color: #8b5cf6;">Create Workflow</button>
                </div>
            </div>
        </div>

        <!-- Users/RBAC Content -->
        <div class="protocol-content" id="users-content">
            <div class="metrics-row">
                <div class="metric-card users">
                    <div class="metric-label">Total Users</div>
                    <div class="metric-value" id="users-total">0</div>
                </div>
                <div class="metric-card users">
                    <div class="metric-label">Active</div>
                    <div class="metric-value" id="users-active">0</div>
                </div>
                <div class="metric-card users">
                    <div class="metric-label">Roles</div>
                    <div class="metric-value" id="users-roles">0</div>
                </div>
                <div class="metric-card users">
                    <div class="metric-label">Policies</div>
                    <div class="metric-value" id="users-policies">0</div>
                </div>
            </div>

            <!-- User Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>User Management</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showCreateUserModal()" style="background: #06b6d4; border-color: #06b6d4;">Create User</button>
                        <button class="btn btn-secondary" onclick="dashboard.showCreateRoleModal()">Create Role</button>
                        <button class="btn btn-secondary" onclick="dashboard.refreshUsersData()">Refresh</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">ACTIVE</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="users-active-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">SUSPENDED</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;" id="users-suspended-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">LOCKED</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #ef4444;" id="users-locked-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">PENDING</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #6b7280;" id="users-pending-count">0</div>
                    </div>
                </div>
            </div>

            <!-- Users Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Users</h3>
                    <span id="users-list-label" style="color: var(--text-secondary);">0 users</span>
                </div>
                <div class="table-container" style="max-height: 250px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Username</th>
                                <th>Email</th>
                                <th>Status</th>
                                <th>Roles</th>
                                <th>Last Login</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="users-table">
                            <tr><td colspan="6" class="empty-state">No users configured</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Roles Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Roles</h3>
                </div>
                <div class="table-container" style="max-height: 200px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Role</th>
                                <th>Description</th>
                                <th>Permissions</th>
                                <th>Users</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="roles-table">
                            <tr><td colspan="5" class="empty-state">No roles defined</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Permissions Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Permission Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">READ</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">View resources</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">WRITE</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Modify resources</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">EXECUTE</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Run operations</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #ef4444;">
                        <div style="font-weight: bold; color: #ef4444;">DELETE</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Remove resources</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">ADMIN</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Full access</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Create User Modal -->
        <div id="create-user-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 style="color: #06b6d4;">Create User</h3>
                    <button class="close-btn" onclick="dashboard.hideCreateUserModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Username</label>
                            <input type="text" id="user-username" placeholder="e.g., jsmith">
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="user-email" placeholder="user@example.com">
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Full Name</label>
                            <input type="text" id="user-fullname" placeholder="John Smith">
                        </div>
                        <div class="form-group">
                            <label>Initial Role</label>
                            <select id="user-role">
                                <option value="viewer">Viewer</option>
                                <option value="operator">Operator</option>
                                <option value="admin">Admin</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideCreateUserModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.createUser()" style="background: #06b6d4; border-color: #06b6d4;">Create User</button>
                </div>
            </div>
        </div>

        <!-- Create Role Modal -->
        <div id="create-role-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 style="color: #06b6d4;">Create Role</h3>
                    <button class="close-btn" onclick="dashboard.hideCreateRoleModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Role Name</label>
                        <input type="text" id="role-name" placeholder="e.g., network-operator">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <input type="text" id="role-description" placeholder="Role description...">
                    </div>
                    <div class="form-group">
                        <label>Permissions (select multiple)</label>
                        <select id="role-permissions" multiple size="5" style="width: 100%;">
                            <option value="read">Read</option>
                            <option value="write">Write</option>
                            <option value="execute">Execute</option>
                            <option value="delete">Delete</option>
                            <option value="admin">Admin</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideCreateRoleModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.createRole()" style="background: #06b6d4; border-color: #06b6d4;">Create Role</button>
                </div>
            </div>
        </div>

        <!-- Webhooks Content -->
        <div class="protocol-content" id="webhooks-content">
            <div class="metrics-row">
                <div class="metric-card webhooks">
                    <div class="metric-label">Total Webhooks</div>
                    <div class="metric-value" id="webhooks-total">0</div>
                </div>
                <div class="metric-card webhooks">
                    <div class="metric-label">Active</div>
                    <div class="metric-value" id="webhooks-active">0</div>
                </div>
                <div class="metric-card webhooks">
                    <div class="metric-label">Deliveries</div>
                    <div class="metric-value" id="webhooks-deliveries">0</div>
                </div>
                <div class="metric-card webhooks">
                    <div class="metric-label">Success Rate</div>
                    <div class="metric-value" id="webhooks-success-rate">0%</div>
                </div>
            </div>

            <!-- Webhook Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Webhook Management</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showCreateWebhookModal()" style="background: #f97316; border-color: #f97316;">Create Webhook</button>
                        <button class="btn btn-secondary" onclick="dashboard.testWebhook()">Test</button>
                        <button class="btn btn-secondary" onclick="dashboard.refreshWebhooksData()">Refresh</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">ACTIVE</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="webhooks-active-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">PAUSED</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;" id="webhooks-paused-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">DELIVERED</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #3b82f6;" id="webhooks-delivered-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">FAILED</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #ef4444;" id="webhooks-failed-count">0</div>
                    </div>
                </div>
            </div>

            <!-- Webhooks Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Webhooks</h3>
                    <span id="webhooks-list-label" style="color: var(--text-secondary);">0 webhooks</span>
                </div>
                <div class="table-container" style="max-height: 250px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>URL</th>
                                <th>Events</th>
                                <th>Status</th>
                                <th>Last Delivery</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="webhooks-table">
                            <tr><td colspan="6" class="empty-state">No webhooks configured</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Recent Deliveries Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Recent Deliveries</h3>
                </div>
                <div class="table-container" style="max-height: 200px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Webhook</th>
                                <th>Event</th>
                                <th>Status</th>
                                <th>Response</th>
                                <th>Time</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="webhook-deliveries-table">
                            <tr><td colspan="6" class="empty-state">No deliveries</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Event Types Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Event Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">AGENT</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Agent events</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">NETWORK</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Network changes</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">CONFIG</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Config changes</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #ef4444;">
                        <div style="font-weight: bold; color: #ef4444;">ALERT</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Alert triggers</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">TEST</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Test results</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Create Webhook Modal -->
        <div id="create-webhook-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 style="color: #f97316;">Create Webhook</h3>
                    <button class="close-btn" onclick="dashboard.hideCreateWebhookModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Webhook Name</label>
                        <input type="text" id="webhook-name" placeholder="e.g., Alert Notifications">
                    </div>
                    <div class="form-group">
                        <label>URL</label>
                        <input type="url" id="webhook-url" placeholder="https://your-server.com/webhook">
                    </div>
                    <div class="form-group">
                        <label>Events (select multiple)</label>
                        <select id="webhook-events" multiple size="4" style="width: 100%;">
                            <option value="agent.created">Agent Created</option>
                            <option value="agent.updated">Agent Updated</option>
                            <option value="network.change">Network Change</option>
                            <option value="config.change">Config Change</option>
                            <option value="alert.triggered">Alert Triggered</option>
                            <option value="test.completed">Test Completed</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideCreateWebhookModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.createWebhook()" style="background: #f97316; border-color: #f97316;">Create Webhook</button>
                </div>
            </div>
        </div>

        <!-- API Keys Content -->
        <div class="protocol-content" id="apikeys-content">
            <div class="metrics-row">
                <div class="metric-card apikeys">
                    <div class="metric-label">Total Keys</div>
                    <div class="metric-value" id="apikeys-total">0</div>
                </div>
                <div class="metric-card apikeys">
                    <div class="metric-label">Active</div>
                    <div class="metric-value" id="apikeys-active">0</div>
                </div>
                <div class="metric-card apikeys">
                    <div class="metric-label">Total Requests</div>
                    <div class="metric-value" id="apikeys-requests">0</div>
                </div>
                <div class="metric-card apikeys">
                    <div class="metric-label">Expiring Soon</div>
                    <div class="metric-value" id="apikeys-expiring">0</div>
                </div>
            </div>

            <!-- API Key Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>API Key Management</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showCreateApiKeyModal()" style="background: #a855f7; border-color: #a855f7;">Generate Key</button>
                        <button class="btn btn-secondary" onclick="dashboard.refreshApiKeysData()">Refresh</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">ACTIVE</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="apikeys-active-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">SUSPENDED</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;" id="apikeys-suspended-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">REVOKED</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #ef4444;" id="apikeys-revoked-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">EXPIRED</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #6b7280;" id="apikeys-expired-count">0</div>
                    </div>
                </div>
            </div>

            <!-- API Keys Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>API Keys</h3>
                    <span id="apikeys-list-label" style="color: var(--text-secondary);">0 keys</span>
                </div>
                <div class="table-container" style="max-height: 300px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Key (Prefix)</th>
                                <th>Scopes</th>
                                <th>Status</th>
                                <th>Requests</th>
                                <th>Expires</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="apikeys-table">
                            <tr><td colspan="7" class="empty-state">No API keys configured</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- API Scopes Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Available Scopes</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">read:agents</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Read agent data</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">write:agents</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Modify agents</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">read:network</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Read network data</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">write:network</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Modify network</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #ef4444;">
                        <div style="font-weight: bold; color: #ef4444;">admin</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Full access</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Create API Key Modal -->
        <div id="create-apikey-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 style="color: #a855f7;">Generate API Key</h3>
                    <button class="close-btn" onclick="dashboard.hideCreateApiKeyModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Key Name</label>
                        <input type="text" id="apikey-name" placeholder="e.g., CI/CD Pipeline">
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Owner</label>
                            <input type="text" id="apikey-owner" placeholder="e.g., team-automation">
                        </div>
                        <div class="form-group">
                            <label>Expires In</label>
                            <select id="apikey-expiry">
                                <option value="30">30 days</option>
                                <option value="90">90 days</option>
                                <option value="180">180 days</option>
                                <option value="365">1 year</option>
                                <option value="0">Never</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Scopes (select multiple)</label>
                        <select id="apikey-scopes" multiple size="5" style="width: 100%;">
                            <option value="read:agents">read:agents</option>
                            <option value="write:agents">write:agents</option>
                            <option value="read:network">read:network</option>
                            <option value="write:network">write:network</option>
                            <option value="read:config">read:config</option>
                            <option value="write:config">write:config</option>
                            <option value="admin">admin</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideCreateApiKeyModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.generateApiKey()" style="background: #a855f7; border-color: #a855f7;">Generate Key</button>
                </div>
            </div>
        </div>

        <!-- Sessions Content -->
        <div class="protocol-content" id="sessions-content">
            <div class="metrics-row">
                <div class="metric-card sessions">
                    <div class="metric-label">Active Sessions</div>
                    <div class="metric-value" id="sessions-active">0</div>
                </div>
                <div class="metric-card sessions">
                    <div class="metric-label">Total Today</div>
                    <div class="metric-value" id="sessions-today">0</div>
                </div>
                <div class="metric-card sessions">
                    <div class="metric-label">Unique Users</div>
                    <div class="metric-value" id="sessions-users">0</div>
                </div>
                <div class="metric-card sessions">
                    <div class="metric-label">Avg Duration</div>
                    <div class="metric-value" id="sessions-duration">0m</div>
                </div>
            </div>

            <!-- Session Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Session Management</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-secondary" onclick="dashboard.cleanupSessions()">Cleanup Expired</button>
                        <button class="btn btn-secondary" onclick="dashboard.refreshSessionsData()">Refresh</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">ACTIVE</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="sessions-active-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">LOCKED</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;" id="sessions-locked-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">EXPIRED</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #6b7280;" id="sessions-expired-count">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">REVOKED</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #ef4444;" id="sessions-revoked-count">0</div>
                    </div>
                </div>
            </div>

            <!-- Active Sessions Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Active Sessions</h3>
                    <span id="sessions-list-label" style="color: var(--text-secondary);">0 sessions</span>
                </div>
                <div class="table-container" style="max-height: 250px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>User</th>
                                <th>IP Address</th>
                                <th>Device</th>
                                <th>Status</th>
                                <th>Started</th>
                                <th>Last Active</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="sessions-table">
                            <tr><td colspan="7" class="empty-state">No active sessions</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Recent Activity Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Recent Activity</h3>
                </div>
                <div class="table-container" style="max-height: 200px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>User</th>
                                <th>Action</th>
                                <th>Resource</th>
                                <th>Status</th>
                                <th>Time</th>
                            </tr>
                        </thead>
                        <tbody id="session-activities-table">
                            <tr><td colspan="5" class="empty-state">No recent activity</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Session Status Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Session Statuses</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">ACTIVE</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Currently in use</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">LOCKED</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Temporarily locked</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #6b7280;">
                        <div style="font-weight: bold; color: #6b7280;">EXPIRED</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Session timed out</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #ef4444;">
                        <div style="font-weight: bold; color: #ef4444;">REVOKED</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Manually terminated</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tenancy Content -->
        <div class="protocol-content" id="tenancy-content">
            <div class="metrics-row">
                <div class="metric-card tenancy">
                    <div class="metric-label">Total Tenants</div>
                    <div class="metric-value" id="tenancy-total">0</div>
                </div>
                <div class="metric-card tenancy">
                    <div class="metric-label">Active</div>
                    <div class="metric-value" id="tenancy-active">0</div>
                </div>
                <div class="metric-card tenancy">
                    <div class="metric-label">Suspended</div>
                    <div class="metric-value" id="tenancy-suspended">0</div>
                </div>
                <div class="metric-card tenancy">
                    <div class="metric-label">Enterprise Tier</div>
                    <div class="metric-value" id="tenancy-enterprise">0</div>
                </div>
            </div>

            <!-- Tenant Management Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Tenant Management</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showCreateTenantModal()" style="background: #0d9488; border-color: #0d9488;">Create Tenant</button>
                        <button class="btn btn-secondary" onclick="dashboard.refreshTenancyData()">Refresh</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">FREE</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #6b7280;" id="tenancy-tier-free">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">BASIC</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #3b82f6;" id="tenancy-tier-basic">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">STANDARD</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #8b5cf6;" id="tenancy-tier-standard">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">PREMIUM</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;" id="tenancy-tier-premium">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">ENTERPRISE</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="tenancy-tier-enterprise">0</div>
                    </div>
                </div>
            </div>

            <!-- Tenants Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>All Tenants</h3>
                    <span id="tenancy-list-label" style="color: var(--text-secondary);">0 tenants</span>
                </div>
                <div class="table-container" style="max-height: 350px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Tier</th>
                                <th>Status</th>
                                <th>Agents</th>
                                <th>Networks</th>
                                <th>Owner Email</th>
                                <th>Created</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="tenancy-table">
                            <tr><td colspan="9" class="empty-state">No tenants found</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Tenant Tiers Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Service Tier Reference</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #6b7280;">
                        <div style="font-weight: bold; color: #6b7280;">FREE</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 5px;">3 agents, 1 network</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary);">100 API calls/hr</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">BASIC</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 5px;">10 agents, 3 networks</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary);">500 API calls/hr</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">STANDARD</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 5px;">25 agents, 10 networks</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary);">2,000 API calls/hr</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">PREMIUM</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 5px;">100 agents, 50 networks</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary);">10,000 API calls/hr</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">ENTERPRISE</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 5px;">1000 agents, 500 networks</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary);">100,000 API calls/hr</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Plugins Content -->
        <div class="protocol-content" id="plugins-content">
            <div class="metrics-row">
                <div class="metric-card plugins">
                    <div class="metric-label">Total Plugins</div>
                    <div class="metric-value" id="plugins-total">0</div>
                </div>
                <div class="metric-card plugins">
                    <div class="metric-label">Enabled</div>
                    <div class="metric-value" id="plugins-enabled">0</div>
                </div>
                <div class="metric-card plugins">
                    <div class="metric-label">Hooks</div>
                    <div class="metric-value" id="plugins-hooks">0</div>
                </div>
                <div class="metric-card plugins">
                    <div class="metric-label">Registry</div>
                    <div class="metric-value" id="plugins-registry">0</div>
                </div>
            </div>

            <!-- Plugin Management Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Plugin Management</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showInstallPluginModal()" style="background: #ec4899; border-color: #ec4899;">Install Plugin</button>
                        <button class="btn btn-secondary" onclick="dashboard.refreshPluginsData()">Refresh</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">PROTOCOL</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #3b82f6;" id="plugins-type-protocol">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">INTEGRATION</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #8b5cf6;" id="plugins-type-integration">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">VISUALIZATION</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="plugins-type-visualization">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">UTILITY</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;" id="plugins-type-utility">0</div>
                    </div>
                </div>
            </div>

            <!-- Installed Plugins Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Installed Plugins</h3>
                    <span id="plugins-list-label" style="color: var(--text-secondary);">0 plugins</span>
                </div>
                <div class="table-container" style="max-height: 300px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Version</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Description</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="plugins-table">
                            <tr><td colspan="7" class="empty-state">No plugins installed</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Plugin Registry Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Available in Registry</h3>
                    <span id="registry-list-label" style="color: var(--text-secondary);">0 available</span>
                </div>
                <div class="table-container" style="max-height: 250px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Version</th>
                                <th>Type</th>
                                <th>Author</th>
                                <th>Downloads</th>
                                <th>Rating</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="registry-table">
                            <tr><td colspan="7" class="empty-state">No plugins in registry</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Plugin Types Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Plugin Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">PROTOCOL</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Network protocol support</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">INTEGRATION</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Third-party integrations</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">VISUALIZATION</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">UI and dashboard widgets</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">UTILITY</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Helper utilities</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Rate Limiting Content -->
        <div class="protocol-content" id="ratelimit-content">
            <div class="metrics-row">
                <div class="metric-card ratelimit">
                    <div class="metric-label">Requests/Min</div>
                    <div class="metric-value" id="ratelimit-rpm">0</div>
                </div>
                <div class="metric-card ratelimit">
                    <div class="metric-label">Allowed/Min</div>
                    <div class="metric-value" id="ratelimit-allowed">0</div>
                </div>
                <div class="metric-card ratelimit">
                    <div class="metric-label">Denied/Min</div>
                    <div class="metric-value" id="ratelimit-denied">0</div>
                </div>
                <div class="metric-card ratelimit">
                    <div class="metric-label">Denial Rate</div>
                    <div class="metric-value" id="ratelimit-denial-rate">0%</div>
                </div>
            </div>

            <!-- Rate Limit Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Rate Limiting</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-secondary" onclick="dashboard.refreshRateLimitData()">Refresh</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">BUCKETS</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #3b82f6;" id="ratelimit-buckets">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">WINDOWS</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #8b5cf6;" id="ratelimit-windows">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">TIERS</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="ratelimit-tiers">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">USER LIMITS</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;" id="ratelimit-users">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">BLOCKED</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #ef4444;" id="ratelimit-blocked">0</div>
                    </div>
                </div>
            </div>

            <!-- Rate Limit Tiers Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Rate Limit Tiers</h3>
                    <span id="tiers-list-label" style="color: var(--text-secondary);">0 tiers</span>
                </div>
                <div class="table-container" style="max-height: 250px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Tier Name</th>
                                <th>Req/Second</th>
                                <th>Req/Minute</th>
                                <th>Req/Hour</th>
                                <th>Burst Size</th>
                                <th>Algorithm</th>
                            </tr>
                        </thead>
                        <tbody id="ratelimit-tiers-table">
                            <tr><td colspan="6" class="empty-state">No rate limit tiers configured</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Recent Requests Log -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Recent Requests</h3>
                    <span id="requests-list-label" style="color: var(--text-secondary);">0 requests</span>
                </div>
                <div class="table-container" style="max-height: 200px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Key</th>
                                <th>Tier</th>
                                <th>Status</th>
                                <th>Time</th>
                            </tr>
                        </thead>
                        <tbody id="ratelimit-log-table">
                            <tr><td colspan="4" class="empty-state">No recent requests</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Rate Limit Tier Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Default Tiers</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #6b7280;">
                        <div style="font-weight: bold; color: #6b7280;">FREE</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 5px;">1 req/s, 60 req/min</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Burst: 10</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">BASIC</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 5px;">5 req/s, 300 req/min</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Burst: 25</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">STANDARD</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 5px;">10 req/s, 600 req/min</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Burst: 50</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">PREMIUM</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 5px;">50 req/s, 3000 req/min</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Burst: 200</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">ENTERPRISE</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 5px;">200 req/s, 12000 req/min</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Burst: 1000</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Events Content -->
        <div class="protocol-content" id="events-content">
            <div class="metrics-row">
                <div class="metric-card events">
                    <div class="metric-label">Total Published</div>
                    <div class="metric-value" id="events-published">0</div>
                </div>
                <div class="metric-card events">
                    <div class="metric-label">Total Delivered</div>
                    <div class="metric-value" id="events-delivered">0</div>
                </div>
                <div class="metric-card events">
                    <div class="metric-label">Subscribers</div>
                    <div class="metric-value" id="events-subscribers">0</div>
                </div>
                <div class="metric-card events">
                    <div class="metric-label">Channels</div>
                    <div class="metric-value" id="events-channels">0</div>
                </div>
            </div>

            <!-- Event Bus Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Event Bus</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showPublishEventModal()" style="background: #6366f1; border-color: #6366f1;">Publish Event</button>
                        <button class="btn btn-secondary" onclick="dashboard.refreshEventsData()">Refresh</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">SYSTEM</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #ef4444;" id="events-type-system">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">PROTOCOL</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #3b82f6;" id="events-type-protocol">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">NETWORK</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="events-type-network">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">AGENT</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;" id="events-type-agent">0</div>
                    </div>
                </div>
            </div>

            <!-- Recent Events Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Recent Events</h3>
                    <span id="events-list-label" style="color: var(--text-secondary);">0 events</span>
                </div>
                <div class="table-container" style="max-height: 300px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Type</th>
                                <th>Source</th>
                                <th>Priority</th>
                                <th>Delivered</th>
                                <th>Time</th>
                                <th>Tags</th>
                            </tr>
                        </thead>
                        <tbody id="events-table">
                            <tr><td colspan="6" class="empty-state">No events recorded</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Active Subscribers Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Subscribers</h3>
                    <span id="subscribers-list-label" style="color: var(--text-secondary);">0 subscribers</span>
                </div>
                <div class="table-container" style="max-height: 200px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Event Types</th>
                                <th>Status</th>
                                <th>Events Received</th>
                            </tr>
                        </thead>
                        <tbody id="subscribers-table">
                            <tr><td colspan="4" class="empty-state">No subscribers registered</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Event Priority Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Event Priorities</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #6b7280;">
                        <div style="font-weight: bold; color: #6b7280;">LOW</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Background tasks</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">NORMAL</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Standard events</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">HIGH</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Important changes</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #ef4444;">
                        <div style="font-weight: bold; color: #ef4444;">CRITICAL</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Urgent issues</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Rules Content -->
        <div class="protocol-content" id="rules-content">
            <div class="metrics-row">
                <div class="metric-card rules">
                    <div class="metric-label">Total Rules</div>
                    <div class="metric-value" id="rules-total">0</div>
                </div>
                <div class="metric-card rules">
                    <div class="metric-label">Enabled</div>
                    <div class="metric-value" id="rules-enabled">0</div>
                </div>
                <div class="metric-card rules">
                    <div class="metric-label">Executions</div>
                    <div class="metric-value" id="rules-executions">0</div>
                </div>
                <div class="metric-card rules">
                    <div class="metric-label">Rule Sets</div>
                    <div class="metric-value" id="rules-sets">0</div>
                </div>
            </div>

            <!-- Rules Engine Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Rules Engine</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showCreateRuleModal()" style="background: #84cc16; border-color: #84cc16;">Create Rule</button>
                        <button class="btn btn-secondary" onclick="dashboard.refreshRulesData()">Refresh</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">CONDITIONS</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #3b82f6;" id="rules-conditions">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">ACTIONS</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #8b5cf6;" id="rules-actions">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">MATCHES</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="rules-matches">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">FAILURES</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #ef4444;" id="rules-failures">0</div>
                    </div>
                </div>
            </div>

            <!-- Rules Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Rules</h3>
                    <span id="rules-list-label" style="color: var(--text-secondary);">0 rules</span>
                </div>
                <div class="table-container" style="max-height: 300px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Priority</th>
                                <th>Conditions</th>
                                <th>Actions</th>
                                <th>Executions</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="rules-table">
                            <tr><td colspan="7" class="empty-state">No rules defined</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Rule Sets Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Rule Sets</h3>
                    <span id="rulesets-list-label" style="color: var(--text-secondary);">0 rule sets</span>
                </div>
                <div class="table-container" style="max-height: 200px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Rules</th>
                                <th>Status</th>
                                <th>Last Run</th>
                            </tr>
                        </thead>
                        <tbody id="rulesets-table">
                            <tr><td colspan="4" class="empty-state">No rule sets defined</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Rule Priority Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Rule Priorities</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(6, 1fr); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #6b7280; text-align: center;">
                        <div style="font-weight: bold; color: #6b7280; font-size: 0.8rem;">LOWEST</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #94a3b8; text-align: center;">
                        <div style="font-weight: bold; color: #94a3b8; font-size: 0.8rem;">LOW</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #3b82f6; text-align: center;">
                        <div style="font-weight: bold; color: #3b82f6; font-size: 0.8rem;">NORMAL</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #f59e0b; text-align: center;">
                        <div style="font-weight: bold; color: #f59e0b; font-size: 0.8rem;">HIGH</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #f97316; text-align: center;">
                        <div style="font-weight: bold; color: #f97316; font-size: 0.8rem;">HIGHEST</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border-left: 3px solid #ef4444; text-align: center;">
                        <div style="font-weight: bold; color: #ef4444; font-size: 0.8rem;">CRITICAL</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Messaging Content -->
        <div class="protocol-content" id="messaging-content">
            <div class="metrics-row">
                <div class="metric-card messaging">
                    <div class="metric-label">Messages Sent</div>
                    <div class="metric-value" id="messaging-sent">0</div>
                </div>
                <div class="metric-card messaging">
                    <div class="metric-label">Messages Received</div>
                    <div class="metric-value" id="messaging-received">0</div>
                </div>
                <div class="metric-card messaging">
                    <div class="metric-label">Active Topics</div>
                    <div class="metric-value" id="messaging-topics">0</div>
                </div>
                <div class="metric-card messaging">
                    <div class="metric-label">Subscribers</div>
                    <div class="metric-value" id="messaging-subs">0</div>
                </div>
            </div>

            <!-- Messaging Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Message Bus</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showSendMessageModal()" style="background: #0ea5e9; border-color: #0ea5e9;">Send Message</button>
                        <button class="btn btn-secondary" onclick="dashboard.refreshMessagingData()">Refresh</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">ROUTE UPDATES</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #3b82f6;" id="messaging-routes">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">HEALTH STATUS</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="messaging-health">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">ALERTS</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;" id="messaging-alerts">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">PENDING ACK</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #ef4444;" id="messaging-pending">0</div>
                    </div>
                </div>
            </div>

            <!-- Recent Messages Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Recent Messages</h3>
                    <span id="messages-list-label" style="color: var(--text-secondary);">0 messages</span>
                </div>
                <div class="table-container" style="max-height: 300px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Type</th>
                                <th>From</th>
                                <th>To</th>
                                <th>Topic</th>
                                <th>Priority</th>
                                <th>Status</th>
                                <th>Time</th>
                            </tr>
                        </thead>
                        <tbody id="messages-table">
                            <tr><td colspan="7" class="empty-state">No messages</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Topics Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Active Topics</h3>
                    <span id="topics-list-label" style="color: var(--text-secondary);">0 topics</span>
                </div>
                <div class="table-container" style="max-height: 200px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Topic</th>
                                <th>Subscribers</th>
                                <th>Messages</th>
                                <th>Last Activity</th>
                            </tr>
                        </thead>
                        <tbody id="topics-table">
                            <tr><td colspan="4" class="empty-state">No active topics</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Message Types Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Message Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">ROUTE_UPDATE</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Routing info sharing</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">HEALTH_STATUS</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Agent health reports</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">CONFIG_PROPOSAL</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Collaborative config</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #ef4444;">
                        <div style="font-weight: bold; color: #ef4444;">ALERT</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Critical notifications</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Healing Content -->
        <div class="protocol-content" id="healing-content">
            <div class="metrics-row">
                <div class="metric-card healing">
                    <div class="metric-label">Anomalies Detected</div>
                    <div class="metric-value" id="healing-anomalies">0</div>
                </div>
                <div class="metric-card healing">
                    <div class="metric-label">Actions Executed</div>
                    <div class="metric-value" id="healing-actions">0</div>
                </div>
                <div class="metric-card healing">
                    <div class="metric-label">Success Rate</div>
                    <div class="metric-value" id="healing-success-rate">0%</div>
                </div>
                <div class="metric-card healing">
                    <div class="metric-label">Active Monitors</div>
                    <div class="metric-value" id="healing-monitors">0</div>
                </div>
            </div>

            <!-- Healing Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Self-Healing Engine</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-secondary" onclick="dashboard.refreshHealingData()">Refresh</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">ADJACENCY LOSS</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #ef4444;" id="healing-adjacency">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">ROUTE ISSUES</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;" id="healing-route">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">PROTOCOL ANOMALY</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #8b5cf6;" id="healing-protocol">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">AUTO REMEDIATED</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="healing-remediated">0</div>
                    </div>
                </div>
            </div>

            <!-- Recent Anomalies Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Recent Anomalies</h3>
                    <span id="anomalies-list-label" style="color: var(--text-secondary);">0 anomalies</span>
                </div>
                <div class="table-container" style="max-height: 250px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Type</th>
                                <th>Agent</th>
                                <th>Severity</th>
                                <th>Status</th>
                                <th>Detected</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="anomalies-table">
                            <tr><td colspan="6" class="empty-state">No anomalies detected</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Remediation History Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Remediation History</h3>
                    <span id="remediation-list-label" style="color: var(--text-secondary);">0 actions</span>
                </div>
                <div class="table-container" style="max-height: 200px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Action</th>
                                <th>Agent</th>
                                <th>Event Type</th>
                                <th>Status</th>
                                <th>Time</th>
                            </tr>
                        </thead>
                        <tbody id="remediation-table">
                            <tr><td colspan="5" class="empty-state">No remediation actions taken</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Anomaly Types Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Anomaly Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #ef4444;">
                        <div style="font-weight: bold; color: #ef4444;">ADJACENCY_LOSS</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Neighbor down events</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">ROUTE_WITHDRAWAL</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Route withdrawals</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">PROTOCOL_STATE</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Protocol state changes</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">METRIC_SPIKE</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Performance anomalies</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pipelines Content -->
        <div class="protocol-content" id="pipelines-content">
            <div class="metrics-row">
                <div class="metric-card pipelines">
                    <div class="metric-label">Total Pipelines</div>
                    <div class="metric-value" id="pipelines-total">0</div>
                </div>
                <div class="metric-card pipelines">
                    <div class="metric-label">Running</div>
                    <div class="metric-value" id="pipelines-running">0</div>
                </div>
                <div class="metric-card pipelines">
                    <div class="metric-label">Completed Today</div>
                    <div class="metric-value" id="pipelines-completed">0</div>
                </div>
                <div class="metric-card pipelines">
                    <div class="metric-label">Failed</div>
                    <div class="metric-value" id="pipelines-failed">0</div>
                </div>
            </div>

            <!-- Pipeline Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Data Pipelines</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showCreatePipelineModal()" style="background: #f472b6; border-color: #f472b6;">Create Pipeline</button>
                        <button class="btn btn-secondary" onclick="dashboard.refreshPipelinesData()">Refresh</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">SOURCES</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #3b82f6;" id="pipelines-sources">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">TRANSFORMS</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #8b5cf6;" id="pipelines-transforms">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">SINKS</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="pipelines-sinks">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">RECORDS/MIN</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;" id="pipelines-throughput">0</div>
                    </div>
                </div>
            </div>

            <!-- Pipelines Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Pipelines</h3>
                    <span id="pipelines-list-label" style="color: var(--text-secondary);">0 pipelines</span>
                </div>
                <div class="table-container" style="max-height: 300px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Source</th>
                                <th>Transforms</th>
                                <th>Sink</th>
                                <th>Status</th>
                                <th>Last Run</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="pipelines-table">
                            <tr><td colspan="7" class="empty-state">No pipelines configured</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Pipeline Types Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Pipeline Components</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">SOURCES</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">API, File, Database, Queue</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">TRANSFORMS</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Filter, Map, Aggregate, Join</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">SINKS</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Database, File, API, Webhook</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notifications Content -->
        <div class="protocol-content" id="notifications-content">
            <div class="metrics-row">
                <div class="metric-card notifications">
                    <div class="metric-label">Total Sent</div>
                    <div class="metric-value" id="notifications-sent">0</div>
                </div>
                <div class="metric-card notifications">
                    <div class="metric-label">Delivered</div>
                    <div class="metric-value" id="notifications-delivered">0</div>
                </div>
                <div class="metric-card notifications">
                    <div class="metric-label">Pending</div>
                    <div class="metric-value" id="notifications-pending">0</div>
                </div>
                <div class="metric-card notifications">
                    <div class="metric-label">Channels</div>
                    <div class="metric-value" id="notifications-channels">0</div>
                </div>
            </div>

            <!-- Notifications Controls -->
            <div class="section">
                <div class="section-header">
                    <h3>Notification System</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="dashboard.showSendNotificationModal()" style="background: #fb923c; border-color: #fb923c;">Send Notification</button>
                        <button class="btn btn-secondary" onclick="dashboard.refreshNotificationsData()">Refresh</button>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 10px 0;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">EMAIL</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #3b82f6;" id="notifications-email">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">SLACK</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #8b5cf6;" id="notifications-slack">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">WEBHOOK</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="notifications-webhook">0</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 5px;">SMS</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;" id="notifications-sms">0</div>
                    </div>
                </div>
            </div>

            <!-- Recent Notifications Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Recent Notifications</h3>
                    <span id="notifications-list-label" style="color: var(--text-secondary);">0 notifications</span>
                </div>
                <div class="table-container" style="max-height: 300px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Channel</th>
                                <th>Recipient</th>
                                <th>Subject</th>
                                <th>Priority</th>
                                <th>Status</th>
                                <th>Sent</th>
                            </tr>
                        </thead>
                        <tbody id="notifications-table">
                            <tr><td colspan="6" class="empty-state">No notifications sent</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Notification Channels Reference -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header">
                    <h3>Notification Channels</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">EMAIL</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">SMTP email delivery</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">SLACK</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Slack workspace integration</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">WEBHOOK</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">HTTP POST webhooks</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">SMS</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Text message alerts</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Optimization Content -->
        <div class="protocol-content" id="optimization-content">
            <div class="metrics-row">
                <div class="metric-card optimization">
                    <div class="metric-value" id="optimization-recommendations-count">0</div>
                    <div class="metric-label">Recommendations</div>
                </div>
                <div class="metric-card optimization">
                    <div class="metric-value" id="optimization-patterns-count">0</div>
                    <div class="metric-label">Traffic Patterns</div>
                </div>
                <div class="metric-card optimization">
                    <div class="metric-value" id="optimization-pending-count">0</div>
                    <div class="metric-label">Pending Actions</div>
                </div>
                <div class="metric-card optimization">
                    <div class="metric-value" id="optimization-applied-count">0</div>
                    <div class="metric-label">Applied Today</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Optimization Recommendations</h3>
                    <button class="btn btn-primary" onclick="dashboard.showAnalyzeTrafficModal()" style="background: #14b8a6; border-color: #14b8a6;">
                        <i class="fas fa-chart-line"></i> Analyze Traffic
                    </button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th>Target</th>
                            <th>Description</th>
                            <th>Priority</th>
                            <th>Impact</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="optimization-recommendations-table">
                        <tr><td colspan="7" style="text-align: center; color: var(--text-secondary);">Loading recommendations...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Traffic Patterns</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Pattern Name</th>
                            <th>Source</th>
                            <th>Destination</th>
                            <th>Avg Bandwidth</th>
                            <th>Peak Usage</th>
                            <th>Trend</th>
                            <th>Last Updated</th>
                        </tr>
                    </thead>
                    <tbody id="optimization-patterns-table">
                        <tr><td colspan="7" style="text-align: center; color: var(--text-secondary);">Loading traffic patterns...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Recommendation Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #14b8a6;">
                        <div style="font-weight: bold; color: #14b8a6;">OSPF Cost</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Route cost optimization</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #06b6d4;">
                        <div style="font-weight: bold; color: #06b6d4;">BGP Policy</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Routing policy tuning</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">VXLAN VNI</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">VNI allocation</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">Path</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Traffic path optimization</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Discovery Content -->
        <div class="protocol-content" id="discovery-content">
            <div class="metrics-row">
                <div class="metric-card discovery">
                    <div class="metric-value" id="discovery-services-count">0</div>
                    <div class="metric-label">Services</div>
                </div>
                <div class="metric-card discovery">
                    <div class="metric-value" id="discovery-healthy-count">0</div>
                    <div class="metric-label">Healthy</div>
                </div>
                <div class="metric-card discovery">
                    <div class="metric-value" id="discovery-unhealthy-count">0</div>
                    <div class="metric-label">Unhealthy</div>
                </div>
                <div class="metric-card discovery">
                    <div class="metric-value" id="discovery-endpoints-count">0</div>
                    <div class="metric-label">Endpoints</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Registered Services</h3>
                    <button class="btn btn-primary" onclick="dashboard.showRegisterServiceModal()" style="background: #a855f7; border-color: #a855f7;">
                        <i class="fas fa-plus"></i> Register Service
                    </button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Host</th>
                            <th>Port</th>
                            <th>Status</th>
                            <th>Instances</th>
                            <th>Last Check</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="discovery-services-table">
                        <tr><td colspan="8" style="text-align: center; color: var(--text-secondary);">Loading services...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Load Balancers</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Service</th>
                            <th>Strategy</th>
                            <th>Active Endpoints</th>
                            <th>Requests/sec</th>
                            <th>Avg Latency</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="discovery-loadbalancers-table">
                        <tr><td colspan="6" style="text-align: center; color: var(--text-secondary);">Loading load balancers...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Service Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #a855f7;">
                        <div style="font-weight: bold; color: #a855f7;">HTTP</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Web services</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #06b6d4;">
                        <div style="font-weight: bold; color: #06b6d4;">gRPC</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">RPC services</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">TCP</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Raw TCP services</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">UDP</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Datagram services</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Intent Content -->
        <div class="protocol-content" id="intent-content">
            <div class="metrics-row">
                <div class="metric-card intent">
                    <div class="metric-value" id="intent-total-count">0</div>
                    <div class="metric-label">Total Intents</div>
                </div>
                <div class="metric-card intent">
                    <div class="metric-value" id="intent-executed-count">0</div>
                    <div class="metric-label">Executed</div>
                </div>
                <div class="metric-card intent">
                    <div class="metric-value" id="intent-pending-count">0</div>
                    <div class="metric-label">Pending</div>
                </div>
                <div class="metric-card intent">
                    <div class="metric-value" id="intent-failed-count">0</div>
                    <div class="metric-label">Failed</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Create Intent</h3>
                </div>
                <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                    <textarea id="intent-input" placeholder="Describe your network intent in natural language... e.g., 'Enable BGP peering between spine-01 and leaf-01 with AS 65001'" style="flex: 1; min-height: 80px; padding: 12px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-primary); font-family: inherit; resize: vertical;"></textarea>
                </div>
                <div style="display: flex; gap: 12px; justify-content: flex-end;">
                    <button class="btn btn-secondary" onclick="dashboard.validateIntent()">
                        <i class="fas fa-check-circle"></i> Validate
                    </button>
                    <button class="btn btn-primary" onclick="dashboard.executeIntent()" style="background: #f43f5e; border-color: #f43f5e;">
                        <i class="fas fa-play"></i> Execute Intent
                    </button>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Intent History</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Intent</th>
                            <th>Type</th>
                            <th>Target</th>
                            <th>Steps</th>
                            <th>Status</th>
                            <th>Created</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="intent-history-table">
                        <tr><td colspan="7" style="text-align: center; color: var(--text-secondary);">Loading intent history...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Intent Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f43f5e;">
                        <div style="font-weight: bold; color: #f43f5e;">Configuration</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Device config changes</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">Connectivity</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Network connectivity</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #06b6d4;">
                        <div style="font-weight: bold; color: #06b6d4;">Security</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">ACLs and policies</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">Optimization</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Performance tuning</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Knowledge Content -->
        <div class="protocol-content" id="knowledge-content">
            <div class="metrics-row">
                <div class="metric-card knowledge">
                    <div class="metric-value" id="knowledge-snapshots-count">0</div>
                    <div class="metric-label">Snapshots</div>
                </div>
                <div class="metric-card knowledge">
                    <div class="metric-value" id="knowledge-devices-count">0</div>
                    <div class="metric-label">Devices Tracked</div>
                </div>
                <div class="metric-card knowledge">
                    <div class="metric-value" id="knowledge-changes-count">0</div>
                    <div class="metric-label">Changes (24h)</div>
                </div>
                <div class="metric-card knowledge">
                    <div class="metric-value" id="knowledge-queries-count">0</div>
                    <div class="metric-label">Queries Today</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Network Snapshots</h3>
                    <button class="btn btn-primary" onclick="dashboard.createKnowledgeSnapshot()" style="background: #0891b2; border-color: #0891b2;">
                        <i class="fas fa-camera"></i> Create Snapshot
                    </button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Snapshot ID</th>
                            <th>Type</th>
                            <th>Devices</th>
                            <th>Protocols</th>
                            <th>Size</th>
                            <th>Created</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="knowledge-snapshots-table">
                        <tr><td colspan="7" style="text-align: center; color: var(--text-secondary);">Loading snapshots...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Network Analytics</h3>
                </div>
                <div id="knowledge-analytics" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 16px;">
                    <div style="background: var(--bg-tertiary); padding: 16px; border-radius: 8px;">
                        <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 8px;">Device Distribution</div>
                        <div id="knowledge-device-distribution" style="color: var(--text-primary);">-</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 16px; border-radius: 8px;">
                        <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 8px;">Protocol Coverage</div>
                        <div id="knowledge-protocol-coverage" style="color: var(--text-primary);">-</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 16px; border-radius: 8px;">
                        <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 8px;">State Consistency</div>
                        <div id="knowledge-state-consistency" style="color: var(--text-primary);">-</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 16px; border-radius: 8px;">
                        <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 8px;">Last Sync</div>
                        <div id="knowledge-last-sync" style="color: var(--text-primary);">-</div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Knowledge Categories</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #0891b2;">
                        <div style="font-weight: bold; color: #0891b2;">Topology</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Network structure</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">Configuration</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Device configs</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">State</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Runtime state</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">History</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Change history</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Heatmap Content -->
        <div class="protocol-content" id="heatmap-content">
            <div class="metrics-row">
                <div class="metric-card heatmap">
                    <div class="metric-value" id="heatmap-links-count">0</div>
                    <div class="metric-label">Monitored Links</div>
                </div>
                <div class="metric-card heatmap">
                    <div class="metric-value" id="heatmap-hotspots-count">0</div>
                    <div class="metric-label">Hotspots</div>
                </div>
                <div class="metric-card heatmap">
                    <div class="metric-value" id="heatmap-avg-utilization">0%</div>
                    <div class="metric-label">Avg Utilization</div>
                </div>
                <div class="metric-card heatmap">
                    <div class="metric-value" id="heatmap-peak-utilization">0%</div>
                    <div class="metric-label">Peak Utilization</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Link Utilization Heatmap</h3>
                    <div style="display: flex; gap: 8px;">
                        <select id="heatmap-type" onchange="dashboard.refreshHeatmapData()" style="padding: 6px 12px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 4px; color: var(--text-primary);">
                            <option value="utilization">Utilization</option>
                            <option value="bandwidth">Bandwidth</option>
                            <option value="errors">Errors</option>
                            <option value="latency">Latency</option>
                        </select>
                        <button class="btn btn-primary" onclick="dashboard.refreshHeatmapData()" style="background: #ef4444; border-color: #ef4444;">
                            <i class="fas fa-sync"></i> Refresh
                        </button>
                    </div>
                </div>
                <div id="heatmap-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 4px; padding: 16px; background: var(--bg-tertiary); border-radius: 8px; min-height: 200px;">
                    <div style="text-align: center; color: var(--text-secondary); grid-column: 1 / -1;">Loading heatmap data...</div>
                </div>
                <div style="display: flex; justify-content: center; gap: 16px; margin-top: 12px; font-size: 0.8rem; color: var(--text-secondary);">
                    <div style="display: flex; align-items: center; gap: 4px;"><span style="width: 16px; height: 16px; background: #22c55e; border-radius: 2px;"></span> Low (0-25%)</div>
                    <div style="display: flex; align-items: center; gap: 4px;"><span style="width: 16px; height: 16px; background: #eab308; border-radius: 2px;"></span> Medium (25-50%)</div>
                    <div style="display: flex; align-items: center; gap: 4px;"><span style="width: 16px; height: 16px; background: #f97316; border-radius: 2px;"></span> High (50-75%)</div>
                    <div style="display: flex; align-items: center; gap: 4px;"><span style="width: 16px; height: 16px; background: #ef4444; border-radius: 2px;"></span> Critical (75-100%)</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Traffic Hotspots</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Link</th>
                            <th>Source</th>
                            <th>Destination</th>
                            <th>Utilization</th>
                            <th>Bandwidth</th>
                            <th>Trend</th>
                            <th>Duration</th>
                        </tr>
                    </thead>
                    <tbody id="heatmap-hotspots-table">
                        <tr><td colspan="7" style="text-align: center; color: var(--text-secondary);">Loading hotspots...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Heatmap Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #ef4444;">
                        <div style="font-weight: bold; color: #ef4444;">Utilization</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Link usage percentage</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">Bandwidth</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Throughput rates</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">Errors</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Error rates</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">Latency</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Round-trip time</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- WhatIf Content -->
        <div class="protocol-content" id="whatif-content">
            <div class="metrics-row">
                <div class="metric-card whatif">
                    <div class="metric-value" id="whatif-scenarios-count">0</div>
                    <div class="metric-label">Scenarios</div>
                </div>
                <div class="metric-card whatif">
                    <div class="metric-value" id="whatif-simulations-count">0</div>
                    <div class="metric-label">Simulations Run</div>
                </div>
                <div class="metric-card whatif">
                    <div class="metric-value" id="whatif-high-impact-count">0</div>
                    <div class="metric-label">High Impact</div>
                </div>
                <div class="metric-card whatif">
                    <div class="metric-value" id="whatif-avg-recovery">-</div>
                    <div class="metric-label">Avg Recovery Time</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Create Simulation</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px; margin-bottom: 16px;">
                    <div class="form-group">
                        <label>Scenario Type</label>
                        <select id="whatif-scenario-type" style="width: 100%;">
                            <option value="link_failure">Link Failure</option>
                            <option value="node_failure">Node Failure</option>
                            <option value="config_change">Config Change</option>
                            <option value="traffic_spike">Traffic Spike</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Target</label>
                        <input type="text" id="whatif-target" placeholder="e.g., spine-01, link-01-02" style="width: 100%;">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <input type="text" id="whatif-description" placeholder="Scenario description" style="width: 100%;">
                    </div>
                </div>
                <div style="display: flex; gap: 12px; justify-content: flex-end;">
                    <button class="btn btn-primary" onclick="dashboard.runWhatIfSimulation()" style="background: #7c3aed; border-color: #7c3aed;">
                        <i class="fas fa-flask"></i> Run Simulation
                    </button>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Simulation History</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Scenario</th>
                            <th>Type</th>
                            <th>Target</th>
                            <th>Impact</th>
                            <th>Affected Paths</th>
                            <th>Recovery Est.</th>
                            <th>Simulated</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="whatif-history-table">
                        <tr><td colspan="8" style="text-align: center; color: var(--text-secondary);">Loading simulation history...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Scenario Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #7c3aed;">
                        <div style="font-weight: bold; color: #7c3aed;">Link Failure</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Simulate link down</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #ef4444;">
                        <div style="font-weight: bold; color: #ef4444;">Node Failure</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Simulate device down</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">Config Change</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Dry-run changes</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #06b6d4;">
                        <div style="font-weight: bold; color: #06b6d4;">Traffic Spike</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Load increase</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Multi-Agent Content -->
        <div class="protocol-content" id="multiagent-content">
            <div class="metrics-row">
                <div class="metric-card multiagent">
                    <div class="metric-value" id="multiagent-peers-count">0</div>
                    <div class="metric-label">Known Peers</div>
                </div>
                <div class="metric-card multiagent">
                    <div class="metric-value" id="multiagent-active-count">0</div>
                    <div class="metric-label">Active Connections</div>
                </div>
                <div class="metric-card multiagent">
                    <div class="metric-value" id="multiagent-messages-count">0</div>
                    <div class="metric-label">Messages/min</div>
                </div>
                <div class="metric-card multiagent">
                    <div class="metric-value" id="multiagent-consensus-count">0</div>
                    <div class="metric-label">Consensus Rounds</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Peer Agents</h3>
                    <button class="btn btn-primary" onclick="dashboard.showAddPeerModal()" style="background: #059669; border-color: #059669;">
                        <i class="fas fa-plus"></i> Add Peer
                    </button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Agent ID</th>
                            <th>Address</th>
                            <th>Status</th>
                            <th>Last Seen</th>
                            <th>Messages</th>
                            <th>Latency</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="multiagent-peers-table">
                        <tr><td colspan="7" style="text-align: center; color: var(--text-secondary);">Loading peers...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Consensus Proposals</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Proposal ID</th>
                            <th>Type</th>
                            <th>Proposer</th>
                            <th>Votes</th>
                            <th>Status</th>
                            <th>Created</th>
                        </tr>
                    </thead>
                    <tbody id="multiagent-consensus-table">
                        <tr><td colspan="6" style="text-align: center; color: var(--text-secondary);">Loading consensus proposals...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Protocol Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #059669;">
                        <div style="font-weight: bold; color: #059669;">Gossip</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">State propagation</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">Consensus</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Distributed agreement</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #06b6d4;">
                        <div style="font-weight: bold; color: #06b6d4;">Heartbeat</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Liveness detection</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">State Sync</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Full state transfer</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reasoning Content -->
        <div class="protocol-content" id="reasoning-content">
            <div class="metrics-row">
                <div class="metric-card reasoning">
                    <div class="metric-value" id="reasoning-decisions-count">0</div>
                    <div class="metric-label">Decisions Made</div>
                </div>
                <div class="metric-card reasoning">
                    <div class="metric-value" id="reasoning-intents-count">0</div>
                    <div class="metric-label">Intents Parsed</div>
                </div>
                <div class="metric-card reasoning">
                    <div class="metric-value" id="reasoning-accuracy">-</div>
                    <div class="metric-label">Accuracy</div>
                </div>
                <div class="metric-card reasoning">
                    <div class="metric-value" id="reasoning-avg-time">-</div>
                    <div class="metric-label">Avg Decision Time</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Test Reasoning</h3>
                </div>
                <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                    <textarea id="reasoning-input" placeholder="Enter natural language input to test reasoning... e.g., 'Why is there packet loss between spine-01 and leaf-01?'" style="flex: 1; min-height: 80px; padding: 12px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-primary); font-family: inherit; resize: vertical;"></textarea>
                </div>
                <div style="display: flex; gap: 12px; justify-content: flex-end;">
                    <button class="btn btn-primary" onclick="dashboard.runReasoning()" style="background: #d946ef; border-color: #d946ef;">
                        <i class="fas fa-brain"></i> Analyze
                    </button>
                </div>
                <div id="reasoning-output" style="display: none; margin-top: 16px; padding: 16px; background: var(--bg-tertiary); border-radius: 8px; border-left: 3px solid #d946ef;">
                    <div style="font-weight: bold; color: #d946ef; margin-bottom: 8px;">Reasoning Output</div>
                    <div id="reasoning-result" style="white-space: pre-wrap; color: var(--text-primary);"></div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Decision History</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Input</th>
                            <th>Intent Type</th>
                            <th>Decision</th>
                            <th>Confidence</th>
                            <th>Time</th>
                            <th>Timestamp</th>
                        </tr>
                    </thead>
                    <tbody id="reasoning-history-table">
                        <tr><td colspan="6" style="text-align: center; color: var(--text-secondary);">Loading decision history...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Intent Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #d946ef;">
                        <div style="font-weight: bold; color: #d946ef;">Query</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Information requests</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">Diagnosis</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Troubleshooting</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">Action</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Configuration changes</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">Prediction</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Future state</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Traffic Content -->
        <div class="protocol-content" id="traffic-content">
            <div class="metrics-row">
                <div class="metric-card traffic">
                    <div class="metric-value" id="traffic-flows-count">0</div>
                    <div class="metric-label">Active Flows</div>
                </div>
                <div class="metric-card traffic">
                    <div class="metric-value" id="traffic-bandwidth">0</div>
                    <div class="metric-label">Total Bandwidth</div>
                </div>
                <div class="metric-card traffic">
                    <div class="metric-value" id="traffic-tests-count">0</div>
                    <div class="metric-label">Tests Run</div>
                </div>
                <div class="metric-card traffic">
                    <div class="metric-value" id="traffic-avg-latency">-</div>
                    <div class="metric-label">Avg Latency</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Traffic Generator</h3>
                    <button class="btn btn-primary" onclick="dashboard.showStartTrafficModal()" style="background: #0284c7; border-color: #0284c7;">
                        <i class="fas fa-play"></i> Start Flow
                    </button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Flow ID</th>
                            <th>Source</th>
                            <th>Destination</th>
                            <th>Protocol</th>
                            <th>Bandwidth</th>
                            <th>Duration</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="traffic-flows-table">
                        <tr><td colspan="8" style="text-align: center; color: var(--text-secondary);">Loading traffic flows...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>iPerf Test Results</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Test ID</th>
                            <th>Server</th>
                            <th>Client</th>
                            <th>Protocol</th>
                            <th>Throughput</th>
                            <th>Jitter</th>
                            <th>Loss</th>
                            <th>Completed</th>
                        </tr>
                    </thead>
                    <tbody id="traffic-iperf-table">
                        <tr><td colspan="8" style="text-align: center; color: var(--text-secondary);">Loading iPerf results...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Flow Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #0284c7;">
                        <div style="font-weight: bold; color: #0284c7;">TCP</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Reliable streams</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">UDP</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Datagram traffic</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">Burst</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">High intensity bursts</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">Constant</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Steady bit rate</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tutorials Content -->
        <div class="protocol-content" id="tutorials-content">
            <div class="metrics-row">
                <div class="metric-card tutorials">
                    <div class="metric-value" id="tutorials-available-count">0</div>
                    <div class="metric-label">Available</div>
                </div>
                <div class="metric-card tutorials">
                    <div class="metric-value" id="tutorials-completed-count">0</div>
                    <div class="metric-label">Completed</div>
                </div>
                <div class="metric-card tutorials">
                    <div class="metric-value" id="tutorials-in-progress-count">0</div>
                    <div class="metric-label">In Progress</div>
                </div>
                <div class="metric-card tutorials">
                    <div class="metric-value" id="tutorials-score">-</div>
                    <div class="metric-label">Avg Score</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Available Tutorials</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Category</th>
                            <th>Difficulty</th>
                            <th>Steps</th>
                            <th>Duration</th>
                            <th>Progress</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="tutorials-list-table">
                        <tr><td colspan="7" style="text-align: center; color: var(--text-secondary);">Loading tutorials...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Recent Assessments</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Tutorial</th>
                            <th>Score</th>
                            <th>Questions</th>
                            <th>Time Spent</th>
                            <th>Completed</th>
                        </tr>
                    </thead>
                    <tbody id="tutorials-assessments-table">
                        <tr><td colspan="5" style="text-align: center; color: var(--text-secondary);">Loading assessments...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Categories</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #ea580c;">
                        <div style="font-weight: bold; color: #ea580c;">Routing</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">OSPF, BGP, ISIS</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">Switching</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">VLANs, STP, VXLAN</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">Security</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">ACLs, Firewalls</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">Automation</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">APIs, Templates</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Certification Content -->
        <div class="protocol-content" id="certification-content">
            <div class="metrics-row">
                <div class="metric-card certification">
                    <div class="metric-value" id="cert-labs-count">0</div>
                    <div class="metric-label">Labs Available</div>
                </div>
                <div class="metric-card certification">
                    <div class="metric-value" id="cert-completed-count">0</div>
                    <div class="metric-label">Labs Completed</div>
                </div>
                <div class="metric-card certification">
                    <div class="metric-value" id="cert-exams-count">0</div>
                    <div class="metric-label">Exams Taken</div>
                </div>
                <div class="metric-card certification">
                    <div class="metric-value" id="cert-ready">-</div>
                    <div class="metric-label">Cert Ready</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Practice Labs</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Lab Name</th>
                            <th>Certification</th>
                            <th>Difficulty</th>
                            <th>Tasks</th>
                            <th>Time Limit</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="cert-labs-table">
                        <tr><td colspan="7" style="text-align: center; color: var(--text-secondary);">Loading labs...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Practice Exams</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Exam Name</th>
                            <th>Track</th>
                            <th>Questions</th>
                            <th>Pass Score</th>
                            <th>Best Score</th>
                            <th>Attempts</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="cert-exams-table">
                        <tr><td colspan="7" style="text-align: center; color: var(--text-secondary);">Loading exams...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Certification Tracks</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #16a34a;">
                        <div style="font-weight: bold; color: #16a34a;">CCNA</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Associate level</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">CCNP</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Professional level</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #ef4444;">
                        <div style="font-weight: bold; color: #ef4444;">CCIE</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Expert level</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">DevNet</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Automation track</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Integration Content -->
        <div class="protocol-content" id="integration-content">
            <div class="metrics-row">
                <div class="metric-card integration">
                    <div class="metric-value" id="integration-connectors-count">0</div>
                    <div class="metric-label">Connectors</div>
                </div>
                <div class="metric-card integration">
                    <div class="metric-value" id="integration-active-count">0</div>
                    <div class="metric-label">Active</div>
                </div>
                <div class="metric-card integration">
                    <div class="metric-value" id="integration-events-count">0</div>
                    <div class="metric-label">Events/min</div>
                </div>
                <div class="metric-card integration">
                    <div class="metric-value" id="integration-errors-count">0</div>
                    <div class="metric-label">Errors</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Protocol Connectors</h3>
                    <button class="btn btn-primary" onclick="dashboard.refreshIntegrationData()" style="background: #be185d; border-color: #be185d;">
                        <i class="fas fa-sync"></i> Refresh
                    </button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Connector</th>
                            <th>Protocol</th>
                            <th>Status</th>
                            <th>Events</th>
                            <th>Last Sync</th>
                            <th>Latency</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="integration-connectors-table">
                        <tr><td colspan="7" style="text-align: center; color: var(--text-secondary);">Loading connectors...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Bridge Events</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>Connector</th>
                            <th>Event Type</th>
                            <th>Details</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="integration-events-table">
                        <tr><td colspan="5" style="text-align: center; color: var(--text-secondary);">Loading events...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Supported Protocols</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #be185d;">
                        <div style="font-weight: bold; color: #be185d;">OSPF</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Link state routing</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">BGP</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Path vector routing</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">VXLAN</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Overlay tunneling</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">ISIS</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Link state routing</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- GraphQL Content -->
        <div class="protocol-content" id="graphql-content">
            <div class="metrics-row">
                <div class="metric-card graphql">
                    <div class="metric-value" id="graphql-queries-count">0</div>
                    <div class="metric-label">Queries Today</div>
                </div>
                <div class="metric-card graphql">
                    <div class="metric-value" id="graphql-mutations-count">0</div>
                    <div class="metric-label">Mutations</div>
                </div>
                <div class="metric-card graphql">
                    <div class="metric-value" id="graphql-errors-count">0</div>
                    <div class="metric-label">Errors</div>
                </div>
                <div class="metric-card graphql">
                    <div class="metric-value" id="graphql-avg-time">-</div>
                    <div class="metric-label">Avg Response</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>GraphQL Playground</h3>
                </div>
                <div style="display: flex; gap: 16px;">
                    <div style="flex: 1;">
                        <label style="display: block; margin-bottom: 8px; color: var(--text-secondary);">Query</label>
                        <textarea id="graphql-query" placeholder="{
  devices {
    id
    name
    status
  }
}" style="width: 100%; min-height: 150px; padding: 12px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-primary); font-family: 'Monaco', 'Menlo', monospace; font-size: 0.85rem; resize: vertical;"></textarea>
                        <button class="btn btn-primary" onclick="dashboard.executeGraphQL()" style="margin-top: 12px; background: #e11d48; border-color: #e11d48;">
                            <i class="fas fa-play"></i> Execute
                        </button>
                    </div>
                    <div style="flex: 1;">
                        <label style="display: block; margin-bottom: 8px; color: var(--text-secondary);">Result</label>
                        <pre id="graphql-result" style="width: 100%; min-height: 150px; padding: 12px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-primary); font-family: 'Monaco', 'Menlo', monospace; font-size: 0.85rem; overflow: auto; margin: 0;">Results will appear here...</pre>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Recent Queries</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Operation</th>
                            <th>Type</th>
                            <th>Duration</th>
                            <th>Status</th>
                            <th>Timestamp</th>
                        </tr>
                    </thead>
                    <tbody id="graphql-history-table">
                        <tr><td colspan="5" style="text-align: center; color: var(--text-secondary);">Loading query history...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Available Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #e11d48;">
                        <div style="font-weight: bold; color: #e11d48;">Query</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Data fetching</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #8b5cf6;">Mutation</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Data modification</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">Subscription</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Real-time updates</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">Introspection</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Schema discovery</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Actions Content -->
        <div class="protocol-content" id="actions-content">
            <div class="metrics-row">
                <div class="metric-card actions">
                    <div class="metric-value" id="actions-total-count">0</div>
                    <div class="metric-label">Total Actions</div>
                </div>
                <div class="metric-card actions">
                    <div class="metric-value" id="actions-pending-count">0</div>
                    <div class="metric-label">Pending</div>
                </div>
                <div class="metric-card actions">
                    <div class="metric-value" id="actions-completed-count">0</div>
                    <div class="metric-label">Completed</div>
                </div>
                <div class="metric-card actions">
                    <div class="metric-value" id="actions-blocked-count">0</div>
                    <div class="metric-label">Blocked</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Action Queue</h3>
                    <button class="btn btn-secondary" onclick="dashboard.refreshActionsData()">
                        <i class="fas fa-sync"></i> Refresh
                    </button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Action</th>
                            <th>Target</th>
                            <th>Priority</th>
                            <th>Status</th>
                            <th>Safety</th>
                            <th>Created</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="actions-queue-table">
                        <tr><td colspan="7" style="text-align: center; color: var(--text-secondary);">Loading action queue...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Safety Constraints</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Constraint</th>
                            <th>Type</th>
                            <th>Violations</th>
                            <th>Status</th>
                            <th>Last Checked</th>
                        </tr>
                    </thead>
                    <tbody id="actions-safety-table">
                        <tr><td colspan="5" style="text-align: center; color: var(--text-secondary);">Loading safety constraints...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Action Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #7c2d12;">
                        <div style="font-weight: bold; color: #7c2d12;">Config</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Configuration changes</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">Remediation</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Auto-fix issues</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">Optimization</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Performance tuning</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #ef4444;">
                        <div style="font-weight: bold; color: #ef4444;">Emergency</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Critical actions</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- FSM Content -->
        <div class="protocol-content" id="fsm-content">
            <div class="metrics-row">
                <div class="metric-card fsm">
                    <div class="metric-value" id="fsm-machines-count">0</div>
                    <div class="metric-label">State Machines</div>
                </div>
                <div class="metric-card fsm">
                    <div class="metric-value" id="fsm-transitions-count">0</div>
                    <div class="metric-label">Transitions/hr</div>
                </div>
                <div class="metric-card fsm">
                    <div class="metric-value" id="fsm-stable-count">0</div>
                    <div class="metric-label">Stable</div>
                </div>
                <div class="metric-card fsm">
                    <div class="metric-value" id="fsm-flapping-count">0</div>
                    <div class="metric-label">Flapping</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Protocol State Machines</h3>
                    <select id="fsm-protocol-filter" onchange="dashboard.filterFSMByProtocol()" style="padding: 6px 12px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 4px; color: var(--text-primary);">
                        <option value="all">All Protocols</option>
                        <option value="ospf">OSPF</option>
                        <option value="bgp">BGP</option>
                        <option value="isis">IS-IS</option>
                    </select>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Protocol</th>
                            <th>Peer/Neighbor</th>
                            <th>Current State</th>
                            <th>Previous State</th>
                            <th>Transitions</th>
                            <th>Last Change</th>
                            <th>Uptime</th>
                        </tr>
                    </thead>
                    <tbody id="fsm-machines-table">
                        <tr><td colspan="7" style="text-align: center; color: var(--text-secondary);">Loading state machines...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Recent State Transitions</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>Protocol</th>
                            <th>Peer</th>
                            <th>From State</th>
                            <th>To State</th>
                            <th>Reason</th>
                        </tr>
                    </thead>
                    <tbody id="fsm-transitions-table">
                        <tr><td colspan="6" style="text-align: center; color: var(--text-secondary);">Loading transitions...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Protocol Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #0369a1;">
                        <div style="font-weight: bold; color: #0369a1;">OSPF</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">7 states (Down to Full)</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #7c3aed;">
                        <div style="font-weight: bold; color: #7c3aed;">BGP</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">6 states (Idle to Established)</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #059669;">
                        <div style="font-weight: bold; color: #059669;">IS-IS</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">3 states (Down to Up)</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">LACP</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Active/Passive modes</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- State Machine Content -->
        <div class="protocol-content" id="statemachine-content">
            <div class="metrics-row">
                <div class="metric-card statemachine">
                    <div class="metric-value" id="sm-machines-count">0</div>
                    <div class="metric-label">Machines</div>
                </div>
                <div class="metric-card statemachine">
                    <div class="metric-value" id="sm-instances-count">0</div>
                    <div class="metric-label">Instances</div>
                </div>
                <div class="metric-card statemachine">
                    <div class="metric-value" id="sm-states-count">0</div>
                    <div class="metric-label">States</div>
                </div>
                <div class="metric-card statemachine">
                    <div class="metric-value" id="sm-transitions-count">0</div>
                    <div class="metric-label">Transitions</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>State Machines</h3>
                    <button class="btn btn-primary" onclick="dashboard.showCreateStateMachineModal()" style="background: #4f46e5; border-color: #4f46e5;">
                        <i class="fas fa-plus"></i> Create Machine
                    </button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>States</th>
                            <th>Transitions</th>
                            <th>Instances</th>
                            <th>Status</th>
                            <th>Created</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="sm-machines-table">
                        <tr><td colspan="7" style="text-align: center; color: var(--text-secondary);">Loading state machines...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Active Instances</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Instance ID</th>
                            <th>Machine</th>
                            <th>Current State</th>
                            <th>Previous State</th>
                            <th>Status</th>
                            <th>Last Event</th>
                        </tr>
                    </thead>
                    <tbody id="sm-instances-table">
                        <tr><td colspan="6" style="text-align: center; color: var(--text-secondary);">Loading instances...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>State Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #4f46e5;">
                        <div style="font-weight: bold; color: #4f46e5;">Initial</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Starting state</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">Normal</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Regular states</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">Final</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Terminal states</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #ef4444;">
                        <div style="font-weight: bold; color: #ef4444;">Error</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Error handling</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- RBAC Content -->
        <div class="protocol-content" id="rbac-content">
            <div class="metrics-row">
                <div class="metric-card rbac">
                    <div class="metric-value" id="rbac-users-count">0</div>
                    <div class="metric-label">Users</div>
                </div>
                <div class="metric-card rbac">
                    <div class="metric-value" id="rbac-roles-count">0</div>
                    <div class="metric-label">Roles</div>
                </div>
                <div class="metric-card rbac">
                    <div class="metric-value" id="rbac-permissions-count">0</div>
                    <div class="metric-label">Permissions</div>
                </div>
                <div class="metric-card rbac">
                    <div class="metric-value" id="rbac-policies-count">0</div>
                    <div class="metric-label">Policies</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Roles</h3>
                    <button class="btn btn-primary" onclick="dashboard.showCreateRoleModal()" style="background: #9333ea; border-color: #9333ea;">
                        <i class="fas fa-plus"></i> Create Role
                    </button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Description</th>
                            <th>Permissions</th>
                            <th>Users</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="rbac-roles-table">
                        <tr><td colspan="6" class="empty-state">Loading roles...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Permissions</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Resource</th>
                            <th>Action</th>
                            <th>Scope</th>
                            <th>Roles</th>
                        </tr>
                    </thead>
                    <tbody id="rbac-permissions-table">
                        <tr><td colspan="5" class="empty-state">Loading permissions...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Access Policies</h3>
                    <button class="btn btn-secondary" onclick="dashboard.refreshRBACData()">
                        <i class="fas fa-sync"></i> Refresh
                    </button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Policy</th>
                            <th>Effect</th>
                            <th>Resources</th>
                            <th>Actions</th>
                            <th>Conditions</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="rbac-policies-table">
                        <tr><td colspan="6" class="empty-state">Loading policies...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Permission Types</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 12px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <div style="font-weight: bold; color: #10b981;">READ</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">View resources</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #3b82f6;">
                        <div style="font-weight: bold; color: #3b82f6;">WRITE</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Create/modify</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <div style="font-weight: bold; color: #f59e0b;">EXECUTE</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Run operations</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #ef4444;">
                        <div style="font-weight: bold; color: #ef4444;">DELETE</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Remove resources</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #9333ea;">
                        <div style="font-weight: bold; color: #9333ea;">ADMIN</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Full control</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- LLM Content -->
        <div class="protocol-content" id="llm-content">
            <div class="metrics-row">
                <div class="metric-card llm">
                    <div class="metric-value" id="llm-providers-count">0</div>
                    <div class="metric-label">Providers</div>
                </div>
                <div class="metric-card llm">
                    <div class="metric-value" id="llm-conversations-count">0</div>
                    <div class="metric-label">Conversations</div>
                </div>
                <div class="metric-card llm">
                    <div class="metric-value" id="llm-tokens-count">0</div>
                    <div class="metric-label">Tokens Today</div>
                </div>
                <div class="metric-card llm">
                    <div class="metric-value" id="llm-active-provider">-</div>
                    <div class="metric-label">Active Provider</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>LLM Providers</h3>
                    <button class="btn btn-secondary" onclick="dashboard.refreshLLMData()">
                        <i class="fas fa-sync"></i> Refresh
                    </button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Provider</th>
                            <th>Model</th>
                            <th>Status</th>
                            <th>API Key</th>
                            <th>Requests</th>
                            <th>Avg Latency</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="llm-providers-table">
                        <tr><td colspan="7" class="empty-state">Loading providers...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Recent Conversations</h3>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Provider</th>
                            <th>Turns</th>
                            <th>Tokens</th>
                            <th>Status</th>
                            <th>Started</th>
                        </tr>
                    </thead>
                    <tbody id="llm-conversations-table">
                        <tr><td colspan="6" class="empty-state">Loading conversations...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Supported Providers</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;">
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #10a37f;">
                        <div style="font-weight: bold; color: #10a37f;">OpenAI</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">GPT-4, GPT-3.5</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #d97706;">
                        <div style="font-weight: bold; color: #d97706;">Anthropic</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Claude 3, Claude 2</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #4285f4;">
                        <div style="font-weight: bold; color: #4285f4;">Google</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Gemini Pro, Ultra</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 3px solid #0ea5e9;">
                        <div style="font-weight: bold; color: #0ea5e9;">Local</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Ollama, llama.cpp</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Start Traffic Flow Modal -->
        <div id="start-traffic-modal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 450px;">
                <div class="modal-header">
                    <h3 style="color: #0284c7;">Start Traffic Flow</h3>
                    <button class="close-btn" onclick="dashboard.hideStartTrafficModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Destination *</label>
                        <input type="text" id="traffic-destination" placeholder="e.g., 192.168.1.100 or agent-02">
                    </div>
                    <div class="form-group">
                        <label>Protocol</label>
                        <select id="traffic-protocol">
                            <option value="tcp">TCP</option>
                            <option value="udp">UDP</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Bandwidth</label>
                        <input type="text" id="traffic-bandwidth-input" placeholder="e.g., 100M, 1G (default: 10M)">
                    </div>
                    <div class="form-group">
                        <label>Duration (seconds)</label>
                        <input type="number" id="traffic-duration" placeholder="10" min="1" max="3600">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideStartTrafficModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.startTrafficFlow()" style="background: #0284c7; border-color: #0284c7;">Start</button>
                </div>
            </div>
        </div>

        <!-- Add Peer Modal -->
        <div id="add-peer-modal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 400px;">
                <div class="modal-header">
                    <h3 style="color: #059669;">Add Peer Agent</h3>
                    <button class="close-btn" onclick="dashboard.hideAddPeerModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Agent Address *</label>
                        <input type="text" id="peer-address" placeholder="e.g., 192.168.1.100:8080">
                    </div>
                    <div class="form-group">
                        <label>Agent Name (Optional)</label>
                        <input type="text" id="peer-name" placeholder="e.g., asi-agent-02">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideAddPeerModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.addPeer()" style="background: #059669; border-color: #059669;">Add Peer</button>
                </div>
            </div>
        </div>

        <!-- Register Service Modal -->
        <div id="register-service-modal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 450px;">
                <div class="modal-header">
                    <h3 style="color: #a855f7;">Register Service</h3>
                    <button class="close-btn" onclick="dashboard.hideRegisterServiceModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Service Name *</label>
                        <input type="text" id="service-name" placeholder="e.g., api-gateway">
                    </div>
                    <div class="form-group">
                        <label>Service Type *</label>
                        <select id="service-type">
                            <option value="http">HTTP</option>
                            <option value="grpc">gRPC</option>
                            <option value="tcp">TCP</option>
                            <option value="udp">UDP</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Host *</label>
                        <input type="text" id="service-host" placeholder="e.g., 192.168.1.100">
                    </div>
                    <div class="form-group">
                        <label>Port *</label>
                        <input type="number" id="service-port" placeholder="e.g., 8080" min="1" max="65535">
                    </div>
                    <div class="form-group">
                        <label>Health Check Path</label>
                        <input type="text" id="service-health-path" placeholder="/health (optional)">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideRegisterServiceModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.registerService()" style="background: #a855f7; border-color: #a855f7;">Register</button>
                </div>
            </div>
        </div>

        <!-- Analyze Traffic Modal -->
        <div id="analyze-traffic-modal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 450px;">
                <div class="modal-header">
                    <h3 style="color: #14b8a6;">Analyze Traffic</h3>
                    <button class="close-btn" onclick="dashboard.hideAnalyzeTrafficModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Analysis Type *</label>
                        <select id="analysis-type">
                            <option value="all">All Optimizations</option>
                            <option value="ospf">OSPF Costs</option>
                            <option value="bgp">BGP Policies</option>
                            <option value="vxlan">VXLAN VNIs</option>
                            <option value="path">Path Analysis</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Target Scope</label>
                        <input type="text" id="analysis-scope" placeholder="e.g., spine-*, leaf-01 (empty for all)">
                    </div>
                    <div class="form-group">
                        <label>Time Window</label>
                        <select id="analysis-window">
                            <option value="1h">Last 1 Hour</option>
                            <option value="6h">Last 6 Hours</option>
                            <option value="24h" selected>Last 24 Hours</option>
                            <option value="7d">Last 7 Days</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideAnalyzeTrafficModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.runTrafficAnalysis()" style="background: #14b8a6; border-color: #14b8a6;">Analyze</button>
                </div>
            </div>
        </div>

        <!-- Send Notification Modal -->
        <div id="send-notification-modal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 450px;">
                <div class="modal-header">
                    <h3 style="color: #fb923c;">Send Notification</h3>
                    <button class="close-btn" onclick="dashboard.hideSendNotificationModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Channel *</label>
                        <select id="notification-channel">
                            <option value="email">Email</option>
                            <option value="slack">Slack</option>
                            <option value="webhook">Webhook</option>
                            <option value="sms">SMS</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Recipient *</label>
                        <input type="text" id="notification-recipient" placeholder="e.g., user@example.com">
                    </div>
                    <div class="form-group">
                        <label>Subject *</label>
                        <input type="text" id="notification-subject" placeholder="Notification subject">
                    </div>
                    <div class="form-group">
                        <label>Priority</label>
                        <select id="notification-priority">
                            <option value="low">LOW</option>
                            <option value="normal" selected>NORMAL</option>
                            <option value="high">HIGH</option>
                            <option value="critical">CRITICAL</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideSendNotificationModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.sendNotification()" style="background: #fb923c; border-color: #fb923c;">Send</button>
                </div>
            </div>
        </div>

        <!-- Create Pipeline Modal -->
        <div id="create-pipeline-modal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 500px;">
                <div class="modal-header">
                    <h3 style="color: #f472b6;">Create Pipeline</h3>
                    <button class="close-btn" onclick="dashboard.hideCreatePipelineModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Pipeline Name *</label>
                        <input type="text" id="pipeline-name" placeholder="e.g., Network Metrics ETL">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="pipeline-description" rows="2" placeholder="Pipeline description..."></textarea>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Source Type</label>
                            <select id="pipeline-source">
                                <option value="api">API</option>
                                <option value="file">File</option>
                                <option value="database">Database</option>
                                <option value="queue">Queue</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Sink Type</label>
                            <select id="pipeline-sink">
                                <option value="database">Database</option>
                                <option value="file">File</option>
                                <option value="api">API</option>
                                <option value="webhook">Webhook</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideCreatePipelineModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.createPipeline()" style="background: #f472b6; border-color: #f472b6;">Create</button>
                </div>
            </div>
        </div>

        <!-- Send Message Modal -->
        <div id="send-message-modal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 450px;">
                <div class="modal-header">
                    <h3 style="color: #0ea5e9;">Send Message</h3>
                    <button class="close-btn" onclick="dashboard.hideSendMessageModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Message Type *</label>
                        <select id="message-type">
                            <option value="custom">CUSTOM</option>
                            <option value="route_update">ROUTE_UPDATE</option>
                            <option value="health_status">HEALTH_STATUS</option>
                            <option value="heartbeat">HEARTBEAT</option>
                            <option value="alert">ALERT</option>
                        </select>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Recipient (Agent ID)</label>
                            <input type="text" id="message-recipient" placeholder="Leave empty for broadcast">
                        </div>
                        <div class="form-group">
                            <label>Topic</label>
                            <input type="text" id="message-topic" placeholder="e.g., routing.updates">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Priority</label>
                        <select id="message-priority">
                            <option value="0">LOW</option>
                            <option value="1" selected>NORMAL</option>
                            <option value="2">HIGH</option>
                            <option value="3">CRITICAL</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideSendMessageModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.sendMessage()" style="background: #0ea5e9; border-color: #0ea5e9;">Send</button>
                </div>
            </div>
        </div>

        <!-- Create Rule Modal -->
        <div id="create-rule-modal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 500px;">
                <div class="modal-header">
                    <h3 style="color: #84cc16;">Create Rule</h3>
                    <button class="close-btn" onclick="dashboard.hideCreateRuleModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Rule Name *</label>
                        <input type="text" id="rule-name" placeholder="e.g., Auto-failover on link down">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="rule-description" rows="2" placeholder="Rule description..."></textarea>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Priority</label>
                            <select id="rule-priority">
                                <option value="1">LOWEST</option>
                                <option value="2">LOW</option>
                                <option value="3" selected>NORMAL</option>
                                <option value="4">HIGH</option>
                                <option value="5">HIGHEST</option>
                                <option value="6">CRITICAL</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Enabled</label>
                            <select id="rule-enabled">
                                <option value="true" selected>Yes</option>
                                <option value="false">No</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Tags (comma-separated)</label>
                        <input type="text" id="rule-tags" placeholder="e.g., network, automation">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideCreateRuleModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.createRule()" style="background: #84cc16; border-color: #84cc16;">Create</button>
                </div>
            </div>
        </div>

        <!-- Publish Event Modal -->
        <div id="publish-event-modal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 450px;">
                <div class="modal-header">
                    <h3 style="color: #6366f1;">Publish Event</h3>
                    <button class="close-btn" onclick="dashboard.hidePublishEventModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Event Type *</label>
                        <select id="publish-event-type">
                            <option value="custom">CUSTOM</option>
                            <option value="system.start">SYSTEM_START</option>
                            <option value="system.error">SYSTEM_ERROR</option>
                            <option value="agent.config.change">AGENT_CONFIG_CHANGE</option>
                            <option value="network.link.up">LINK_UP</option>
                            <option value="network.link.down">LINK_DOWN</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Source *</label>
                        <input type="text" id="publish-event-source" placeholder="e.g., dashboard">
                    </div>
                    <div class="form-group">
                        <label>Priority</label>
                        <select id="publish-event-priority">
                            <option value="1">LOW</option>
                            <option value="2" selected>NORMAL</option>
                            <option value="3">HIGH</option>
                            <option value="4">CRITICAL</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Tags (comma-separated)</label>
                        <input type="text" id="publish-event-tags" placeholder="e.g., test, manual">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hidePublishEventModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.publishEvent()" style="background: #6366f1; border-color: #6366f1;">Publish</button>
                </div>
            </div>
        </div>

        <!-- Install Plugin Modal -->
        <div id="install-plugin-modal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 450px;">
                <div class="modal-header">
                    <h3 style="color: #ec4899;">Install Plugin</h3>
                    <button class="close-btn" onclick="dashboard.hideInstallPluginModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Plugin ID *</label>
                        <input type="text" id="install-plugin-id" placeholder="e.g., my-custom-plugin">
                    </div>
                    <div class="form-group">
                        <label>Or Select from Registry</label>
                        <select id="install-plugin-registry">
                            <option value="">-- Select a plugin --</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideInstallPluginModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.installPlugin()" style="background: #ec4899; border-color: #ec4899;">Install</button>
                </div>
            </div>
        </div>

        <!-- Create Tenant Modal -->
        <div id="create-tenant-modal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 500px;">
                <div class="modal-header">
                    <h3 style="color: #0d9488;">Create New Tenant</h3>
                    <button class="close-btn" onclick="dashboard.hideCreateTenantModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Tenant Name *</label>
                        <input type="text" id="tenant-name" placeholder="e.g., Acme Corporation">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="tenant-description" rows="2" placeholder="Tenant description..."></textarea>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Service Tier</label>
                            <select id="tenant-tier">
                                <option value="free">Free</option>
                                <option value="basic">Basic</option>
                                <option value="standard" selected>Standard</option>
                                <option value="premium">Premium</option>
                                <option value="enterprise">Enterprise</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Owner Email</label>
                            <input type="email" id="tenant-owner-email" placeholder="owner@company.com">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideCreateTenantModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.createTenant()" style="background: #0d9488; border-color: #0d9488;">Create Tenant</button>
                </div>
            </div>
        </div>

        <!-- Create SLA Modal -->
        <div id="create-sla-modal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 550px;">
                <div class="modal-header">
                    <h3 style="color: #f43f5e;">Create SLA</h3>
                    <button class="close-btn" onclick="dashboard.hideCreateSLAModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>SLA Name *</label>
                        <input type="text" id="sla-name" placeholder="e.g., Core Network SLA">
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Service Name</label>
                            <input type="text" id="sla-service-name" placeholder="e.g., Network Core">
                        </div>
                        <div class="form-group">
                            <label>Service Type</label>
                            <select id="sla-service-type">
                                <option value="network">Network</option>
                                <option value="application">Application</option>
                                <option value="infrastructure">Infrastructure</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="sla-description" rows="2" placeholder="SLA description..."></textarea>
                    </div>
                    <hr style="border-color: var(--border-color); margin: 15px 0;">
                    <h4 style="margin-bottom: 10px; color: var(--text-secondary);">Availability Target</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Target (%)</label>
                            <input type="number" id="sla-avail-target" value="99.9" min="0" max="100" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Warning (%)</label>
                            <input type="number" id="sla-avail-warning" value="99.5" min="0" max="100" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Comparison</label>
                            <select id="sla-avail-comp">
                                <option value=">=" selected>>=</option>
                                <option value=">">></option>
                            </select>
                        </div>
                    </div>
                    <h4 style="margin-bottom: 10px; color: var(--text-secondary);">Latency Target</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Target (ms)</label>
                            <input type="number" id="sla-latency-target" value="50" min="0" step="1">
                        </div>
                        <div class="form-group">
                            <label>Warning (ms)</label>
                            <input type="number" id="sla-latency-warning" value="100" min="0" step="1">
                        </div>
                        <div class="form-group">
                            <label>Comparison</label>
                            <select id="sla-latency-comp">
                                <option value="<="selected><=</option>
                                <option value="<"><</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideCreateSLAModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.createSLA()" style="background: #f43f5e; border-color: #f43f5e;">Create SLA</button>
                </div>
            </div>
        </div>

        <!-- Record Metric Modal -->
        <div id="record-metric-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 style="color: #14b8a6;">Record Capacity Metric</h3>
                    <button class="close-btn" onclick="dashboard.hideRecordMetricModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Resource Type</label>
                            <select id="metric-resource-type">
                                <option value="bandwidth">Bandwidth</option>
                                <option value="cpu">CPU</option>
                                <option value="memory">Memory</option>
                                <option value="storage">Storage</option>
                                <option value="ports">Ports</option>
                                <option value="connections">Connections</option>
                                <option value="routes">Routes</option>
                                <option value="custom">Custom</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Resource Name</label>
                            <input type="text" id="metric-resource-name" placeholder="e.g., eth0, CPU 0">
                        </div>
                        <div class="form-group">
                            <label>Device ID</label>
                            <input type="text" id="metric-device-id" placeholder="Device identifier">
                        </div>
                        <div class="form-group">
                            <label>Device Name</label>
                            <input type="text" id="metric-device-name" placeholder="Device display name">
                        </div>
                        <div class="form-group">
                            <label>Current Value</label>
                            <input type="number" id="metric-current-value" value="0" min="0" step="0.1">
                        </div>
                        <div class="form-group">
                            <label>Max Capacity</label>
                            <input type="number" id="metric-max-capacity" value="100" min="0" step="0.1">
                        </div>
                        <div class="form-group" style="grid-column: span 2;">
                            <label>Unit (e.g., Mbps, %, GB)</label>
                            <input type="text" id="metric-unit" placeholder="Unit of measurement">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideRecordMetricModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.recordMetric()" style="background: #14b8a6; border-color: #14b8a6;">Record</button>
                </div>
            </div>
        </div>

        <!-- Add Device Modal -->
        <div id="add-device-modal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 600px;">
                <div class="modal-header">
                    <h3 style="color: #22d3ee;">Add Device to Inventory</h3>
                    <button class="close-btn" onclick="dashboard.hideAddDeviceModal()">&times;</button>
                </div>
                <div class="modal-body" style="max-height: 60vh; overflow-y: auto;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Device Name *</label>
                            <input type="text" id="device-name" placeholder="e.g., core-router-1">
                        </div>
                        <div class="form-group">
                            <label>Hostname</label>
                            <input type="text" id="device-hostname" placeholder="e.g., core-rtr-01.example.com">
                        </div>
                        <div class="form-group">
                            <label>Device Type</label>
                            <select id="device-type">
                                <option value="router">Router</option>
                                <option value="switch">Switch</option>
                                <option value="firewall">Firewall</option>
                                <option value="load_balancer">Load Balancer</option>
                                <option value="server">Server</option>
                                <option value="virtual_machine">Virtual Machine</option>
                                <option value="container">Container</option>
                                <option value="appliance">Appliance</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Status</label>
                            <select id="device-status">
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                                <option value="maintenance">Maintenance</option>
                                <option value="spare">Spare</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Management IP</label>
                            <input type="text" id="device-mgmt-ip" placeholder="e.g., 10.0.0.1">
                        </div>
                        <div class="form-group">
                            <label>Loopback IP</label>
                            <input type="text" id="device-loopback-ip" placeholder="e.g., 10.255.0.1">
                        </div>
                    </div>
                    <hr style="border-color: var(--border-color); margin: 15px 0;">
                    <h4 style="margin-bottom: 10px; color: var(--text-secondary);">Hardware Information</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Manufacturer</label>
                            <input type="text" id="device-manufacturer" placeholder="e.g., Cisco, Juniper, Arista">
                        </div>
                        <div class="form-group">
                            <label>Model</label>
                            <input type="text" id="device-model" placeholder="e.g., Nexus 9300">
                        </div>
                        <div class="form-group">
                            <label>Serial Number</label>
                            <input type="text" id="device-serial" placeholder="e.g., FTX12345678">
                        </div>
                        <div class="form-group">
                            <label>Asset Tag</label>
                            <input type="text" id="device-asset-tag" placeholder="e.g., IT-NET-0001">
                        </div>
                    </div>
                    <hr style="border-color: var(--border-color); margin: 15px 0;">
                    <h4 style="margin-bottom: 10px; color: var(--text-secondary);">Location</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Site</label>
                            <input type="text" id="device-site" placeholder="e.g., NYC-DC1">
                        </div>
                        <div class="form-group">
                            <label>Rack</label>
                            <input type="text" id="device-rack" placeholder="e.g., A1-R01">
                        </div>
                        <div class="form-group">
                            <label>Rack Position</label>
                            <input type="number" id="device-rack-position" placeholder="e.g., 24" min="1" max="48">
                        </div>
                    </div>
                    <hr style="border-color: var(--border-color); margin: 15px 0;">
                    <h4 style="margin-bottom: 10px; color: var(--text-secondary);">Organization</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>Owner</label>
                            <input type="text" id="device-owner" placeholder="e.g., Network Team">
                        </div>
                        <div class="form-group">
                            <label>Environment</label>
                            <select id="device-environment">
                                <option value="production">Production</option>
                                <option value="staging">Staging</option>
                                <option value="development">Development</option>
                                <option value="lab">Lab</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Tags (comma-separated)</label>
                        <input type="text" id="device-tags" placeholder="e.g., core, datacenter, critical">
                    </div>
                    <div class="form-group">
                        <label>Notes</label>
                        <textarea id="device-notes" rows="2" placeholder="Additional notes..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideAddDeviceModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.addDevice()" style="background: #22d3ee; border-color: #22d3ee;">Add Device</button>
                </div>
            </div>
        </div>

        <!-- Import Inventory Modal -->
        <div id="import-inventory-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 style="color: #22d3ee;">Import Inventory</h3>
                    <button class="close-btn" onclick="dashboard.hideImportModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Paste JSON data</label>
                        <textarea id="import-data" rows="10" placeholder='{"devices": [{"name": "router-1", "device_type": "router", ...}]}'></textarea>
                    </div>
                    <p style="font-size: 0.85rem; color: var(--text-secondary);">
                        Expected format: JSON object with "devices" array containing device objects.
                    </p>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideImportModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.importInventory()" style="background: #22d3ee; border-color: #22d3ee;">Import</button>
                </div>
            </div>
        </div>

        <!-- Create Job Modal -->
        <div id="create-job-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 style="color: #f472b6;">Create Scheduled Job</h3>
                    <button class="close-btn" onclick="dashboard.hideCreateJobModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Job Name</label>
                        <input type="text" id="job-name" placeholder="e.g., Daily Config Backup">
                    </div>
                    <div class="form-group">
                        <label>Job Type</label>
                        <select id="job-type">
                            <option value="NETWORK_SCAN">Network Scan</option>
                            <option value="CONFIG_BACKUP">Config Backup</option>
                            <option value="HEALTH_CHECK">Health Check</option>
                            <option value="COMPLIANCE_CHECK">Compliance Check</option>
                            <option value="REPORT_GENERATION">Report Generation</option>
                            <option value="CUSTOM">Custom</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Priority</label>
                        <select id="job-priority">
                            <option value="LOW">Low</option>
                            <option value="MEDIUM" selected>Medium</option>
                            <option value="HIGH">High</option>
                            <option value="CRITICAL">Critical</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="job-description" rows="2" placeholder="Optional description..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Max Retries</label>
                        <input type="number" id="job-max-retries" value="3" min="0" max="10">
                    </div>
                    <div class="form-group">
                        <label>Timeout (seconds)</label>
                        <input type="number" id="job-timeout" value="300" min="30">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideCreateJobModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.createJob()" style="background: #f472b6; border-color: #f472b6;">Create Job</button>
                </div>
            </div>
        </div>

        <!-- Create Trigger Modal -->
        <div id="create-trigger-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 style="color: #f472b6;">Create Trigger</h3>
                    <button class="close-btn" onclick="dashboard.hideCreateTriggerModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Trigger Type</label>
                        <select id="trigger-type" onchange="dashboard.updateTriggerForm()">
                            <option value="cron">Cron Expression</option>
                            <option value="interval">Interval</option>
                            <option value="date">One-time Date</option>
                            <option value="event">Event-based</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Job ID</label>
                        <input type="text" id="trigger-job-id" placeholder="Enter job ID to trigger">
                    </div>
                    <div id="cron-fields">
                        <div class="form-group">
                            <label>Cron Expression</label>
                            <input type="text" id="trigger-cron" placeholder="*/5 * * * * (every 5 minutes)">
                            <small style="color: var(--text-secondary);">Format: minute hour day month weekday</small>
                        </div>
                    </div>
                    <div id="interval-fields" style="display: none;">
                        <div class="form-group">
                            <label>Interval (seconds)</label>
                            <input type="number" id="trigger-interval" value="3600" min="60">
                        </div>
                    </div>
                    <div id="date-fields" style="display: none;">
                        <div class="form-group">
                            <label>Run At (ISO format)</label>
                            <input type="datetime-local" id="trigger-date">
                        </div>
                    </div>
                    <div id="event-fields" style="display: none;">
                        <div class="form-group">
                            <label>Event Type</label>
                            <input type="text" id="trigger-event-type" placeholder="e.g., config_change">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideCreateTriggerModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.createTrigger()" style="background: #f472b6; border-color: #f472b6;">Create Trigger</button>
                </div>
            </div>
        </div>

        <!-- Rate Limit Config Modal -->
        <div id="ratelimit-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Configure Rate Limiting</h3>
                    <button class="close-btn" onclick="dashboard.hideRateLimitModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Requests per Minute</label>
                        <input type="number" id="ratelimit-rpm" value="60" min="1">
                    </div>
                    <div class="form-group">
                        <label>Requests per Hour</label>
                        <input type="number" id="ratelimit-rph" value="1000" min="1">
                    </div>
                    <div class="form-group">
                        <label>Burst Limit (per second)</label>
                        <input type="number" id="ratelimit-burst" value="20" min="1">
                    </div>
                    <div class="form-group">
                        <label>Block Duration (seconds)</label>
                        <input type="number" id="ratelimit-block-duration" value="60" min="1">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideRateLimitModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.saveRateLimitConfig()" style="background: #6366f1; border-color: #6366f1;">Save</button>
                </div>
            </div>
        </div>

        <!-- Inject Failure Modal -->
        <div id="inject-failure-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 style="color: #ef4444;">Inject Failure</h3>
                    <button class="close-btn" onclick="dashboard.hideInjectFailureModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Failure Type</label>
                        <select id="failure-type">
                            <option value="link_down">Link Down</option>
                            <option value="agent_down">Agent Down</option>
                            <option value="packet_loss">Packet Loss</option>
                            <option value="latency">Latency</option>
                            <option value="flap">Interface Flapping</option>
                            <option value="partition">Network Partition</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Target Agent</label>
                        <input type="text" id="failure-target-agent" placeholder="e.g., router-1">
                    </div>
                    <div class="form-group">
                        <label>Target Link/Interface (optional)</label>
                        <input type="text" id="failure-target-link" placeholder="e.g., eth0">
                    </div>
                    <div class="form-group">
                        <label>Duration (seconds, 0=permanent)</label>
                        <input type="number" id="failure-duration" value="60" min="0">
                    </div>
                    <div class="form-group">
                        <label>Intensity (0.0-1.0, for packet loss/latency)</label>
                        <input type="number" id="failure-intensity" value="1.0" min="0" max="1" step="0.1">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideInjectFailureModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.injectFailure()" style="background: #ef4444; border-color: #ef4444;">Inject</button>
                </div>
            </div>
        </div>

        <!-- Start Recording Modal -->
        <div id="start-recording-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Start Recording Session</h3>
                    <button class="close-btn" onclick="dashboard.hideStartRecordingModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Session Name</label>
                        <input type="text" id="recording-name" placeholder="e.g., Debug Session 1">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="recording-description" rows="3" placeholder="Optional description..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Snapshot Interval (seconds)</label>
                        <input type="number" id="recording-interval" value="30" min="5" max="300">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideStartRecordingModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.confirmStartRecording()">Start Recording</button>
                </div>
            </div>
        </div>

        <!-- Create Flow Modal -->
        <div id="create-flow-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Create Traffic Flow</h3>
                    <button class="close-btn" onclick="dashboard.hideCreateFlowModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Source Agent</label>
                        <input type="text" id="flow-source-agent" placeholder="e.g., router-1">
                    </div>
                    <div class="form-group">
                        <label>Source Interface</label>
                        <input type="text" id="flow-source-if" value="eth0">
                    </div>
                    <div class="form-group">
                        <label>Destination Agent</label>
                        <input type="text" id="flow-dest-agent" placeholder="e.g., router-2">
                    </div>
                    <div class="form-group">
                        <label>Destination Interface</label>
                        <input type="text" id="flow-dest-if" value="eth0">
                    </div>
                    <div class="form-group">
                        <label>Rate (Mbps)</label>
                        <input type="number" id="flow-rate" value="10" min="0.1">
                    </div>
                    <div class="form-group">
                        <label>Protocol</label>
                        <select id="flow-protocol">
                            <option value="tcp">TCP</option>
                            <option value="udp">UDP</option>
                            <option value="icmp">ICMP</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Application</label>
                        <select id="flow-application">
                            <option value="generic">Generic</option>
                            <option value="http">HTTP</option>
                            <option value="https">HTTPS</option>
                            <option value="ssh">SSH</option>
                            <option value="bgp">BGP</option>
                            <option value="ospf">OSPF</option>
                            <option value="dns">DNS</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Pattern</label>
                        <select id="flow-pattern">
                            <option value="constant">Constant</option>
                            <option value="burst">Burst</option>
                            <option value="random">Random</option>
                            <option value="wave">Wave</option>
                            <option value="ramp_up">Ramp Up</option>
                            <option value="ramp_down">Ramp Down</option>
                            <option value="business_hours">Business Hours</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="dashboard.hideCreateFlowModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="dashboard.createFlow()">Create Flow</button>
                </div>
            </div>
        </div>

        <!-- Logs Content (Live Log Viewer) -->
        <div class="protocol-content" id="logs-content">
            <div class="metrics-row">
                <div class="metric-card logs">
                    <div class="metric-label">Total Entries</div>
                    <div class="metric-value" id="logs-total">0</div>
                </div>
                <div class="metric-card logs">
                    <div class="metric-label">Errors</div>
                    <div class="metric-value" id="logs-errors">0</div>
                </div>
                <div class="metric-card logs">
                    <div class="metric-label">Warnings</div>
                    <div class="metric-value" id="logs-warnings">0</div>
                </div>
                <div class="metric-card logs">
                    <div class="metric-label">Last Updated</div>
                    <div class="metric-value" id="logs-last-update">--</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h3>Live Agent Logs</h3>
                    <div class="logs-controls">
                        <button class="primary" id="logs-refresh-btn">
                            <span></span> Refresh
                        </button>
                        <button class="secondary" id="logs-pause-btn">
                            <span></span> Pause
                        </button>
                        <button class="secondary" id="logs-clear-btn">
                            <span></span> Clear
                        </button>
                        <button class="secondary" id="logs-download-btn">
                            <span></span> Download
                        </button>
                        <select class="logs-filter" id="logs-level-filter">
                            <option value="all">All Levels</option>
                            <option value="ERROR">Errors Only</option>
                            <option value="WARNING">Warnings Only</option>
                            <option value="INFO">Info Only</option>
                            <option value="DEBUG">Debug Only</option>
                        </select>
                        <input type="text" id="logs-search" placeholder="Search logs..." class="search-input" style="flex: 1; min-width: 200px;">
                        <div class="logs-status">
                            <div class="logs-status-dot" id="logs-status-indicator"></div>
                            <span id="logs-status-text">Live</span>
                        </div>
                    </div>
                </div>
                <div class="logs-container" id="logs-viewer">
                    <div class="log-entry">
                        <span class="log-timestamp">[--]</span>
                        <span class="log-level INFO">INFO</span>
                        <span>Waiting for logs...</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Markmap library for mind map rendering (loaded dynamically in JS for better error handling) -->

    <script src="/static/agent-dashboard.js"></script>

    <!-- Logs Tab Functionality -->
    <script>
    (function() {
        let logsPaused = false;
        let logsRefreshInterval = null;
        let allLogs = [];

        // Initialize logs tab
        function initLogsTab() {
            const pauseBtn = document.getElementById('logs-pause-btn');
            const refreshBtn = document.getElementById('logs-refresh-btn');
            const downloadBtn = document.getElementById('logs-download-btn');
            const clearBtn = document.getElementById('logs-clear-btn');
            const levelFilter = document.getElementById('logs-level-filter');
            const searchInput = document.getElementById('logs-search');

            // Pause/Resume functionality
            pauseBtn.addEventListener('click', () => {
                logsPaused = !logsPaused;
                if (logsPaused) {
                    pauseBtn.innerHTML = '<span></span> Resume';
                    pauseBtn.classList.add('paused');
                    document.getElementById('logs-status-indicator').classList.add('paused');
                    document.getElementById('logs-status-text').textContent = 'Paused';
                    if (logsRefreshInterval) {
                        clearInterval(logsRefreshInterval);
                        logsRefreshInterval = null;
                    }
                } else {
                    pauseBtn.innerHTML = '<span></span> Pause';
                    pauseBtn.classList.remove('paused');
                    document.getElementById('logs-status-indicator').classList.remove('paused');
                    document.getElementById('logs-status-text').textContent = 'Live';
                    startAutoRefresh();
                }
            });

            // Refresh functionality
            refreshBtn.addEventListener('click', () => {
                fetchLogs();
            });

            // Download functionality
            downloadBtn.addEventListener('click', () => {
                downloadLogs();
            });

            // Clear functionality
            clearBtn.addEventListener('click', () => {
                allLogs = [];
                renderLogs([]);
                updateLogsMetrics();
            });

            // Filter functionality
            levelFilter.addEventListener('change', () => {
                filterAndRenderLogs();
            });

            // Search functionality
            searchInput.addEventListener('input', () => {
                filterAndRenderLogs();
            });

            // Start auto-refresh
            startAutoRefresh();
        }

        // Fetch logs from API
        async function fetchLogs() {
            try {
                const response = await fetch('/api/logs?tail=500');
                if (response.ok) {
                    const data = await response.json();
                    if (data.logs) {
                        allLogs = data.logs;
                        filterAndRenderLogs();
                        updateLogsMetrics();
                        document.getElementById('logs-last-update').textContent = new Date().toLocaleTimeString();
                    }
                }
            } catch (error) {
                console.error('Failed to fetch logs:', error);
            }
        }

        // Filter and render logs based on current filters
        function filterAndRenderLogs() {
            const levelFilter = document.getElementById('logs-level-filter').value;
            const searchText = document.getElementById('logs-search').value.toLowerCase();

            let filtered = allLogs;

            // Filter by level
            if (levelFilter !== 'all') {
                filtered = filtered.filter(log => log.level === levelFilter);
            }

            // Filter by search text
            if (searchText) {
                filtered = filtered.filter(log =>
                    log.message.toLowerCase().includes(searchText) ||
                    (log.timestamp && log.timestamp.toLowerCase().includes(searchText))
                );
            }

            renderLogs(filtered);
        }

        // Render logs to the viewer
        function renderLogs(logs) {
            const viewer = document.getElementById('logs-viewer');

            if (logs.length === 0) {
                viewer.innerHTML = '<div class="log-entry"><span class="log-timestamp">[--]</span><span class="log-level INFO">INFO</span><span>No logs available</span></div>';
                return;
            }

            const html = logs.map(log => {
                const levelClass = log.level ? log.level.toLowerCase() : 'info';
                return `
                    <div class="log-entry ${levelClass}">
                        <span class="log-timestamp">${log.timestamp || '--'}</span>
                        <span class="log-level ${log.level || 'INFO'}">${log.level || 'INFO'}</span>
                        <span>${escapeHtml(log.message)}</span>
                    </div>
                `;
            }).join('');

            viewer.innerHTML = html;

            // Auto-scroll to bottom if not paused
            if (!logsPaused) {
                viewer.scrollTop = viewer.scrollHeight;
            }
        }

        // Update logs metrics
        function updateLogsMetrics() {
            const errors = allLogs.filter(log => log.level === 'ERROR').length;
            const warnings = allLogs.filter(log => log.level === 'WARNING').length;

            document.getElementById('logs-total').textContent = allLogs.length;
            document.getElementById('logs-errors').textContent = errors;
            document.getElementById('logs-warnings').textContent = warnings;
        }

        // Download logs as file
        function downloadLogs() {
            const logsText = allLogs.map(log =>
                `${log.timestamp || '--'} [${log.level || 'INFO'}] ${log.message}`
            ).join('\n');

            const blob = new Blob([logsText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `agent-logs-${new Date().toISOString()}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Start auto-refresh
        function startAutoRefresh() {
            if (logsRefreshInterval) {
                clearInterval(logsRefreshInterval);
            }

            // Fetch immediately
            fetchLogs();

            // Then fetch every 2 seconds
            logsRefreshInterval = setInterval(() => {
                if (!logsPaused) {
                    fetchLogs();
                }
            }, 2000);
        }

        // Escape HTML to prevent XSS
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initLogsTab);
        } else {
            initLogsTab();
        }
    })();
    </script>
</body>
</html>
